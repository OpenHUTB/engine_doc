<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">

<!-- Mirrored from docs.unrealengine.com/4.26/zh-CN/WorkingWithContent/Hair/XgenGuidelines/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 17 Jan 2024 10:52:23 GMT -->
<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <script src="../../../../Include/Javascript/common_zh-CN.js" type="text/javascript"></script>
	<script type="text/javascript">
		var time = new Date(0);
		var preview = false;
		var relativeHTMLPath = "https://docs.unrealengine.com/4.26/";
				var pageid = 0;
				var heroimage = "../../../../Images/WorkingWithContent/Hair/Overview/Hair_Banner.png";
				var lang = "zh-CN";
				var basePath = document.location.pathname.substring(0, document.location.pathname.indexOf('/' + lang + '/') + lang.length + 1);
		document.write('<base href="' +  encodeURI(basePath) + '/WorkingWithContent/Hair/XgenGuidelines/" />');
				var udnCSS = '../../../../Include/CSS/udn_public.css';
		var udnLangCSS = '';
				udnLangCSS = './../../../../Include/CSS/udn_public_CN.css">';
				var udnOverrideCSS = '../../../../Include/CSS/skin_overrides.css';
		var udnOverrideDarkCSS = '../../../../Include/CSS/skin_overrides_dark.css';
		var fancyboxCSS = '../../../../Include/CSS/jquery.fancybox.css';
		var jqueryuiCSS = '../../../../Include/CSS/jquery-ui.min.css';
		var qtipCSS = '../../../../Include/CSS/jquery.qtip.css';
		var prettifyCSS = '../../../../Include/CSS/prettify.css';
		var navbarCSS = '../../../../Include/CSS/navBar.css';
		var twentytwentyCSS = '../../../../Include/CSS/twentytwenty.css';
		var recommendationsCSS = '../../../../Include/CSS/jquery.recommendations.css';
	</script>
    <title>毛发创建XGen指南 | 虚幻引擎文档</title>
    	    <meta name=viewport content="width=device-width, initial-scale=1" />
	<meta http-equiv="Cache-control" content="no-store">
    <script  src="../../../../Include/Javascript/CustomEvent.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery-3.4.0.min.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/udn.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/udn_extras.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery-ui.min.js" type="text/javascript"></script>
	    <script  src="../../../../Include/Javascript/informational.js" type="text/javascript"></script>
	    <script  src="../../../../Include/Javascript/jquery.fancybox.pack.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery.qtip.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/prettify.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery.slimscroll.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery.event.move.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery.twentytwenty.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/lazysizes.min.js" type="text/javascript"></script>
	    <script  src="../../../../Include/Javascript/jquery.recommendations.js" type="text/javascript"></script>
	
    <link async rel="icon" href="../../../../../favicon.png" type="image/x-icon" />
    <link async rel="shortcut icon" href="../../../../../favicon.png" type="image/x-icon" />
    <link async href="../../../../Include/Images/touch_icon.png" rel="apple-touch-icon" />
    <link async href="../../../../Include/Images/touch_icon_114.png" sizes="114x114" rel="apple-touch-icon" />    
		<script  src="../../../../Include/Javascript/CollapsibleLists.js" type="text/javascript"></script>
	<script  src="../../../../Include/Javascript/navigationBarUI.js"></script>
	<script  src="../../../../Include/Javascript/navigationBar.js"></script>
		
	<link rel="alternate" href="https://docs.unrealengine.com/latest/en-US/WorkingWithContent/Hair/XgenGuidelines/" hreflang="x-default" />
<link rel="alternate" href="https://docs.unrealengine.com/latest/zh-CN/WorkingWithContent/Hair/XgenGuidelines/" hreflang="zh-CN" />
<link rel="alternate" href="https://docs.unrealengine.com/latest/ja/WorkingWithContent/Hair/XgenGuidelines/" hreflang="ja" />
<link rel="alternate" href="https://docs.unrealengine.com/latest/ko/WorkingWithContent/Hair/XgenGuidelines/" hreflang="ko" />

	<meta name="redirect" content="RenderingAndGraphics/HairRendering/XgenGuidelines" />
<meta name="redirect" content="Engine/HairRendering/XgenGuidelines" />
<meta name="intsourcechangelist" content="16146891" />
<meta name="availability" content="Public" />
<meta name="title" content="毛发创建XGen指南" />
<meta name="description" content="介绍如何将Groom导出为Alembic文件，供虚幻引擎4使用。" />
<meta name="type" content="reference" />
<meta name="version" content="4.26" />
<meta name="parent" content="WorkingWithContent/Hair" />
<meta name="order" content="3" />
<meta name="related" content="WorkingWithContent/Hair/AlembicForGrooms" />
<meta name="hero-image" content="WorkingWithContent/Hair/Overview/Hair_Banner.png" />
<meta name="keywords" content="Hair" />
<meta name="keywords" content="XGen" />
<meta name="keywords" content="Simulation" />
<meta name="keywords" content="Physics" />
<meta name="crumbs" content="%ROOT%,WorkingWithContent,WorkingWithContent/Hair" />

	<meta name="twitter:card" content="summary_large_image" />
	<meta property="og:title" content="毛发创建XGen指南" />
	<meta property="og:description" content="介绍如何将Groom导出为Alembic文件，供虚幻引擎4使用。 " />
		<meta property="og:image" content="" />
	</head>
<body id="webbgThree" style="visibility: hidden;" onload="document.body.style.visibility='visible';">
			<script>window.__tracking_base = 'https://tracking.unrealengine.com/';</script>
	<script src="../../../../../../tracking.unrealengine.com/tracking.js" async></script>    <div id="webThree">
				<div id="page_head">

			<edc-navigation blackListLangCodes='["de-de","es-es","es-mx","fr-fr","it-it","pt-br","ru-ru","pl-pl","tr-tr"]' locale="zh-CN" ></edc-navigation>
						<div id="pagenav">
				<div class="crumbs" id="crumbs">
<span id="versionContainer">
	<span id="versionSelect" class="btn btn-version" onclick="ToggleMenu($('#versionMenu'), $(this));"></span>
	<div id="versionMenu">
		<div id="4_26" data-version="4.26" class="btn btn-select" onclick="createCookie('version', '4.26', 365);SwitchVersion('4.26');">Unreal Engine 4.26 Documentation</div>
		<div id="4_27" data-version="4.27" class="btn btn-select" onclick="createCookie('version', '4.27', 365);SwitchVersion('4.27');">Unreal Engine 4.27 Documentation</div>
		<div id="5_0" data-version="5.0" class="btn btn-select" onclick="createCookie('version', '5.0', 365);SwitchVersion('5.0');">Unreal Engine 5.0 Documentation</div>
		<div id="5_1" data-version="5.1" class="btn btn-select" onclick="createCookie('version', '5.1', 365);SwitchVersion('5.1');">Unreal Engine 5.1 Documentation</div>
		<div id="5_2" data-version="5.2" class="btn btn-select" onclick="createCookie('version', '5.2', 365);SwitchVersion('5.2');">Unreal Engine 5.2 Documentation</div>
		<div id="5_3" data-version="5.3" class="btn btn-select" onclick="createCookie('version', '5.3', 365);SwitchVersion('5.3');">Unreal Engine 5.3 Documentation</div>
	</div>
</span>
	<span class="separator">></span> <a id="parent_link" href="../../index.html">管理内容</a>

	<span class="separator">></span> <a id="parent_link" href="../index.html">毛发渲染与模拟</a>

<span class="separator">></span> <span id="page">毛发创建XGen指南</span>
</div>				<div id="pageNavRight">
								<!-- Start of Search -->
												<div id="search_container">
					<form name="bodySearch" method="get" action="https://www.unrealengine.com/zh-CN/bing-search" onsubmit="return validateSearch()">
						<input type="image" src="../../../../Include/Images/search_box_icon.png" class="searchbutton"/>
						<input type="hidden" name="filter" value="文档" />
						<input type="text" name="keyword" placeholder="搜索文档……" class="searchbox" autocomplete="off"/>
					</form>
				</div>
								<!-- End of Search -->
				<div id="skinContainer">
	<div id="skinSelect" class="btn btn-skin" onclick="ToggleMenu($('#skinMenu'), $(this));"></div>
	<div id="skinMenu">
		<div id="light" class="btn btn-select" onclick="createCookie('skin', 'light', 365);location.reload();">Light Theme</div>
		<div id="dark" class="btn btn-select" onclick="createCookie('skin', 'dark', 365);location.reload();">Dark Theme</div>
	</div>
</div>				</div>
			</div>
		</div>						<div id="navWrapper">
			<div id="nav-filter-container">
				<div id="nav-filter-inner">
					<form>
						<input type="text" placeholder="Filter pages..." id="nav-filter" onchange="clearTimeout(filterTimer); filterTimer = setTimeout(updateNavTreeFilter,250, this.value);if(this.value.length == 0){$('#filter-clear').hide();}else{$('#filter-clear').show();}" onkeypress="this.onchange();" onpaste="this.onchange();" oninput="this.onchange();" />
						<button class="close-icon" id="filter-clear" type="reset" onclick="clearTimeout(filterTimer); filterTimer = setTimeout(updateNavTreeFilter,250, '');$(this).hide();"></button>
					</form>
				</div>
			</div>
			<nav id="navPanel">
			</nav>
			<div id="navigation" title="Click to toggle navigation menu"><span>></span></div>
		</div>		
		<div id="splitter">
		</div>
				<div id="contentContainer">
										<div id="pagedefault">
				<div id="product-banner">
	<div id="product-logo"></div>
</div>				<div id="pagecontainer" style="padding-right:0px;">
					<!-- Start of Markdown converted page content -->
																				<div class="hero  background">
						<div class="imgContainer"><img src="../../../../Images/WorkingWithContent/Hair/Overview/Hair_Banner.png" /></div>						<div class="info">
							<div id="pageTitle">
								<h1 id="H1TitleId">毛发创建XGen指南</h1>
							</div>	
							<h2 >介绍如何将Groom导出为Alembic文件，供虚幻引擎4使用。 </h2>
							<div id="access">
								<div class="accessContainer">
																																			</div>
							</div>
						</div>
					</div>
																				<div id="maincol">
						<div class="togglesection" id="osContainer">
	<div class="normaltitle">
		<p>Choose your operating system:</p>
	</div><div class="toggleButtons">
		<div class="btn btn-default btn-toggle OS windows" id="windows" onclick="setSelector('OS', 'windows');">
			<p>Windows</p>
		</div>
		<div class="btn btn-default btn-toggle OS mac" id="mac" onclick="setSelector('OS', 'mac');">
			<p>macOS</p>
		</div>
		<div class="btn btn-default btn-toggle OS linux" id="linux" onclick="setSelector('OS', 'linux');">
			<p>Linux</p>
		</div>
	</div>
</div>																		<div id="seeAlso">
	<div style="position:relative;">
		<div id="title">参见</div>
		<div id="pageList">
			<ul>
								<li>
					<p>
						<a id="related_link" href="../AlembicForGrooms/index.html" title="介绍如何将Grooms导出为Alembic文件，供虚幻引擎4使用。">Alembic for Grooms规范</a>
					</p>
				</li>
							</ul>
		</div>
	</div>
</div>
																														<div class="toc">
<div style="position:relative;">
    <div class="title">
    本页面的内容
    </div>
<div id="tocScroll">
    <ul>
	    		    			    <li id="">
	<p><a id="toc_link" href="#关于转换老版本xgen的说明">关于转换老版本XGen的说明</a></p>
			<ul>
							<li id="">
	<p><a id="toc_link" href="#将导线转换为nurbs曲线">将导线转换为NURBS曲线</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#将groom转换为xgen交互式groom">将Groom转换为XGen交互式Groom</a></p>
			<ul>
							<li id="">
	<p><a id="toc_link" href="#将样条说明导出到nurbs曲线">将样条说明导出到NURBS曲线</a></p>
	</li>					</ul>
	</li>					</ul>
	</li>		    			    <li id="">
	<p><a id="toc_link" href="#创建属性">创建属性</a></p>
			<ul>
							<li id="">
	<p><a id="toc_link" href="#创建组id属性">创建组ID属性</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#创建导线属性">创建导线属性</a></p>
			<ul>
							<li id="">
	<p><a id="toc_link" href="#groom_width属性">Groom_Width属性</a></p>
	</li>					</ul>
	</li>					</ul>
	</li>		    			    <li id="">
	<p><a id="toc_link" href="#从maya导出到alembic">从Maya导出到Alembic</a></p>
	</li>		    			    <li id="">
	<p><a id="toc_link" href="#将纹理应用于毛发uv">将纹理应用于毛发UV</a></p>
	</li>		    	        </ul>
</div>
</div>
</div>
<p>本文将演示如何在Maya的<a id="content_link" href="http://help.autodesk.com/view/MAYAUL/2018/ENU/?guid=GUID-C6324505-BD4F-4FD2-B340-CF99158D4819" ><span>老版XGen毛发创建系统</span></a>中设置Groom并导入虚幻引擎，以及如何参考[Alembic for Groom指南]来设置属性。
</p><div class="note">
	<p>本文使用Maya 2018.6创建资产。 </p>
</div><h2 id="关于转换老版本xgen的说明">关于转换老版本XGen的说明</h2>
<h3 id="将导线转换为nurbs曲线">将导线转换为NURBS曲线</h3>
<p>请参考下列步骤将Groom的导线转化为曲线，以便保存一组曲线并匹配你要转换的导线。
</p><ol ><li class="Default"><p>将Maya菜单集设为 <strong>建模（Modeling）</strong>，以便查看可用的正确菜单选项。
</p><p><picture>
		<source data-srcset="./../../../../Images/WorkingWithContent/Hair/XgenGuidelines/MenuSetSelection.jpg">
		<img class="  lazyload" alt="MenuSetSelection.png" data-src="../../../../Images/WorkingWithContent/Hair/XgenGuidelines/MenuSetSelection.jpg" />
</picture>

</p></li><li class="Default"><p>从主菜单中，点击 <strong>生成（Generate）</strong> 下拉列表并选择 <strong>XGen编辑器（XGen Editor）</strong>。 
</p></li><li class="Default"><p>在 <strong>XGen</strong> 窗口中，使用 <strong>工具（Utilities）</strong> 选项卡选择 <strong>曲线的导线（Guides to Curves）</strong>。 
</p><p><picture>
		<source data-srcset="./../../../../Images/WorkingWithContent/Hair/XgenGuidelines/XGen_Utilities.jpg">
		<img class="  lazyload" alt="XGen_Utilities.png" data-src="../../../../Images/WorkingWithContent/Hair/XgenGuidelines/XGen_Utilities.jpg" />
</picture>

</p></li><li class="Default"><p>点击 <strong>创建曲线（Create Curves）</strong>。
</p></li></ol><p>完成后，groom的输出将类似下图： 
</p><p><picture>
		<source data-srcset="./../../../../Images/WorkingWithContent/Hair/XgenGuidelines/GuidesToNurbsCurvesOutput.jpg">
		<img class="  lazyload" alt="GuidesToNurbsCurvesOutput.png" data-src="../../../../Images/WorkingWithContent/Hair/XgenGuidelines/GuidesToNurbsCurvesOutput.jpg" />
</picture>

</p><h3 id="将groom转换为xgen交互式groom">将Groom转换为XGen交互式Groom</h3>
<p>如果你在使用老版本的XGen说明（XGen Description），需将groom转换为 <strong>XGen交互式Groom（XGen Interactive Groom）</strong>。步骤如下：
</p><ol ><li class="Default"><p>选中XGen Description节点。 
</p><p><picture>
		<source data-srcset="./../../../../Images/WorkingWithContent/Hair/XgenGuidelines/XGenDescriptionNodes.jpg">
		<img class="  lazyload" alt="XGenDescriptionNodes.png" data-src="../../../../Images/WorkingWithContent/Hair/XgenGuidelines/XGenDescriptionNodes.jpg" />
</picture>

</p></li><li class="Default"><p>在 <strong>建模（Modeling）</strong> 菜单中，使用主菜单点击 <strong>生成（Generate）</strong> 下拉列表，然后选择 <strong>转换为交互式Groom（Convert to Interactive Groom）</strong>。 
</p><p><picture>
		<source data-srcset="./../../../../Images/WorkingWithContent/Hair/XgenGuidelines/XGenInteractiveGroom.jpg">
		<img class="  lazyload" alt="XGenInteractiveGroom.png" data-src="../../../../Images/WorkingWithContent/Hair/XgenGuidelines/XGenInteractiveGroom.jpg" />
</picture>

</p></li></ol><h4 id="将样条说明导出到nurbs曲线">将样条说明导出到NURBS曲线</h4>
<p>请遵循以下步骤，将你选中的样条说明（spline description）导出成Alembic文件，该文件可以与插值生成的头发一起导入为NURBS曲线。
</p><ol ><li class="Default"><p>选中你的XGen Spline Description节点。在 <strong>建模（Modeling）</strong> 菜单集中使用主菜单点击 <strong>生成（Generate）</strong> 下拉列表。然后在列表中选择 <strong>缓存（Cache）> 导出缓存（Export Cache）</strong>。 
</p><p><picture>
		<source data-srcset="./../../../../Images/WorkingWithContent/Hair/XgenGuidelines/SplineDescToNurbsCurve_ExportCache.jpg">
		<img class="  lazyload" alt="SplineDescToNurbsCurve_ExportCache.png" width="1200" data-src="../../../../Images/WorkingWithContent/Hair/XgenGuidelines/SplineDescToNurbsCurve_ExportCache.jpg" />
</picture>

</p></li><li class="Default"><p>在 <strong>导出缓存（Export Cache）</strong> 窗口中进行以下设置： 
</p><ul ><li class="Default"><p><strong>缓存时间帧（Cache Time Frame）：</strong> 设置成 <strong>当前帧（Current Frame）</strong>
</p></li><li class="Default"><p><strong>多个变换（Multiple Transforms）：</strong> 禁用
</p></li><li class="Default"><p><strong>写入最终宽度（Write Final Width）：</strong> 启用
</p></li></ul><p><picture>
		<source data-srcset="./../../../../Images/WorkingWithContent/Hair/XgenGuidelines/SplineDescToNurbsCurve_ExportCacheWindow.jpg">
		<img class="  lazyload" alt="SplineDescToNurbsCurve_ExportCacheWindow.png" data-src="../../../../Images/WorkingWithContent/Hair/XgenGuidelines/SplineDescToNurbsCurve_ExportCacheWindow.jpg" />
</picture>

</p></li><li class="Default"><p>为文件输入名称，文件类型选择 <strong>Alembic</strong>。 
</p><p><picture>
		<source data-srcset="./../../../../Images/WorkingWithContent/Hair/XgenGuidelines/SplineDescToNurbsCurve_ExportCacheFile.jpg">
		<img class="  lazyload" alt="SplineDescToNurbsCurve_ExportCacheFile.png" data-src="../../../../Images/WorkingWithContent/Hair/XgenGuidelines/SplineDescToNurbsCurve_ExportCacheFile.jpg" />
</picture>

</p></li><li class="Default"><p>点击 <strong>导出（Export）</strong>。
</p></li><li class="Default"><p>在 <strong>文件（File）</strong> 菜单中选择 <strong>导入（Import）</strong>。这会打开 <strong>导入（Import）</strong> 窗口，然后将Alembic（'.abc'）文件放入场景。
</p><p><picture>
		<source data-srcset="./../../../../Images/WorkingWithContent/Hair/XgenGuidelines/SplineDescToNurbsCurve_ImportAlembic.jpg">
		<img class="  lazyload" alt="SplineDescToNurbsCurve_ImportAlembic.png" width="1200" data-src="../../../../Images/WorkingWithContent/Hair/XgenGuidelines/SplineDescToNurbsCurve_ImportAlembic.jpg" />
</picture>

</p></li></ol><p>导入完成后，XGen样条说明就应该已经被导出为Alembic文件，并且将内插毛发作为NURBS曲线导入。 
</p><p><picture>
		<source data-srcset="./../../../../Images/WorkingWithContent/Hair/XgenGuidelines/SplineDescToNurbsCurve_Output.jpg">
		<img class="  lazyload" alt="SplineDescToNurbsCurve_Output.png" data-src="../../../../Images/WorkingWithContent/Hair/XgenGuidelines/SplineDescToNurbsCurve_Output.jpg" />
</picture>

</p><h2 id="创建属性">创建属性</h2>
<h3 id="创建组id属性">创建组ID属性</h3>
<p>可在一个或多个组中导出内插毛发。虚幻引擎中可识别此类组，用于唯一材质指定。 
</p><p>创建组ID属性时使用以下脚本：
</p><pre class="prettyprint"><code>from maya import cmds

attr&#95;name = 'groom&#95;group&#95;id'

# 注意：更改以下命名以反映节点场景。
groups = &#91;'hair&#95;brows&#95;splineDescription1&#124;SplineGrp0', 'hair&#95;lashes&#95;splineDescription1&#124;SplineGrp0', 'hair&#95;head&#95;splineDescription1&#124;SplineGrp0'&#93;

for groom&#95;group&#95;id, group&#95;name in enumerate(groups):

    # 获取xgGroom下的曲线
    curves = cmds.listRelatives(group&#95;name, ad=True, type='nurbsCurve')

    # 用组id标记组
    cmds.addAttr(group&#95;name, longName=attr&#95;name, attributeType='short', defaultValue=groom&#95;group&#95;id, keyable=True)

    # 添加属性范围
    # 强制Maya的alembic将数据导出为GeometryScope::kConstantScope
    cmds.addAttr(group&#95;name, longName='{}&#95;AbcGeomScope'.format(attr&#95;name), dataType='string', keyable=True)
    cmds.setAttr('{}.{}&#95;AbcGeomScope'.format(group&#95;name, attr&#95;name), 'con', type='string')</code></pre>
<h3 id="创建导线属性">创建导线属性</h3>
<p>当你为Groom创建导线属性时，只有标记为 <strong>导线（guide）</strong> 的曲线才会被用于虚幻引擎中的模拟。若未在Alembic文件中指定导线，在导入UE4的过程中，一定比例的内插毛发将被内部标记为导线。 
</p><div class="tip">
	<p>导入无导线的groom时，使用<a id="content_link"filter-data="tag_hair tag_simulation tag_physics tag_rendering tag_reference" href="../Reference/index.html" ><span>Groom导入选项</span></a>可设置标记为导线的内插毛发比例。默认仅10%的毛发用作导线。</p>
</div><p>创建导线属性时使用以下脚本：
</p><pre class="prettyprint"><code>from maya import cmds

attr&#95;name = 'groom&#95;guide'

# 获取xgGroom下的曲线
curves = cmds.listRelatives('xgGroom', ad=True, type='nurbsCurve')

# 新建组
guides&#95;group = cmds.createNode('transform', name='guides')

# 将组标记为groom&#95;guide
cmds.addAttr(guides&#95;group, longName=attr&#95;name, attributeType='short', defaultValue=1, keyable=True)

# 强制Maya的alembic将曲线导出为一个组。
cmds.addAttr(guides&#95;group, longName='riCurves', attributeType='bool', defaultValue=1, keyable=True)

# 添加属性范围
# 强制Maya的alembic将数据导出为GeometryScope::kConstantScope
cmds.addAttr(guides&#95;group, longName='{}&#95;AbcGeomScope'.format(attr&#95;name), dataType='string', keyable=True)
cmds.setAttr('{}.{}&#95;AbcGeomScope'.format(guides&#95;group, attr&#95;name), 'con', type='string')

# 导线组下方的父曲线
for curve in curves:
    cmds.parent(curve, guides&#95;group, shape=True, relative=True)</code></pre>
<h4 id="groom_width属性">Groom_Width属性</h4>
<p>对于Maya来说，宽度值有一个特殊的行为，不像其他DCC应用程序可以按照<a id="content_link"filter-data="tag_hair tag_alembic tag_simulation tag_physics" href="../AlembicForGrooms/index.html" ><span>Alembic for Grooms规格</span></a>来检索它们并使用它们来建立新郎。
</p><p>Maya可以直接在曲线上导出宽度值，这样就不需要导出一个自定义的 <code>groom&#95;width</code> 属性；导入器会自动将这些值转换为该属性。如果 <code>groom&#95;wdith</code> 属性在导入虚幻引擎时与新郎一起存在，它不会被覆盖。如果 <code>groom&#95;wdith</code> 没有被指定，或者不能从宽度值中转换，那么生成器将回到1厘米的值上。
</p><h2 id="从maya导出到alembic">从Maya导出到Alembic</h2>
<ol ><li class="Default"><p>在Maya中，选择要导出的导线和Group_ID曲线。
</p><div class="note">
	<p>每个节点应拥有唯一名称。 </p>
</div></li><li class="Default"><p>在 <strong>建模（Modeling）</strong> 菜单集中，使用主菜单点击 <strong>缓存（Cache）</strong> 下拉列表，然后选择 <strong>Alembic缓存（Alembic Cache）> 将选中项导出到Alembic（Export Selection to Alembic）</strong>。
</p><p><picture>
		<source data-srcset="./../../../../Images/WorkingWithContent/Hair/XgenGuidelines/ExportToAlembic_ExportSelection.jpg">
		<img class="  lazyload" alt="ExportToAlembic_ExportSelection.png" data-src="../../../../Images/WorkingWithContent/Hair/XgenGuidelines/ExportToAlembic_ExportSelection.jpg" />
</picture>

</p></li><li class="Default"><p>在 <strong>导出选中项（Export Selection）</strong> 窗口中的 <strong>通用选项（General Options）</strong> 类别下，将 <strong>缓存时间范围（Cache time range）</strong> 设为 <strong>当前帧（Current Frame）</strong>。
</p><p><picture>
		<source data-srcset="./../../../../Images/WorkingWithContent/Hair/XgenGuidelines/ExportToAlembic_ExportSelection_CurrentFrame.jpg">
		<img class="  lazyload" alt="ExportToAlembic_ExportSelection_CurrentFrame.png" data-src="../../../../Images/WorkingWithContent/Hair/XgenGuidelines/ExportToAlembic_ExportSelection_CurrentFrame.jpg" />
</picture>

</p></li><li class="Default"><p>在 <strong>属性（Attributes）</strong> 类别下，输入要罗列出的 <strong>属性（Attribute）</strong> 命名，然后点击 <strong>添加（Add）</strong> 按钮。添加以下模式属性： 
</p><p><picture>
		<source data-srcset="./../../../../Images/WorkingWithContent/Hair/XgenGuidelines/ExportToAlembic_ExportSelection_AddAttributes.jpg">
		<img class="  lazyload" alt="ExportToAlembic_ExportSelection_AddAttributes.png" data-src="../../../../Images/WorkingWithContent/Hair/XgenGuidelines/ExportToAlembic_ExportSelection_AddAttributes.jpg" />
</picture>

</p><ul ><li class="Default"><p>groom_group_id
</p></li><li class="Default"><p>groom_guide
</p></li></ul></li><li class="Default"><p>在 <strong>文件名（File name）</strong> 文本框中为文件命名，并将 <strong>文件类型（Files of type）</strong> 设为 <strong>Alembic</strong>。
</p><p><picture>
		<source data-srcset="./../../../../Images/WorkingWithContent/Hair/XgenGuidelines/ExportToAlembic_ExportSelection_FileNameType.jpg">
		<img class="  lazyload" alt="ExportToAlembic_ExportSelection_FileNameType.png" data-src="../../../../Images/WorkingWithContent/Hair/XgenGuidelines/ExportToAlembic_ExportSelection_FileNameType.jpg" />
</picture>

</p></li><li class="Default"><p>点击 <strong>导出选中项（Export Selection）</strong> 按钮。
</p></li></ol><h2 id="将纹理应用于毛发uv">将纹理应用于毛发UV</h2>
<p>以下步骤和包含脚本可以帮助你设置自己的XGen毛发，该毛发可以导出到虚幻引擎，并且各个发束上呈现已应用的纹理。 
</p><ol ><li class="Default"><p>在Maya的建模菜单中，选择 <strong>生成（Generate）</strong> > <strong>创建交互式Groom样条（Create Interactive Groom Splines）</strong>。 
</p><p><picture>
		<source data-srcset="./../../../../Images/WorkingWithContent/Hair/XgenGuidelines/HairUV_XGen.jpg">
		<img class="  lazyload" alt="HairUV_XGen.png" data-src="../../../../Images/WorkingWithContent/Hair/XgenGuidelines/HairUV_XGen.jpg" />
</picture>

</p></li><li class="Default"><p>你可以根据自己的偏好为项目创建导线并涂刷毛发。准备就绪后，选择 <strong>生成（Generate）> 缓存（Cache）> 创建新缓存（Create New Cache）</strong> 将曲线导出为 <strong>Alembic缓存（Alembic Cache）</strong>。
</p><p><picture>
		<source data-srcset="./../../../../Images/WorkingWithContent/Hair/XgenGuidelines/HairUV_2_XGen.jpg">
		<img class="  lazyload" alt="HairUV_2_XGen.png" data-src="../../../../Images/WorkingWithContent/Hair/XgenGuidelines/HairUV_2_XGen.jpg" />
</picture>

</p></li><li class="Default"><p>通过隐藏或删除XGen头发以将其移除。然后，在Maya场景中，使用源网格体重新导入之前导出的毛发曲线。
</p><p><picture>
		<source data-srcset="./../../../../Images/WorkingWithContent/Hair/XgenGuidelines/HairUV_3_XGen.jpg">
		<img class="  lazyload" alt="HairUV_3_XGen.png" data-src="../../../../Images/WorkingWithContent/Hair/XgenGuidelines/HairUV_3_XGen.jpg" />
</picture>

</p></li><li class="Default"><p>根据你的场景，顶部曲线下将有数千条样条曲线，本例中为 <strong>SplineGrp0</strong>。编辑以下Python脚本，并将以下值替换为项目中的值：
</p><ul ><li class="Default"><p>export_directory
</p></li><li class="Default"><p>hair_file
</p></li><li class="Default"><p>curve_top_group
</p></li><li class="Default"><p>uv_mesh
</p></li></ul><div class="note">
	<p>你可以在<a id="content_link" href="https://epicgames.box.com/shared/static/46my2x1sueuc6hlt09ous9czx4o8fhjz.zip" ><span>此处</span></a>下载脚本。 </p>
</div><pre class="prettyprint"><code>from maya import cmds
from maya import OpenMaya
import os

def create&#95;root&#95;uv&#95;attribute(curves&#95;group, mesh&#95;node, uv&#95;set='map1'):
    '''
    Create "groom&#95;root&#95;uv" attribute on group of curves.
    '''

    # check curves group
    if not cmds.objExists(curves&#95;group):
        raise RuntimeError('Group not found: "{}"'.format(curves&#95;group))

    # get curves in group
    curve&#95;shapes = cmds.listRelatives(curves&#95;group, shapes=True, noIntermediate=True)
    curve&#95;shapes = cmds.ls(curve&#95;shapes, type='nurbsCurve')
    if not curve&#95;shapes:
        raise RuntimeError('Invalid curves group. No nurbs-curves found in group.')
    else:
        print "found curves"
        print curve&#95;shapes

    # get curve roots
    points = list()
    for curve&#95;shape in curve&#95;shapes:
        point = cmds.pointPosition('{}.cv&#91;0&#93;'.format(curve&#95;shape), world=True)
        points.append(point)

    # get uvs
    values = list()
    uvs = find&#95;closest&#95;uv&#95;point(points, mesh&#95;node, uv&#95;set=uv&#95;set)
    for u, v in uvs:
        values.append(&#91;u, v, 0&#93;)
        #print (str(u) + " , " + str(v)  )

    # create attribute
    name = 'groom&#95;root&#95;uv'
    cmds.addAttr(curves&#95;group, ln=name, dt='vectorArray')
    cmds.addAttr(curves&#95;group, ln='{}&#95;AbcGeomScope'.format(name), dt='string')
    cmds.addAttr(curves&#95;group, ln='{}&#95;AbcType'.format(name), dt='string')

    cmds.setAttr('{}.{}'.format(curves&#95;group, name), len(values), &#42;values, type='vectorArray')
    cmds.setAttr('{}.{}&#95;AbcGeomScope'.format(curves&#95;group, name), 'uni', type='string')
    cmds.setAttr('{}.{}&#95;AbcType'.format(curves&#95;group, name), 'vector2', type='string')

    return uvs

def find&#95;closest&#95;uv&#95;point(points, mesh&#95;node, uv&#95;set='map1'):
    '''
    Find mesh UV-coordinates at given points.
    '''

    # check mesh
    if not cmds.objExists(mesh&#95;node):
        raise RuntimeError('Node not found: "{}"'.format(mesh&#95;node))

    # check uv&#95;set
    uv&#95;sets = cmds.polyUVSet(mesh&#95;node, q=True, allUVSets=True)
    if uv&#95;set not in uv&#95;sets:
        raise RuntimeError('Invalid uv&#95;set provided: "{}"'.format(uv&#95;set))

    # get mesh as dag-path
    selection&#95;list = OpenMaya.MSelectionList()
    selection&#95;list.add(mesh&#95;node)

    mesh&#95;dagpath = OpenMaya.MDagPath()
    selection&#95;list.getDagPath(0, mesh&#95;dagpath)
    mesh&#95;dagpath.extendToShape()

    # get mesh function set
    fn&#95;mesh = OpenMaya.MFnMesh(mesh&#95;dagpath)

    uvs = list()
    for i in range(len(points)):

        script&#95;util = OpenMaya.MScriptUtil()
        script&#95;util.createFromDouble(0.0, 0.0)
        uv&#95;point = script&#95;util.asFloat2Ptr()

        point = OpenMaya.MPoint(&#42;points&#91;i&#93;)
        fn&#95;mesh.getUVAtPoint(point, uv&#95;point, OpenMaya.MSpace.kWorld, uv&#95;set)

        u = OpenMaya.MScriptUtil.getFloat2ArrayItem(uv&#95;point, 0, 0)
        v = OpenMaya.MScriptUtil.getFloat2ArrayItem(uv&#95;point, 0, 1)

        uvs.append((u, v))

    return uvs

def abc&#95;export(filepath, node=None, start&#95;frame=1, end&#95;frame=1, data&#95;format='otawa', uv&#95;write=True):

    job&#95;command = '-frameRange {} {} '.format(start&#95;frame, end&#95;frame)
    job&#95;command += '-dataFormat {} '.format(data&#95;format)

    job&#95;command += '-attr groom&#95;root&#95;uv '

    if uv&#95;write:
        job&#95;command += '-uvWrite '

    job&#95;command += '-root {} '.format(node)   

    job&#95;command += '-file {} '.format(filepath) 

    cmds.AbcExport(verbose=True, j=job&#95;command)

def main():

    export&#95;directory = 'D:/Dev/Ref'
    hair&#95;file = os.path.join(export&#95;directory, 'hair&#95;export.abc')
    curve&#95;top&#95;group= 'description1&#124;SplineGrp0'
    uv&#95;mesh='pPlane1'

    create&#95;root&#95;uv&#95;attribute( curve&#95;top&#95;group , uv&#95;mesh)
    abc&#95;export(hair&#95;file, curve&#95;top&#95;group)

main()</code></pre></li><li class="Default"><p>在Maya中，使用更改后的数值运行脚本。这 <em>将</em> 生成一个新的Alembic（'.abc'）文件，该文件可以导入到虚幻引擎中。 
</p></li><li class="Default"><p>在虚幻引擎中，使用 <strong>毛发</strong> 着色模型创建新材质。在材质图表中，添加 <strong>毛发属性（Hair Attributes）</strong> 表达式，然后将 <strong>根UV（Root UV）</strong> 插入纹理样本的 <strong>UV</strong> 输入中。 
</p><p><picture>
		<source data-srcset="./../../../../Images/WorkingWithContent/Hair/XgenGuidelines/HairUV_4_XGen.jpg">
		<img class="  lazyload" alt="HairUV_4_XGen.png" data-src="../../../../Images/WorkingWithContent/Hair/XgenGuidelines/HairUV_4_XGen.jpg" />
</picture>

</p><div class="note">
	<p>The <code>groom&#95;root&#95;uv</code> attribute specifies per hair the underlying mesh UV which it is attached to. This attribute is optional, and if not specified, a root UV is automatically generated in the engine using a spherical mapping.</p>
</div></li><li class="Default"><p>将导入的毛发Alembic文件从内容浏览器拖到关卡中，然后向其指定毛发材质。你应该以如下形式结束： 
</p><div class="note">
	<p>确保关卡中的毛发Alembic文件的宽度大于0。 </p>
</div><p><picture>
		<source data-srcset="./../../../../Images/WorkingWithContent/Hair/XgenGuidelines/HairUV_5_XGen.jpg">
		<img class="  lazyload" alt="HairUV_5_XGen.png" data-src="../../../../Images/WorkingWithContent/Hair/XgenGuidelines/HairUV_5_XGen.jpg" />
</picture>

</p></li></ol>
																	</div>
					<!-- End of Markdown converted page content -->
				</div>
												<div id="pageTags">
				<div class="title">标签</div>
					<div>
					<div class="keyword_tag_filter"><a id="tag_link" href="../../../SiteIndex/index.html?tags=Hair">Hair</a></div>
<div class="keyword_tag_filter"><a id="tag_link" href="../../../SiteIndex/index.html?tags=XGen">XGen</a></div>
<div class="keyword_tag_filter"><a id="tag_link" href="../../../SiteIndex/index.html?tags=Simulation">Simulation</a></div>
<div class="keyword_tag_filter"><a id="tag_link" href="../../../SiteIndex/index.html?tags=Physics">Physics</a></div>
					</div>
				</div>
								<div id="recommendations"></div>			</div>
						<div id="footer"></div>									<div id="announcement">
			<div style="display:inline-block;margin:5px;">
				欢迎帮助改进虚幻引擎文档！请告诉我们该如何更好地为您服务。
			</div>
			<div style="margin:5px;display:inline-block;">
				<div class="btn action" style="margin-top:-6px;display:inline-block;" onclick="$('#announcement').hide();window.open('https://epicgames.questionpro.com/t/AP9dGZkjp4');createCookie('announcement-read', new Date().getTime(), 30);">填写问卷调查</div>
				<div class="btn btn-default" style="margin-top:-6px;display:inline-block;" onclick="$('#announcement').hide();createCookie('announcement-read', new Date().getTime(), 30);">取消</div>
			</div>
			<div class="btn-close" style="position:absolute;right:5px;top:10px;padding:3px;width:14px;height:14px;" onclick="$('#announcement').hide();"></div>
			</div>
					</div>
	</div></body>

<!-- Mirrored from docs.unrealengine.com/4.26/zh-CN/WorkingWithContent/Hair/XgenGuidelines/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 17 Jan 2024 10:52:32 GMT -->
</html>
