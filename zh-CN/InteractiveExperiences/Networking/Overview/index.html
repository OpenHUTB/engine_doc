<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">

<!-- Mirrored from docs.unrealengine.com/4.26/zh-CN/InteractiveExperiences/Networking/Overview/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 17 Jan 2024 10:25:12 GMT -->
<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <script src="../../../../Include/Javascript/common_zh-CN.js" type="text/javascript"></script>
	<script type="text/javascript">
		var time = new Date(0);
		var preview = false;
		var relativeHTMLPath = "https://docs.unrealengine.com/4.26/";
				var pageid = 0;
				var heroimage = "";
				var lang = "zh-CN";
				var basePath = document.location.pathname.substring(0, document.location.pathname.indexOf('/' + lang + '/') + lang.length + 1);
		document.write('<base href="' +  encodeURI(basePath) + '/InteractiveExperiences/Networking/Overview/" />');
				var udnCSS = '../../../../Include/CSS/udn_public.css';
		var udnLangCSS = '';
				udnLangCSS = './../../../../Include/CSS/udn_public_CN.css">';
				var udnOverrideCSS = '../../../../Include/CSS/skin_overrides.css';
		var udnOverrideDarkCSS = '../../../../Include/CSS/skin_overrides_dark.css';
		var fancyboxCSS = '../../../../Include/CSS/jquery.fancybox.css';
		var jqueryuiCSS = '../../../../Include/CSS/jquery-ui.min.css';
		var qtipCSS = '../../../../Include/CSS/jquery.qtip.css';
		var prettifyCSS = '../../../../Include/CSS/prettify.css';
		var navbarCSS = '../../../../Include/CSS/navBar.css';
		var twentytwentyCSS = '../../../../Include/CSS/twentytwenty.css';
		var recommendationsCSS = '../../../../Include/CSS/jquery.recommendations.css';
	</script>
    <title>网络概述 | 虚幻引擎文档</title>
    	    <meta name=viewport content="width=device-width, initial-scale=1" />
	<meta http-equiv="Cache-control" content="no-store">
    <script  src="../../../../Include/Javascript/CustomEvent.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery-3.4.0.min.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/udn.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/udn_extras.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery-ui.min.js" type="text/javascript"></script>
	    <script  src="../../../../Include/Javascript/informational.js" type="text/javascript"></script>
	    <script  src="../../../../Include/Javascript/jquery.fancybox.pack.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery.qtip.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/prettify.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery.slimscroll.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery.event.move.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery.twentytwenty.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/lazysizes.min.js" type="text/javascript"></script>
	    <script  src="../../../../Include/Javascript/jquery.recommendations.js" type="text/javascript"></script>
	
    <link async rel="icon" href="../../../../../favicon.png" type="image/x-icon" />
    <link async rel="shortcut icon" href="../../../../../favicon.png" type="image/x-icon" />
    <link async href="../../../../Include/Images/touch_icon.png" rel="apple-touch-icon" />
    <link async href="../../../../Include/Images/touch_icon_114.png" sizes="114x114" rel="apple-touch-icon" />    
		<script  src="../../../../Include/Javascript/CollapsibleLists.js" type="text/javascript"></script>
	<script  src="../../../../Include/Javascript/navigationBarUI.js"></script>
	<script  src="../../../../Include/Javascript/navigationBar.js"></script>
		
	<link rel="alternate" href="https://docs.unrealengine.com/latest/en-US/InteractiveExperiences/Networking/Overview/" hreflang="x-default" />
<link rel="alternate" href="https://docs.unrealengine.com/latest/zh-CN/InteractiveExperiences/Networking/Overview/" hreflang="zh-CN" />
<link rel="alternate" href="https://docs.unrealengine.com/latest/ja/InteractiveExperiences/Networking/Overview/" hreflang="ja" />
<link rel="alternate" href="https://docs.unrealengine.com/latest/ko/InteractiveExperiences/Networking/Overview/" hreflang="ko" />

	<meta name="redirect" content="Gameplay/Networking/Overview" />
<meta name="intsourcechangelist" content="15970176" />
<meta name="availability" content="Public" />
<meta name="title" content="网络概述" />
<meta name="parent" content="InteractiveExperiences/Networking" />
<meta name="order" content="-1" />
<meta name="description" content="设置多人游戏的联网游戏。" />
<meta name="keywords" content="network" />
<meta name="keywords" content="multiplayer " />
<meta name="keywords" content="gameplay" />
<meta name="keywords" content="introductory" />
<meta name="related" content="InteractiveExperiences/Networking/QuickStart" />
<meta name="related" content="InteractiveExperiences/Networking/Server" />
<meta name="related" content="InteractiveExperiences/Networking/Actors" />
<meta name="related" content="InteractiveExperiences/Networking/Blueprints" />
<meta name="version" content="4.23" />
<meta name="crumbs" content="%ROOT%,InteractiveExperiences,InteractiveExperiences/Networking" />

	<meta name="twitter:card" content="summary_large_image" />
	<meta property="og:title" content="网络概述" />
	<meta property="og:description" content="设置多人游戏的联网游戏。" />
		<meta property="og:image" content="" />
	</head>
<body id="webbgThree" style="visibility: hidden;" onload="document.body.style.visibility='visible';">
			<script>window.__tracking_base = 'https://tracking.unrealengine.com/';</script>
	<script src="../../../../../../tracking.unrealengine.com/tracking.js" async></script>    <div id="webThree">
				<div id="page_head">

			<edc-navigation blackListLangCodes='["de-de","es-es","es-mx","fr-fr","it-it","pt-br","ru-ru","pl-pl","tr-tr"]' locale="zh-CN" ></edc-navigation>
						<div id="pagenav">
				<div class="crumbs" id="crumbs">

	<span class="separator">></span> <a id="parent_link" href="../../index.html">创建交互体验</a>

	<span class="separator">></span> <a id="parent_link" href="../index.html">联网和多人游戏</a>

<span class="separator">></span> <span id="page">网络概述</span>
</div>				<div id="pageNavRight">
								<!-- Start of Search -->
												<div id="search_container">
					<form name="bodySearch" method="get" action="https://www.unrealengine.com/zh-CN/bing-search" onsubmit="return validateSearch()">
						<input type="image" src="../../../../Include/Images/search_box_icon.png" class="searchbutton"/>
						<input type="hidden" name="filter" value="文档" />
						<input type="text" name="keyword" placeholder="搜索文档……" class="searchbox" autocomplete="off"/>
					</form>
				</div>
								<!-- End of Search -->
				<div id="skinContainer">
	<div id="skinSelect" class="btn btn-skin" onclick="ToggleMenu($('#skinMenu'), $(this));"></div>
	<div id="skinMenu">
		<div id="light" class="btn btn-select" onclick="createCookie('skin', 'light', 365);location.reload();">Light Theme</div>
		<div id="dark" class="btn btn-select" onclick="createCookie('skin', 'dark', 365);location.reload();">Dark Theme</div>
	</div>
</div>				</div>
			</div>
		</div>						<div id="navWrapper">

			 <nav id="navPanel">
				<div class="contents-table-el"><!----><!----><!----><!----><a class="contents-table-link is-parent" href="/zh-CN/Basics/index.html">理解基础概念</a><!----></div>
				<div class="contents-table-el"><a class="contents-table-link is-parent" href="/zh-CN/WorkingWithContent/index.html">管理内容</a><!----></div>
				<div class="contents-table-el"><a class="contents-table-link is-parent" href="/zh-CN/BuildingWorlds/index.html">构建虚拟世界</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/RenderingAndGraphics/index.html">设计视觉、渲染和图形效果</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/ProgrammingAndScripting/index.html">编程和脚本编写</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/InteractiveExperiences/index.html">创建交互体验</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/AnimatingObjects/index.html">为角色和对象添加动画</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/WorkingWithMedia/index.html">使用媒体</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/ProductionPipelines/index.html">建立你的开发流程</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/TestingAndOptimization/index.html">测试并优化你的内容</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/SharingAndReleasing/index.html">项目分享及发布</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/Resources/index.html">示例与教学</a><!----></div>
				<div class="contents-table-el"><a class="contents-table-link is-parent" href="/zh-CN/WhatsNew/index.html">新内容</a></div>
			</nav>
			<div id="navigation" title="Click to toggle navigation menu"><span>></span></div>
		</div>		
		<div id="splitter">
		</div>
				<div id="contentContainer">
										<div id="pagedefault">
				<div id="product-banner">
	<div id="product-logo"></div>
</div>				<div id="pagecontainer" style="padding-right:0px;">
					<!-- Start of Markdown converted page content -->
																				<div class="hero  ">
						<div class="imgContainer"><img src="#" /></div>						<div class="info">
							<div id="pageTitle">
								<h1 id="H1TitleId">网络概述</h1>
							</div>	
							<h2 >设置多人游戏的联网游戏。</h2>
							<div id="access">
								<div class="accessContainer">
																																			</div>
							</div>
						</div>
					</div>
																				<div id="maincol">
						<div class="togglesection" id="osContainer">
	<div class="normaltitle">
		<p>Choose your operating system:</p>
	</div><div class="toggleButtons">
		<div class="btn btn-default btn-toggle OS windows" id="windows" onclick="setSelector('OS', 'windows');">
			<p>Windows</p>
		</div>
		<div class="btn btn-default btn-toggle OS mac" id="mac" onclick="setSelector('OS', 'mac');">
			<p>macOS</p>
		</div>
		<div class="btn btn-default btn-toggle OS linux" id="linux" onclick="setSelector('OS', 'linux');">
			<p>Linux</p>
		</div>
	</div>
</div>																		<div id="seeAlso">
	<div style="position:relative;">
		<div id="title">参见</div>
		<div id="pageList">
			<ul>
								<li>
					<p>
						<a id="related_link" href="../QuickStart/index.html" title="用C++创建简单的多人游戏。">多人游戏编程快速入门指南</a>
					</p>
				</li>
								<li>
					<p>
						<a id="related_link" href="../Server/index.html" title="关于服务器在多人游戏中担当角色的概述。">客户端-服务器模式</a>
					</p>
				</li>
								<li>
					<p>
						<a id="related_link" href="../Actors/index.html" title="关于复制 Actor 对象及其组件的各方面介绍。">Actor 的复制</a>
					</p>
				</li>
								<li>
					<p>
						<a id="related_link" href="../Blueprints/index.html" title="对蓝图中涉及的各类多人功能进行介绍。">蓝图中的多人功能</a>
					</p>
				</li>
							</ul>
		</div>
	</div>
</div>
																														<div class="toc">
<div style="position:relative;">
    <div class="title">
    本页面的内容
    </div>
<div id="tocScroll">
    <ul>
	    		    			    <li id="">
	<p><a id="toc_link" href="#尽早规划多人游戏">尽早规划多人游戏</a></p>
	</li>		    			    <li id="">
	<p><a id="toc_link" href="#客户端-服务器模型">客户端-服务器模型</a></p>
			<ul>
							<li id="">
	<p><a id="toc_link" href="#客户端-服务器游戏范例">客户端-服务器游戏范例</a></p>
	</li>					</ul>
	</li>		    			    <li id="">
	<p><a id="toc_link" href="#基本网络概念">基本网络概念</a></p>
			<ul>
							<li id="">
	<p><a id="toc_link" href="#网络模式和服务器类型">网络模式和服务器类型</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#actor复制">Actor复制</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#变量复制">变量复制</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#远程过程调用_rpc_">远程过程调用(RPC)</a></p>
	</li>					</ul>
	</li>		    			    <li id="">
	<p><a id="toc_link" href="#提示和深入阅读">提示和深入阅读</a></p>
			<ul>
							<li id="">
	<p><a id="toc_link" href="#基本复制actor清单">基本复制Actor清单</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#网络提示">网络提示</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#教程">教程</a></p>
	</li>					</ul>
	</li>		    	        </ul>
</div>
</div>
</div>
<p>在多人游戏会话中，游戏状态信息将通过互联网连接在多台机器之间通信，而非单独驻留于一台计算机上。玩家之间的信息共享十分微妙，并会增加部分额外步骤，因此此操作导致多人游戏编程比单人游戏编辑复杂。<strong>虚幻引擎</strong> 提供的网络框架非常强大，支持部分世界上最流行的网络游戏，可简化此流程。本页对驱动多人游戏编程的概念和可使用的网络游戏构建工具进行了概述。
</p><h2 id="尽早规划多人游戏">尽早规划多人游戏</h2>
<p>若项目可能需要多人游戏功能，则从项目开始阶段起，构建所有gameplay时都应将多人游戏功能考虑在内。若开发团队通常会在创建多人游戏时实施额外步骤，相较于单人游戏，构建gameplay的流程并不会耗时过久。长远来看，项目将便于整个团队进行调试和维护。同时，虚幻引擎中编写的多人游戏gameplay仍可在单人游戏中使用。
</p><p>但是，重构无网络情况下编译的基本代码需要梳理整个项目，几乎所有gameplay都需要重新编写。届时，开发团队成员需重新学习可能早已熟悉的编程实操。同时，网速和稳定的相关技术瓶颈也会让你措手不及。
</p><p>相较于初期规划，在项目后期引入网络功能会占用大量资源，且极为复杂。因此，除非确定项目无需多人游戏功能，否则应 <em>始终</em> 按多人游戏方向进行编程。
</p><h2 id="客户端-服务器模型">客户端-服务器模型</h2>
<p>在单人游戏或本地多人游戏中，游戏在 <strong>独立</strong> 游戏上本地运行。玩家将输入连接到一台计算机，直接控制其上所有内容，而包括Actor、场景和各玩家的用户界面在内的所有游戏项目均存在于这台本地机器上。
</p><p><picture>
		<source data-srcset="./../../../../Images/InteractiveExperiences/Networking/Overview/LocalPlayExample.jpg">
		<img class="  lazyload" alt="本地运行范例" data-src="../../../../Images/InteractiveExperiences/Networking/Overview/LocalPlayExample.jpg" />
</picture>

</p><div class="caption">
	<p>单人游戏和本地多人游戏都仅在一台机器上执行。</p>
</div><p>在网络多人游戏中，虚幻引擎使用 <strong>客户端-服务器</strong> 模型。网络中的一台计算机作为 <strong>服务器</strong> 主持多人游戏会话，而所有其他玩家的计算机作为 <strong>客户端</strong> 连接到该服务器。然后，服务器与连接的客户端分享游戏状态信息，并提供一种客户端之间通信的方法。
</p><p><picture>
		<source data-srcset="./../../../../Images/InteractiveExperiences/Networking/Overview/NetworkPlayExample.jpg">
		<img class="  lazyload" alt="网络运行范例" data-src="../../../../Images/InteractiveExperiences/Networking/Overview/NetworkPlayExample.jpg" />
</picture>

</p><div class="caption">
	<p>在网络多人游戏中，游戏将在服务器（1）与多个与之连接的客户端（2）之间进行。服务器处理gameplay，客户端向用户显示游戏。</p>
</div><p>服务器作为游戏主机，保留一个真实 <strong>授权</strong> 的游戏状态。换句话说，服务器是多人游戏实际发生的地方。客户端会远程控制其在服务器上各自拥有的 <strong>Pawn</strong>，发送过程调用以使其执行游戏操作。但服务器不会将视觉效果直接流送至客户端显示器。服务器会将游戏状态信息 <strong>复制</strong> 到各客户端，告知应存在的Actor、此类Actor的行为，以及不同变量应拥有的值。然后各客户端使用此信息，对服务器上正在发生的情况进行高度模拟。
</p><p>欲了解客户端与服务器之间的连接过程的相关额外技术信息，参见<a id="content_link"filter-data="tag_network,_multiplayer,_gameplay,_introductory" href="../Server/index.html" ><span>客户端-服务器模型</span></a>上的指南。
</p><h3 id="客户端-服务器游戏范例">客户端-服务器游戏范例</h3>
<p>我们将在多人游戏中以两个玩家为例，说明此过程对gameplay编程实践的改变方式。我们称他们为 <strong>玩家1</strong> 和 <strong>玩家2</strong>，并分析两人互射发射物的过程。
</p><div class="fullwidth">
	<table >
	<caption></caption>
	<col align=""/>
	<col align=""/>
	<thead>
		<tr >

	<th rowspan="1" colspan="1" >
			<p>本地游戏 </p>
			</th>
	
	<th rowspan="1" colspan="1" >
			<p>网络游戏 </p>
			</th>
	
</tr>	</thead>
<tbody>
	<tr >

	<td rowspan="1" colspan="1" align="">
			<p><picture>
		<source data-srcset="./../../../../Images/InteractiveExperiences/Networking/Overview/LocalMultiplayerExample.jpg">
		<img class="  lazyload" alt="本地运行范例" data-src="../../../../Images/InteractiveExperiences/Networking/Overview/LocalMultiplayerExample.jpg" />
</picture>
</p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p><picture>
		<source data-srcset="./../../../../Images/InteractiveExperiences/Networking/Overview/ClientServerExample.jpg">
		<img class="  lazyload" alt="网络运行范例2" data-src="../../../../Images/InteractiveExperiences/Networking/Overview/ClientServerExample.jpg" />
</picture>
</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>玩家1按下输入以发射武器。</strong>
</p><ul ><li class="Default"><p>玩家1的Pawn将发射其当前武器以响应此操作。 
</p></li><li class="Default"><p>玩家1的武器生成发射物，并播放附带音效和视觉效果。
</p></li></ul>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p><strong>玩家1在本地机器上按下输入以发射武器。</strong>
</p><ul ><li class="Default"><p>玩家1的本地Pawn将武器发射命令传送给服务器上对应的Pawn。
</p></li><li class="Default"><p>玩家1在服务器上的武器生成发射物。
</p></li><li class="Default"><p>服务器告知所有连接的客户端各自生成玩家1发射物的副本。
</p></li><li class="Default"><p>玩家1在服务器上的武器告知所有客户端播放武器发射音效和视觉效果。
</p></li></ul>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>玩家1的发射物从武器中射出并前移。</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p><strong>玩家1的发射物从在服务器上的武器中射出并前移。</strong>
</p><ul ><li class="Default"><p>此时，服务器告知所有客户端复制玩家1发射物发生的移动，因此各客户端上的玩家1发射物便相应移动。
</p></li></ul>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>玩家1的发射物撞击玩家2的Pawn。</strong>
</p><ul ><li class="Default"><p>碰撞将触发摧毁玩家1发射物的函数，对玩家2的Pawn造成伤害，并播放附带音效和视觉效果。 
</p></li><li class="Default"><p>玩家2播放画面效果，作为对伤害的响应。
</p></li></ul>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p><strong>玩家1在服务器上的发射物撞击玩家2的Pawn。</strong>
</p><ul ><li class="Default"><p>碰撞触发摧毁服务器上玩家1发射物的函数。
</p></li><li class="Default"><p>服务器自动告知所有客户端各自摧毁玩家1发射物副本。
</p></li><li class="Default"><p>碰撞触发告知所有客户端播放附带碰撞音效和视觉效果的函数。
</p></li><li class="Default"><p>玩家2在服务器上的Pawn承受发射物碰撞造成的伤害。
</p></li><li class="Default"><p>玩家2在服务器上的Pawn告知玩家2客户端播放画面效果，作为对伤害的响应。
</p></li></ul>
			</td>
	
</tr></tbody>
</table>
</div><p>在独立游戏中，此类所有交互都在同一台机器上的同一 <strong>场景</strong> 中发生，因此理解和编程均较为简单。例如，生成对象时，你可以认为所有玩家均能看到此对象。
</p><p>在网络游戏中，此类交互发生在多个不同场景：服务器上的场景、玩家1客户端的场景、玩家2客户端的场景，以及参与会话的其他所有客户端的额外场景。每台不同机器上的各场景均有各自的Pawn、武器及发射物的副本。服务器是游戏真正运行的地方，但我们要让客户端的场景看似发生了相同事件。因此，需要选择性地向各客户端发送信息，以在服务器上创建场景的视觉代表。
</p><p>这一过程将在基础游戏交互（碰撞、移动、伤害）、美化效果（视觉效果和音效）和私人玩家信息（HUD更新）间进行划分。这三者各自与网络中的特定机器或机组关联。但是，此信息的复制过程并非完全自动，游戏编程时须指定要复制的信息和接收副本的机器。主要的难点在于选择应复制的信息及方式，以向所有玩家提供一致的游戏体验，同时需最小化信息复制量，尽可能减少网络带宽占用率。
</p><h2 id="基本网络概念">基本网络概念</h2>
<p>以下章节将详细介绍虚幻引擎内驱动网络gameplay的概念。其中包括多种工具的概述和快速参考，以帮助协助构建多人游戏。
</p><h3 id="网络模式和服务器类型">网络模式和服务器类型</h3>
<p><strong>网络模式</strong> 描述了计算机与网络多人游戏会话的关系。游戏实例可采用以下任意网络模式：
</p><div class="fullwidth">
	<table >
	<caption></caption>
	<col align="left"/>
	<col align="left"/>
	<thead>
		<tr >

	<th rowspan="1" colspan="1" >
			<p>网络模式 </p>
			</th>
	
	<th rowspan="1" colspan="1" >
			<p>说明 </p>
			</th>
	
</tr>	</thead>
<tbody>
	<tr >

	<td rowspan="1" colspan="1" align="left">
			<p><strong>独立</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="left">
			<p>游戏作为服务器运行，不接受远程客户端连接。参与游戏的玩家必须为本地玩家。此模式用于单人游戏和本地多人游戏。其将运行本地玩家适用的服务器逻辑和客户端逻辑。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="left">
			<p><strong>客户端</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="left">
			<p>游戏作为网络多人游戏会话中与服务器连接的客户端运行。其不会运行服务器逻辑。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="left">
			<p><strong>聆听服务器</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="left">
			<p>游戏作为主持网络多人游戏会话的服务器运行。其接受远程客户端中的连接，且直接在服务器上拥有本地玩家。此模式通常用于临时合作和竞技多人游戏。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="left">
			<p><strong>专属服务器</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="left">
			<p>游戏作为主持网络多人游戏会话的服务器运行。其接受远程客户端中的连接，但无本地玩家，因此为了高效运行，其将废弃图形、音效、输入和其他面向玩家的功能。此模式常用于需要更固定、安全和大型多人功能的游戏。</p>
			</td>
	
</tr></tbody>
</table>
</div><p>拥有游戏副本的用户均可启动聆听服务器并在同一计算机上运行，因此聆听服务器对于用户而言较易自发设置。支持聆听服务器的游戏通常拥有游戏UI，用于启动服务器或搜索要加入的服务器。但由于主持聆听服务器的玩家会直接在服务器上游戏，因此比其他必须使用网络连接方可游戏的玩家更具优势，于是便导致了公平和作弊问题。同时，要作为服务器运行，还需支持如图形和音效等玩家相关系统，从而引发额外处理负载。此类因素导致聆听服务器不适用于激烈的竞技或网络负载极高的游戏，但对于小型玩家群体间进行临时合作和竞技多人游戏而言，却十分好用。
</p><p>专属服务器成本更高，更难以配置，需要独立于所有参与玩家的计算机，并需要完成自身网络连接。但所有加入专属服务器的玩家均使用相同类型的连接进行游戏，从而保证了公平性。由于专属服务器不会渲染图形或执行仅与本地玩家相关的其它逻辑，因此还可高效处理gameplay和网络。因此，出于安全、公平或可靠方面的原因，专属服务器更适用于需要大量玩家或需要高效执行、可信服务器的游戏。此类游戏包括MMO、竞技MOBA，或快节奏网络射击游戏。
</p><p><div class="note">
	<p>因为独立游戏服务器可同时作为服务器和客户端，为多人游戏创建的逻辑可在无需额外工作的情况下，在单人游戏中运行。</p>
</div>
</p><h3 id="actor复制">Actor复制</h3>
<p>复制是指在网络会话中的不同机器间复制游戏状态信息。若正确设置复制，将可同步不同机器的游戏实例。多数Actor默认不会启用复制，且将本地执行所有功能。在C++ Actor类中设置 <code>bReplicates</code> 变量，或将Actor蓝图的 <strong>复制（Replicates）</strong> 设置设为 <strong>true</strong>，可启用给定类的Actor复制。
</p><p>以下为创建网络游戏时的常见复制功能：
</p><table >
	<caption></caption>
	<col align=""/>
	<col align=""/>
	<thead>
		<tr >

	<th rowspan="1" colspan="1" >
			<p>复制功能 </p>
			</th>
	
	<th rowspan="1" colspan="1" >
			<p>说明 </p>
			</th>
	
</tr>	</thead>
<tbody>
	<tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>创建和销毁</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>服务器上生成复制Actor的授权版本时，其会在所有连接客户端上自动生成远程代理。其之后会将信息复制到这些远程代理。若销毁授权Actor，则将自动销毁所有连接客户端上的远程代理。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>移动复制</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>若授权Actor启用了 <strong>复制移动</strong>，或将C++中的 <code>bReplicateMovement</code> 设为 <code>true</code>，其将自动复制位置、旋转和速度。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>变量复制</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>在指定为复制变量的值变更时，其将自动从授权Actor复制到其远程代理。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>组件复制</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>Actor组件复制为其所属Actor的一部分。组件内指定为复制变量将复制，而组件内调用的RPC将与Actor类中调用的RPC保持一致。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>远程过程调用（RPC）</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>RPC是传输到网络游戏中特定机器的特殊函数。无论初始调用RPC的是哪台机器，其的实现仅在目标机器上运行。此类RPC可指定为服务器（仅在服务器上运行）、客户端（仅在Actor的拥有客户端上运行）或NetMulticast（在连接会话的所有机器上运行，包括服务器）。</p>
			</td>
	
</tr></tbody>
</table><p>虽然创建、销毁和移动等常见使用可自动处理，但即使启用复制，其他所有gameplay功能也不会默认自动复制。必须根据游戏的需求明确指定要复制的变量和函数。欲了解上述所有复制功能的详情，参见<a id="content_link"filter-data="tag_multiplayer tag_gameplay tag_network tag_fundamentals" href="../Actors/index.html" ><span>Actor复制</span></a>指南。
</p><p>Actor、Pawn和角色的部分常用功能不会复制：
</p><ul ><li class="Default"><p><strong>骨架网格体</strong> 和 <strong>静态网格体</strong> 组件
</p></li><li class="Default"><p><strong>材质</strong>
</p></li><li class="Default"><p><strong>动画蓝图</strong>
</p></li><li class="Default"><p><strong>粒子系统</strong>
</p></li><li class="Default"><p><strong>音效发射器</strong>
</p></li><li class="Default"><p><strong>物理对象</strong>
</p></li></ul><p>此类项目均在所有客户端上单独运行。但是，若复制驱动此类视觉元素的变量，则可确保所有客户端都具有相同信息，从而以大致相同的方式进行模拟。
</p><h4 id="网络角色和授权">网络角色和授权</h4>
<p>Actor的 <strong>网络角色</strong> 将决定网络游戏期间控制Actor的机器。<strong>授权</strong> Actor被认为可控制Actor的状态，并可将信息复制到网络多人游戏会话中的其他机器上。<strong>远程代理</strong> 是该Actor在远程机器上的副本，其将接收授权Actor中的复制信息。其由 <strong>Local Role</strong> 和 <strong>Remote Role</strong> 变量进行追踪，可取以下值：
</p><div class="fullwidth">
	<table >
	<caption></caption>
	<col align="left"/>
	<col align="left"/>
	<thead>
		<tr >

	<th rowspan="1" colspan="1" >
			<p>网络角色 </p>
			</th>
	
	<th rowspan="1" colspan="1" >
			<p>说明 </p>
			</th>
	
</tr>	</thead>
<tbody>
	<tr >

	<td rowspan="1" colspan="1" align="left">
			<p><strong>无</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="left">
			<p>Actor在网络游戏中无角色，不会复制。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="left">
			<p><strong>授权</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="left">
			<p>Actor为授权状态，会将其信息复制到其他机器上的远程代理。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="left">
			<p><strong>模拟代理</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="left">
			<p>Actor为远程代理，由另一台机器上的授权Actor完全控制。网络游戏中如拾取物、发射物或交互对象等多数Actor将在远程客户端上显示为模拟代理。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="left">
			<p><strong>自主代理</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="left">
			<p>Actor为远程代理，能够本地执行部分功能，但会接收授权Actor中的矫正。自主代理通常为玩家直接控制的actor所保留，如pawn。</p>
			</td>
	
</tr></tbody>
</table>
</div><p>虚幻引擎使用的默认模型是 <strong>服务器授权</strong>，意味着服务器对游戏状态固定具有权限，而信息固定从服务器复制到客户端。服务器上的Actor应具有授权的本地角色，而其在远程客户端上的对应Actor应具有模拟或自主代理的本地角色。
</p><p>欲了解Actor网络角色，参见<a id="content_link" href="../Actors/Roles/index.html" ><span>Actor角色和远程角色</span></a>指南。
</p><h4 id="客户端拥有权">客户端拥有权</h4>
<p>特定客户端机器上的 <strong>PlayerController</strong> 拥有网络游戏中的pawn。Pawn调用纯客户端函数时，其将无视调用函数的机器，而仅指向拥有玩家的机器。若将Actor的 <strong>Owner</strong> 变量设为特定Pawn，则通关关联，该Actor属于该Pawn的拥有客户端，并将纯客户端函数指向其拥有者的机器。可使用C++中的 <code>IsLocallyControlled</code> 函数，或蓝图中的 <strong>Is Locally Controlled</strong> 节点，以决定Pawn是否在其拥有客户端上。
</p><div class="warning">
	<p>由于构造期间Pawn可能未指定控制器，因此避免在自定义Pawn类的构造函数中使用 <code>IsLocallyControlled</code>。</p>
</div><p>有关拥有权的详情，参见<a id="content_link" href="../Actors/OwningConnections/index.html" ><span>Actor及其拥有连接</span></a>上的指南。
</p><h4 id="相关性和优先级">相关性和优先级</h4>
<p><strong>相关性</strong> 用于决定是否需要在多人游戏期间复制Actor。复制期间将剔除被认为不相关的actor。此操作可节约带宽，以便相关Actor可更加高效地复制。若Actor未被玩家拥有，且不在玩家附近，将其被视为不相关，而不会进行复制。不相关Actor会存在于服务器上，且会影响授权游戏状态，但在玩家靠近前不会向客户端发送信息。覆盖 <code>IsNetRelevantFor</code> 函数以手动控制相关性，并可使用 <code>NetCullDistanceSquared</code> 属性决定成为相关Actor所需距离。
</p><p>有时在游戏单帧内，没有足够带宽供复制所有相关Actor。因此，Actor拥有 <strong>优先级（Priority）</strong> 值，用于决定优先复制的Actor。Pawn和PlayerController的 <code>NetPriority</code> 默认为 <strong>3.0</strong>，从而使其成为游戏中最高优先级的Actor，而基础Actor的 <code>NetPriority</code> 为 <strong>1.0</strong>。Actor在被复制前经历的时间越久，每次成功通过时所处的优先级便越高。
</p><p>欲了解Actor相关性和优先级的详情，参见<a id="content_link" href="../Actors/Relevancy/index.html" ><span>网络优先级</span></a>上的指南。
</p><h3 id="变量复制">变量复制</h3>
<p>在C++中使用对应 <code>UPROPERTY</code> 宏内的 <code>Replicated</code> 或 <code>ReplicateUsing</code> 说明符，或在蓝图的细节面板中将它们指定为已复制，可将复制添加到变量和对象引用。授权Actor上复制变量的值变更时，其信息将自动从授权Actor发送到连接会话的远程代理。
</p><h4 id="repnotify">RepNotify</h4>
<p>可指定在Actor成功接收特定变量的复制信息时要调用的 <strong>RepNotify</strong> 函数。RepNotify仅在变量更新时本地触发。触发gameplay逻辑响应授权Actor上的变量更改时，使用RepNotify可减少开销。在C++中使用变量的 <code>UPROPERTY</code> 宏的 <code>ReplicatedUsing</code> 说明符可访问此功能，或修改蓝图中变量的复制设置以使用RepNotify。
</p><div class="tip">
	<p>由于RepNotify可添加到需复制的变量中，而无需考虑其他gameplay功能，创建额外网络调用时刻节约大量带宽，因此RepNotify比RPC或复制函数更加好用。</p>
</div><h3 id="远程过程调用_rpc_">远程过程调用(RPC)</h3>
<p>远程过程调用也称为复制函数。可在任何机器上进行调用，但会指示其的实现在与网络会话连接的特定机器上发生。有三种RPC：
</p><div class="fullwidth">
	<table >
	<caption></caption>
	<col align="left"/>
	<col align="left"/>
	<thead>
		<tr >

	<th rowspan="1" colspan="1" >
			<p>RPC类型 </p>
			</th>
	
	<th rowspan="1" colspan="1" >
			<p>说明 </p>
			</th>
	
</tr>	</thead>
<tbody>
	<tr >

	<td rowspan="1" colspan="1" align="left">
			<p><strong>Server</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="left">
			<p>仅在主持游戏的服务器上调用。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="left">
			<p><strong>Client</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="left">
			<p>仅在拥有该函数所属Actor的客户端上调用。若Actor无拥有连接，将不会执行此逻辑。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="left">
			<p><strong>NetMulticast</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="left">
			<p>在与服务器连接的所有客户端及服务器本身上调用。</p>
			</td>
	
</tr></tbody>
</table>
</div><p>将 <strong>细节面板（Details Panel）</strong> 中的 <strong>复制（Replicates）</strong> 下拉菜单设为三种可用类型之一，可为蓝图中的事件和函数指定相同的命名。 
</p><p><picture>
		<source data-srcset="./../../../../Images/InteractiveExperiences/Networking/Overview/ReplicatedFunction.jpg">
		<img class="  lazyload" alt="蓝图中的复制事件" data-src="../../../../Images/InteractiveExperiences/Networking/Overview/ReplicatedFunction.jpg" />
</picture>

</p><p>提供对应 <code>UFUNCTION</code> 宏中的 <code>Server</code>、<code>Client</code> 或 <code>NetMulticast</code> 说明符，可在将C++函数指定为RPC。其代码将在代码实现中使用后缀 <code>&#95;Implementation</code>。
</p><p><div class="codetitlebar">
	<p>ExampleClass.h </p>
</div></p><pre class="prettyprint"><code>//服务器RPC MyFunction的声明。
UFUNCTION(Server, Reliable, WithValidation)
void MyFunction(int myInt);</code></pre>
<p><div class="codetitlebar">
	<p>ExampleClass.cpp </p>
</div></p><pre class="prettyprint"><code>//服务器RPC MyFunction的实现。
void AExampleClass::MyFunction&#95;Implementation(int myInt)
{
    //游戏代码在此。
}</code></pre>
<p>将函数指定为RPC后，即可向其给定游戏逻辑，并以调用其他函数的方法进行调用。欲了解RPC的更多相关详情，参见<a id="content_link"filter-data="tag_rpc tag_actors tag_gameplay tag_actor_replication tag_network" href="../Actors/RPCs/index.html" ><span>远程过程调用</span></a>指南。
</p><h4 id="可靠性">可靠性</h4>
<p>必须将RPC指定为 <strong>可靠</strong> 或 <strong>不可靠</strong>。在蓝图中，函数和事件默认为不可靠。要将函数指定为可靠，将细节面板（Details Panel）中的 <strong>可靠（Reliable）</strong> 设置设为 <strong>true</strong>。在C++中，必须将 <code>Reliable</code> 或 <code>Unreliable</code> 说明符作为 <code>Server</code>、<code>Client</code> 或 <code>NetMulticast</code> 函数，添加到RPC的 <code>UFUNCTION</code> 宏及其状态。
</p><p>不可靠RPC无法保证必会到达预定目的地，但其发送速度和频率高于可靠的RPC。其最适用于对gameplay而言不重要或经常调用的函数。例如，由于Actor移动每帧都可能变换，因此使用不可靠RPC复制该Actor移动。
</p><p>可靠的RPC保证到达预定目的地，并在成功接收之前一直保留在队列中。其最适合用于对gameplay很关键或者不经常调用的函数。相关例子包括碰撞事件、武器发射的开始或结束，或生成Actor。
</p><div class="warning">
	<p>滥用可靠函数可能导致其队列溢出，此操作将强制断开连接。若逐帧调用复制函数，应将其设为不可靠。若拥有与玩家输入绑定的可靠函数，应限制玩家调用该函数的频率。</p>
</div><h4 id="验证">验证</h4>
<p><code>WithValidation</code> 说明符表明除函数的实现外，还有可验证传入函数调用的数据的函数。此验证函数与其负责的函数使用同一签名，但其将返回布尔而非原本返回值。若返回 <code>true</code>，则其允许执行RPC的 <code>Implementation</code>；若返回 <code>false</code>，则防止执行。 
</p><p><div class="codetitlebar">
	<p>ExampleClass.cpp </p>
</div></p><pre class="prettyprint"><code>//服务器RPC MyFunction的验证
bool AExampleClass::MyFunction&#95;Validation(int myInt)
{
    /&#42; 
        若myInt的值为负，建议不允许运行MyFunction&#95;Implementation。 
        因此仅在myInt大于零时返回true。
    &#42;/
    return myInt &gt;= 0;      
}</code></pre>
<h2 id="提示和深入阅读">提示和深入阅读</h2>
<p>在游戏中实现高效、稳定多人游戏系统的基本指南如下。
</p><h3 id="基本复制actor清单">基本复制Actor清单</h3>
<p>按照以下步骤，可创建复制Actor：
</p><ul ><li class="Default"><p>将Actor的复制设置设为True。
</p></li><li class="Default"><p>若复制Actor需要移动，将复制移动（Replicates Movement）设为True。
</p></li><li class="Default"><p>生成或销毁复制Actor时，确保在服务器上执行该操作。
</p></li><li class="Default"><p>设置必须在机器间共享的变量，以便进行复制。这通常适用于以gameplay为基础的变量。
</p></li><li class="Default"><p>尽量使用虚幻引擎的预制移动组件，其已针对复制进行构建。
</p></li><li class="Default"><p>若使用服务器授权模型，需确保玩家可执行的新操作均由服务器函数触发。
</p></li></ul><h3 id="网络提示">网络提示</h3>
<ul ><li class="Default"><p>尽可能少用RPC或复制蓝图函数。在合适情况下改用RepNotify。
</p></li><li class="Default"><p>组播函数会导致会话中各连接客户端的额外网络流量，需尤其少用。
</p></li><li class="Default"><p>若能保证非复制函数仅在服务器上执行，则服务器RPC中无需包含纯服务器逻辑。
</p></li><li class="Default"><p>将可靠RPC绑定到玩家输入时需谨慎。玩家可能会快速反复点击按钮，导致可靠RPC队列溢出。应采取措施限制玩家激活此项的频率。
</p></li><li class="Default"><p>若游戏频繁调用RPC或复制函数，如tick时，则应将其设为不可靠。
</p></li><li class="Default"><p>部分函数可重复使用。调用其响应游戏逻辑，然后调用其响应RepNotify，确保客户端和服务器拥有并列执行即可。
</p></li><li class="Default"><p>检查Actor的网络角色可查看其是否为 <code>ROLE&#95;Authority</code>。此方法适用于过滤函数中的执行，该函数同时在服务器和客户端上激活。
</p></li><li class="Default"><p>使用C++中的 <code>IsLocallyControlled</code> 函数或蓝图中的Is Locally Controlled函数，可检查Pawn是否受本地控制。基于执行是否与拥有客户端相关来过滤函数时，此方法十分拥有。
</p></li><li class="Default"><p>构造期间Pawn可能未被指定控制器，因此避免在构造函数脚本中使用 <code>IsLocallyControlled</code>。
</p></li></ul><h3 id="教程">教程</h3>
<p>欲全面了解使用上述原则实现简单多人游戏的方法，参见<a id="content_link"filter-data="tag_network tag_multiplayer tag_gameplay tag_basics/gettingstarted tag_quickstart" href="../QuickStart/index.html" ><span>多人游戏快速入门指南</span></a>。更多教程请参见以下链接：
</p>    <div class="topicContainer" filter-data="tag_network tag_multiplayer tag_gameplay tag_basics/gettingstarted tag_quickstart">
<!--
image:param
title:param
description:param
path:param
-->
<div class="topics item">
    <a id="topic_link" href="../QuickStart/index.html">
        		<div class="img_container">
            <p><picture>
		<source data-srcset="./../../../../Images/InteractiveExperiences/Networking/QuickStart/Preview.jpg">
		<img class="  lazyload" alt="Preview.png" data-src="../../../../Images/InteractiveExperiences/Networking/QuickStart/Preview.jpg" />
</picture>

</p>
			        </div>
		        <div class="info">
            <div class="content">
				<div class="subject">
					<div class="text ">
						多人游戏编程快速入门指南
					</div>
				</div>
                <div class="description">
                    <p>用C++创建简单的多人游戏。
</p>
                </div>
            </div>
        </div>
    </a>
</div>

</div>

<div class="topicContainer" filter-data="tag_network,_multiplayer,_gameplay,_basics/gettingstarted,_how-to">
<!--
image:param
title:param
description:param
path:param
-->
<div class="topics item">
    <a id="topic_link" href="../TestMultiplayer/index.html">
        		<div class="img_container">
            <p><picture>
		<source data-srcset="./../../../../Images/placeholder_topic.jpg">
		<img class="  lazyload" alt="placeholder_topic.png" data-src="../../../../Images/placeholder_topic.jpg" />
</picture>

</p>
			        </div>
		        <div class="info">
            <div class="content">
				<div class="subject">
					<div class="text ">
						测试多人游戏
					</div>
				</div>
                <div class="description">
                    <p>如何设置 Unreal Editor 以测试多人游戏。
</p>
                </div>
            </div>
        </div>
    </a>
</div>

</div>



																	</div>
					<!-- End of Markdown converted page content -->
				</div>
												<div id="pageTags">
				<div class="title">标签</div>
					<div>
					<div class="keyword_tag_filter"><a id="tag_link" href="../../../SiteIndex/index.html?tags=network">network</a></div>
<div class="keyword_tag_filter"><a id="tag_link" href="../../../SiteIndex/index.html?tags=multiplayer">multiplayer </a></div>
<div class="keyword_tag_filter"><a id="tag_link" href="../../../SiteIndex/index.html?tags=gameplay">gameplay</a></div>
<div class="keyword_tag_filter"><a id="tag_link" href="../../../SiteIndex/index.html?tags=introductory">introductory</a></div>
					</div>
				</div>
								<div id="recommendations"></div>			</div>
						  									<div id="announcement">
			<div style="display:inline-block;margin:5px;">
				欢迎帮助改进虚幻引擎文档！请告诉我们该如何更好地为您服务。
			</div>
			<div style="margin:5px;display:inline-block;">
				<div class="btn action" style="margin-top:-6px;display:inline-block;" onclick="$('#announcement').hide();window.open('https://epicgames.questionpro.com/t/AP9dGZkjp4');createCookie('announcement-read', new Date().getTime(), 30);">填写问卷调查</div>
				<div class="btn btn-default" style="margin-top:-6px;display:inline-block;" onclick="$('#announcement').hide();createCookie('announcement-read', new Date().getTime(), 30);">取消</div>
			</div>
			<div class="btn-close" style="position:absolute;right:5px;top:10px;padding:3px;width:14px;height:14px;" onclick="$('#announcement').hide();"></div>
			</div>
					</div>
	</div></body>

<!-- Mirrored from docs.unrealengine.com/4.26/zh-CN/InteractiveExperiences/Networking/Overview/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 17 Jan 2024 10:25:17 GMT -->
</html>
