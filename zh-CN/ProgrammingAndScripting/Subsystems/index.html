<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">

<!-- Mirrored from docs.unrealengine.com/4.26/zh-CN/ProgrammingAndScripting/Subsystems/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 17 Jan 2024 10:23:44 GMT -->
<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <script src="../../../Include/Javascript/common_zh-CN.js" type="text/javascript"></script>
	<script type="text/javascript">
		var time = new Date(0);
		var preview = false;
		var relativeHTMLPath = "https://docs.unrealengine.com/4.26/";
				var pageid = 0;
				var heroimage = "";
				var lang = "zh-CN";
				var basePath = document.location.pathname.substring(0, document.location.pathname.indexOf('/' + lang + '/') + lang.length + 1);
		document.write('<base href="' +  encodeURI(basePath) + '/ProgrammingAndScripting/Subsystems/" />');
				var udnCSS = '../../../Include/CSS/udn_public.css';
		var udnLangCSS = '';
				udnLangCSS = './../../../Include/CSS/udn_public_CN.css">';
				var udnOverrideCSS = '../../../Include/CSS/skin_overrides.css';
		var udnOverrideDarkCSS = '../../../Include/CSS/skin_overrides_dark.css';
		var fancyboxCSS = '../../../Include/CSS/jquery.fancybox.css';
		var jqueryuiCSS = '../../../Include/CSS/jquery-ui.min.css';
		var qtipCSS = '../../../Include/CSS/jquery.qtip.css';
		var prettifyCSS = '../../../Include/CSS/prettify.css';
		var navbarCSS = '../../../Include/CSS/navBar.css';
		var twentytwentyCSS = '../../../Include/CSS/twentytwenty.css';
		var recommendationsCSS = '../../../Include/CSS/jquery.recommendations.css';
	</script>
    <title>编程子系统 | 虚幻引擎文档</title>
    	    <meta name=viewport content="width=device-width, initial-scale=1" />
	<meta http-equiv="Cache-control" content="no-store">
    <script  src="../../../Include/Javascript/CustomEvent.js" type="text/javascript"></script>
    <script  src="../../../Include/Javascript/jquery-3.4.0.min.js" type="text/javascript"></script>
    <script  src="../../../Include/Javascript/udn.js" type="text/javascript"></script>
    <script  src="../../../Include/Javascript/udn_extras.js" type="text/javascript"></script>
    <script  src="../../../Include/Javascript/jquery-ui.min.js" type="text/javascript"></script>
	    <script  src="../../../Include/Javascript/informational.js" type="text/javascript"></script>
	    <script  src="../../../Include/Javascript/jquery.fancybox.pack.js" type="text/javascript"></script>
    <script  src="../../../Include/Javascript/jquery.qtip.js" type="text/javascript"></script>
    <script  src="../../../Include/Javascript/prettify.js" type="text/javascript"></script>
    <script  src="../../../Include/Javascript/jquery.slimscroll.js" type="text/javascript"></script>
    <script  src="../../../Include/Javascript/jquery.event.move.js" type="text/javascript"></script>
    <script  src="../../../Include/Javascript/jquery.twentytwenty.js" type="text/javascript"></script>
    <script  src="../../../Include/Javascript/lazysizes.min.js" type="text/javascript"></script>
	    <script  src="../../../Include/Javascript/jquery.recommendations.js" type="text/javascript"></script>
	
    <link async rel="icon" href="../../../../favicon.png" type="image/x-icon" />
    <link async rel="shortcut icon" href="../../../../favicon.png" type="image/x-icon" />
    <link async href="../../../Include/Images/touch_icon.png" rel="apple-touch-icon" />
    <link async href="../../../Include/Images/touch_icon_114.png" sizes="114x114" rel="apple-touch-icon" />    
		<script  src="../../../Include/Javascript/CollapsibleLists.js" type="text/javascript"></script>
	<script  src="../../../Include/Javascript/navigationBarUI.js"></script>
	<script  src="../../../Include/Javascript/navigationBar.js"></script>
		
	<link rel="alternate" href="https://docs.unrealengine.com/latest/en-US/ProgrammingAndScripting/Subsystems/" hreflang="x-default" />
<link rel="alternate" href="https://docs.unrealengine.com/latest/zh-CN/ProgrammingAndScripting/Subsystems/" hreflang="zh-CN" />
<link rel="alternate" href="https://docs.unrealengine.com/latest/ja/ProgrammingAndScripting/Subsystems/" hreflang="ja" />
<link rel="alternate" href="https://docs.unrealengine.com/latest/ko/ProgrammingAndScripting/Subsystems/" hreflang="ko" />

	<meta name="redirect" content="Programming/Subsystems" />
<meta name="intsourcechangelist" content="14288231" />
<meta name="availability" content="Public" />
<meta name="title" content="编程子系统" />
<meta name="description" content="虚幻引擎4编程子系统概览。" />
<meta name="version" content="4.22" />
<meta name="parent" content="ProgrammingAndScripting" />
<meta name="keywords" content="subsystems" />
<meta name="crumbs" content="%ROOT%,ProgrammingAndScripting" />

	<meta name="twitter:card" content="summary_large_image" />
	<meta property="og:title" content="编程子系统" />
	<meta property="og:description" content="虚幻引擎4编程子系统概览。" />
		<meta property="og:image" content="" />
	</head>
<body id="webbgThree" style="visibility: hidden;" onload="document.body.style.visibility='visible';">
			<script>window.__tracking_base = 'https://tracking.unrealengine.com/';</script>
	<script src="../../../../../tracking.unrealengine.com/tracking.js" async></script>    <div id="webThree">
				<div id="page_head">

			<edc-navigation blackListLangCodes='["de-de","es-es","es-mx","fr-fr","it-it","pt-br","ru-ru","pl-pl","tr-tr"]' locale="zh-CN" ></edc-navigation>
						<div id="pagenav">
				<div class="crumbs" id="crumbs">

	<span class="separator">></span> <a id="parent_link" href="../index.html">编程和脚本编写</a>

<span class="separator">></span> <span id="page">编程子系统</span>
</div>				<div id="pageNavRight">
								<!-- Start of Search -->
												<div id="search_container">
					<form name="bodySearch" method="get" action="https://www.unrealengine.com/zh-CN/bing-search" onsubmit="return validateSearch()">
						<input type="image" src="../../../Include/Images/search_box_icon.png" class="searchbutton"/>
						<input type="hidden" name="filter" value="文档" />
						<input type="text" name="keyword" placeholder="搜索文档……" class="searchbox" autocomplete="off"/>
					</form>
				</div>
								<!-- End of Search -->
				<div id="skinContainer">
	<div id="skinSelect" class="btn btn-skin" onclick="ToggleMenu($('#skinMenu'), $(this));"></div>
	<div id="skinMenu">
		<div id="light" class="btn btn-select" onclick="createCookie('skin', 'light', 365);location.reload();">Light Theme</div>
		<div id="dark" class="btn btn-select" onclick="createCookie('skin', 'dark', 365);location.reload();">Dark Theme</div>
	</div>
</div>				</div>
			</div>
		</div>						<div id="navWrapper">
			<div id="nav-filter-container">
				<div id="nav-filter-inner">
					<form>
						<input type="text" placeholder="Filter pages..." id="nav-filter" onchange="clearTimeout(filterTimer); filterTimer = setTimeout(updateNavTreeFilter,250, this.value);if(this.value.length == 0){$('#filter-clear').hide();}else{$('#filter-clear').show();}" onkeypress="this.onchange();" onpaste="this.onchange();" oninput="this.onchange();" />
						<button class="close-icon" id="filter-clear" type="reset" onclick="clearTimeout(filterTimer); filterTimer = setTimeout(updateNavTreeFilter,250, '');$(this).hide();"></button>
					</form>
				</div>
			</div>
			<nav id="navPanel">
			</nav>
			<div id="navigation" title="Click to toggle navigation menu"><span>></span></div>
		</div>		
		<div id="splitter">
		</div>
				<div id="contentContainer">
										<div id="pagedefault">
				<div id="product-banner">
	<div id="product-logo"></div>
</div>				<div id="pagecontainer" style="padding-right:0px;">
					<!-- Start of Markdown converted page content -->
																				<div class="hero  ">
						<div class="imgContainer"><img src="#" /></div>						<div class="info">
							<div id="pageTitle">
								<h1 id="H1TitleId">编程子系统</h1>
							</div>	
							<h2 >虚幻引擎4编程子系统概览。</h2>
							<div id="access">
								<div class="accessContainer">
																																			</div>
							</div>
						</div>
					</div>
																				<div id="maincol">
						<div class="togglesection" id="osContainer">
	<div class="normaltitle">
		<p>Choose your operating system:</p>
	</div><div class="toggleButtons">
		<div class="btn btn-default btn-toggle OS windows" id="windows" onclick="setSelector('OS', 'windows');">
			<p>Windows</p>
		</div>
		<div class="btn btn-default btn-toggle OS mac" id="mac" onclick="setSelector('OS', 'mac');">
			<p>macOS</p>
		</div>
		<div class="btn btn-default btn-toggle OS linux" id="linux" onclick="setSelector('OS', 'linux');">
			<p>Linux</p>
		</div>
	</div>
</div>																																				<div class="toc">
<div style="position:relative;">
    <div class="title">
    本页面的内容
    </div>
<div id="tocScroll">
    <ul>
	    		    			    <li id="">
	<p><a id="toc_link" href="#使用子系统的原因">使用子系统的原因</a></p>
	</li>		    			    <li id="">
	<p><a id="toc_link" href="#用蓝图访问子系统">用蓝图访问子系统</a></p>
	</li>		    			    <li id="">
	<p><a id="toc_link" href="#用python访问子系统">用Python访问子系统</a></p>
	</li>		    			    <li id="">
	<p><a id="toc_link" href="#子系统生命周期细节">子系统生命周期细节</a></p>
			<ul>
							<li id="">
	<p><a id="toc_link" href="#引擎子系统">引擎子系统</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#编辑器子系统">编辑器子系统</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#gameinstance子系统">GameInstance子系统</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#localplayer子系统">LocalPlayer子系统</a></p>
	</li>					</ul>
	</li>		    			    <li id="">
	<p><a id="toc_link" href="#子系统范例">子系统范例</a></p>
	</li>		    	        </ul>
</div>
</div>
</div>
<p>虚幻引擎4（UE4）中的子系统是生命周期受控的自动实例化类。这些类提供了易用的扩展点，程序员可直接获得蓝图和Python公开，同时避免繁复的引擎类修改或覆盖。
</p><p>当前支持的子系统生命周期包括：
</p><div class="simpletable">
	<table >
	<caption></caption>
	<col align=""/>
	<col align=""/>
	<thead>
		<tr >

	<th rowspan="1" colspan="1" >
			<p>子系统 </p>
			</th>
	
	<th rowspan="1" colspan="1" >
			<p>继承自 </p>
			</th>
	
</tr>	</thead>
<tbody>
	<tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>引擎</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p><code>UEngineSubsystem</code> 类</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>编辑器</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p><code>UEditorSubsystem</code> 类</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>游戏实例</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p><code>UGameInstanceSubsystem</code> 类</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>本地玩家</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p><code>ULocalPlayerSubsystem</code> 类</p>
			</td>
	
</tr></tbody>
</table>
</div><p>举例而言，如果创建了一个派生自此基类的类：
</p><pre class="prettyprint"><code>class UMyGamesSubsystem : public UGameInstanceSubsystem</code></pre>
<p>将出现以下结果：
</p><ol ><li class="Default"><p>创建 <code>UGameInstance</code> 之后，还会创建一个名为 <code>UMyGamesSubsystem</code> 的实例。
</p></li><li class="Default"><p><code>UGameInstance</code> 初始化时，将在子系统上调用 <code>Initialize()</code>。
</p></li><li class="Default"><p><code>UGameInstance</code> 关闭时，将在子系统上调用 <code>Deinitialize()</code>。
</p></li><li class="Default"><p>此时将放弃对子系统的引用，如果不再有对子系统的引用，则其将被垃圾回收。
</p></li></ol><h2 id="使用子系统的原因">使用子系统的原因</h2>
<p>使用编程子系统有以下几个原因：
</p><ul ><li class="Default"><p>子系统可节省编程时间。
</p></li><li class="Default"><p>子系统使您无需覆盖引擎类。
</p></li><li class="Default"><p>子系统使您无需再已经很复杂的类上添加更多API。
</p></li><li class="Default"><p>子系统使您能通过用户友好的类型化节点来访问蓝图。
</p></li><li class="Default"><p>子系统允许访问Python脚本来编写编辑器脚本或编写测试代码。
</p></li><li class="Default"><p>子系统在代码库中提供模块化和一致性。
</p></li></ul><p>子系统在创建插件时尤为实用。您不需要代码相关的说明即可让插件工作。用户只需将插件添加到游戏中，就可以确切了解插件将在何时被实例化和初始化。因此，您可以专注于UE4中提供的API和功能的使用方式。
</p><h2 id="用蓝图访问子系统">用蓝图访问子系统</h2>
<p>子系统将自动公开到蓝图，智能节点理解情境，且不需要强制转换。您可以使用标准的 <code>UFUNCTION()</code> 标记和规则来控制蓝图可以使用哪些API。
</p><p>右键点击蓝图图表来显示快捷菜单并搜索"子系统"，将出现类似于下图的内容。这里有每个主要类型的类目，以及每个特定子系统的单个条目。<br /><picture>
		<source data-srcset="./../../../Images/ProgrammingAndScripting/Subsystems/Subsystems_01.jpg">
		<img class="  lazyload" alt="Subsystems_01.png" data-src="../../../Images/ProgrammingAndScripting/Subsystems/Subsystems_01.jpg" />
</picture>

</p><p>如果从上添加节点，将得到如下结果。<br /><picture>
		<source data-srcset="./../../../Images/ProgrammingAndScripting/Subsystems/Subsystems_02.jpg">
		<img class="  lazyload" alt="Subsystems_02.png" data-src="../../../Images/ProgrammingAndScripting/Subsystems/Subsystems_02.jpg" />
</picture>

</p><h2 id="用python访问子系统">用Python访问子系统</h2>
<p>如果正在使用Python，则可以用内置访问器来访问子系统，如下方示例所示。
</p><pre class="prettyprint"><code>my&#95;engine&#95;subsystem = unreal.get&#95;engine&#95;subsystem(unreal.MyEngineSubsystem)
my&#95;editor&#95;subsystem = unreal.get&#95;editor&#95;subsystem(unreal.MyEditorSubsystem)</code></pre>
<div class="note">
	<p>Python当前是一个实验性功能。</p>
</div><h2 id="子系统生命周期细节">子系统生命周期细节</h2>
<h3 id="引擎子系统">引擎子系统</h3>
<pre class="prettyprint"><code>class UMyEngineSubsystem : public UEngineSubsystem { ... };</code></pre>
<p>当引擎子系统的模块加载时，子系统将在模块的 <code>Startup()</code> 函数返回后执行 <code>Initialize()</code>，子系统将在模块的 <code>Shutdown()</code> 函数返回后执行 <code>Deinitialize()</code>。
</p><p>这些子系统通过GEngine访问，如下所示。
</p><pre class="prettyprint"><code>UMyEngineSubsystem&#42; MySubsystem = GEngine-&gt;GetEngineSubsystem&lt;UMyEngineSubsystem&gt;();</code></pre>
<h3 id="编辑器子系统">编辑器子系统</h3>
<pre class="prettyprint"><code>class UMyEditorSubsystem : public UEditorSubsystem { ... };</code></pre>
<p>当编辑器子系统的模块加载时，子系统将在模块的 <code>Startup()</code> 函数返回后执行 <code>Initialize()</code>，子系统将在模块的 <code>Shutdown()</code> 函数返回后执行 <code>Deinitialize()</code>。
</p><p>这些子系统可通过GEEditor访问，如下所示。
</p><pre class="prettyprint"><code>UMyEditorSubsystem&#42; MySubsystem = GEditor-&gt;GetEditorSubsystem&lt;UMyEditorSubsystem&gt;();</code></pre>
<h3 id="gameinstance子系统">GameInstance子系统</h3>
<pre class="prettyprint"><code>class UMyGameSubsystem : public UGameInstanceSubsystem { ... };</code></pre>
<p>这些子系统可通过UGameInstance访问，如下所示。
</p><pre class="prettyprint"><code>UGameInstance&#42; GameInstance = ...;
UMyGameSubsystem&#42; MySubsystem = GameInstance-&gt;GetSubsystem&lt;UMyGameSubsystem&gt;();</code></pre>
<h3 id="localplayer子系统">LocalPlayer子系统</h3>
<pre class="prettyprint"><code>class UMyPlayerSubsystem : public ULocalPlayerSubsystem { ... };</code></pre>
<p>这些子系统可通过ULocalPlayer访问，如下所示。
</p><pre class="prettyprint"><code>ULocalPlayer&#42; LocalPlayer = ...;
UMyPlayerSubsystem &#42; MySubsystem = LocalPlayer-&gt;GetSubsystem&lt;UMyPlayerSubsystem&gt;();</code></pre>
<h2 id="子系统范例">子系统范例</h2>
<p>在以下示例中，我们希望为游戏添加一个统计数据系统，以跟踪收集资源的数量。
</p><p>我们可以从 <code>UGameInstance</code> 派生，并创建 <code>UMyGamesGameInstance</code>，然后为其添加 <code>IncrementResourceStat()</code> 函数。然而我们知道，团队最终希望添加其他统计数据以及统计数据聚合器和统计数据的保存/加载等。因此，您决定将所有这些内容放入类中，例如 <code>UMyGamesStatsSubsystem</code>。
</p><p>同样，我们可以创建 <code>UMyGamesGameInstance</code> 并添加 <code>UMyGamesStatsSubsystem</code> 类型的成员。然后我们可以向它添加一个存取器，并连接Initialize和Deinitialize函数。然而这会存在几个问题。
</p><ul ><li class="Default"><p>不存在 <code>UGameInstance</code> 的游戏特定导数。
</p></li><li class="Default"><p><code>UMyGamesGameInstance</code> 存在，但是它已拥有大量函数，添加更多函数并不理想。
</p></li></ul><p>在一个足够复杂的游戏中，从 <code>UGameInstance</code> 进行派生有很多好处。然而当您拥有子系统时，便不需要使用它。最重要的是，较之于使用其他方法，使用子系统需要编写的代码更少。
</p><p>因此，我们最终使用的代码将显示在下例中。
</p><pre class="prettyprint"><code>UCLASS()
class UMyGamesStatsSubsystem : public UGameInstanceSubsystem
{
    GENERATED&#95;BODY()
public:
    // Begin USubsystem
    virtual void Initialize(FSubsystemCollectionBase&amp; Collection) override;
    virtual void Deinitialize() override;
    // End USubsystem

    void IncrementResourceStat();
private:
    // All my variables
};</code></pre>

																	</div>
					<!-- End of Markdown converted page content -->
				</div>
												<div id="pageTags">
				<div class="title">标签</div>
					<div>
					<div class="keyword_tag_filter"><a id="tag_link" href="../../SiteIndex/index.html?tags=subsystems">subsystems</a></div>
					</div>
				</div>
								<div id="recommendations"></div>			</div>
						  									<div id="announcement">
			<div style="display:inline-block;margin:5px;">
				欢迎帮助改进虚幻引擎文档！请告诉我们该如何更好地为您服务。
			</div>
			<div style="margin:5px;display:inline-block;">
				<div class="btn action" style="margin-top:-6px;display:inline-block;" onclick="$('#announcement').hide();window.open('https://epicgames.questionpro.com/t/AP9dGZkjp4');createCookie('announcement-read', new Date().getTime(), 30);">填写问卷调查</div>
				<div class="btn btn-default" style="margin-top:-6px;display:inline-block;" onclick="$('#announcement').hide();createCookie('announcement-read', new Date().getTime(), 30);">取消</div>
			</div>
			<div class="btn-close" style="position:absolute;right:5px;top:10px;padding:3px;width:14px;height:14px;" onclick="$('#announcement').hide();"></div>
			</div>
					</div>
	</div></body>

<!-- Mirrored from docs.unrealengine.com/4.26/zh-CN/ProgrammingAndScripting/Subsystems/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 17 Jan 2024 10:23:45 GMT -->
</html>
