<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">

<!-- Mirrored from docs.unrealengine.com/4.26/zh-CN/Resources/Showcases/BlueprintMultiplayer/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 17 Jan 2024 11:55:08 GMT -->
<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <script src="../../../../Include/Javascript/common_zh-CN.js" type="text/javascript"></script>
	<script type="text/javascript">
		var time = new Date(0);
		var preview = false;
		var relativeHTMLPath = "https://docs.unrealengine.com/4.26/";
				var pageid = 0;
				var heroimage = "";
				var lang = "zh-CN";
				var basePath = document.location.pathname.substring(0, document.location.pathname.indexOf('/' + lang + '/') + lang.length + 1);
		document.write('<base href="' +  encodeURI(basePath) + '/Resources/Showcases/BlueprintMultiplayer/" />');
				var udnCSS = '../../../../Include/CSS/udn_public.css';
		var udnLangCSS = '';
				udnLangCSS = './../../../../Include/CSS/udn_public_CN.css">';
				var udnOverrideCSS = '../../../../Include/CSS/skin_overrides.css';
		var udnOverrideDarkCSS = '../../../../Include/CSS/skin_overrides_dark.css';
		var fancyboxCSS = '../../../../Include/CSS/jquery.fancybox.css';
		var jqueryuiCSS = '../../../../Include/CSS/jquery-ui.min.css';
		var qtipCSS = '../../../../Include/CSS/jquery.qtip.css';
		var prettifyCSS = '../../../../Include/CSS/prettify.css';
		var navbarCSS = '../../../../Include/CSS/navBar.css';
		var twentytwentyCSS = '../../../../Include/CSS/twentytwenty.css';
		var recommendationsCSS = '../../../../Include/CSS/jquery.recommendations.css';
	</script>
    <title>多人枪战游戏 | 虚幻引擎文档</title>
    	    <meta name=viewport content="width=device-width, initial-scale=1" />
	<meta http-equiv="Cache-control" content="no-store">
    <script  src="../../../../Include/Javascript/CustomEvent.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery-3.4.0.min.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/udn.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/udn_extras.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery-ui.min.js" type="text/javascript"></script>
	    <script  src="../../../../Include/Javascript/informational.js" type="text/javascript"></script>
	    <script  src="../../../../Include/Javascript/jquery.fancybox.pack.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery.qtip.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/prettify.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery.slimscroll.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery.event.move.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery.twentytwenty.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/lazysizes.min.js" type="text/javascript"></script>
	    <script  src="../../../../Include/Javascript/jquery.recommendations.js" type="text/javascript"></script>
	
    <link async rel="icon" href="../../../../../favicon.png" type="image/x-icon" />
    <link async rel="shortcut icon" href="../../../../../favicon.png" type="image/x-icon" />
    <link async href="../../../../Include/Images/touch_icon.png" rel="apple-touch-icon" />
    <link async href="../../../../Include/Images/touch_icon_114.png" sizes="114x114" rel="apple-touch-icon" />    
		<script  src="../../../../Include/Javascript/CollapsibleLists.js" type="text/javascript"></script>
	<script  src="../../../../Include/Javascript/navigationBarUI.js"></script>
	<script  src="../../../../Include/Javascript/navigationBar.js"></script>
		
	<link rel="alternate" href="https://docs.unrealengine.com/latest/en-US/Resources/Showcases/BlueprintMultiplayer/" hreflang="x-default" />
<link rel="alternate" href="https://docs.unrealengine.com/latest/zh-CN/Resources/Showcases/BlueprintMultiplayer/" hreflang="zh-CN" />
<link rel="alternate" href="https://docs.unrealengine.com/latest/ja/Resources/Showcases/BlueprintMultiplayer/" hreflang="ja" />
<link rel="alternate" href="https://docs.unrealengine.com/latest/ko/Resources/Showcases/BlueprintMultiplayer/" hreflang="ko" />

	<meta name="intsourcechangelist" content="16146891" />
<meta name="availability" content="Public" />
<meta name="title" content="多人枪战游戏" />
<meta name="description" content="分析多人游戏案例中的蓝图以及它们是如何构建的。" />
<meta name="related" content="ProgrammingAndScripting/Blueprints" />
<meta name="related" content="InteractiveExperiences/UMG" />
<meta name="related" content="ProgrammingAndScripting/Online" />
<meta name="related" content="ProgrammingAndScripting/Online/Steam" />
<meta name="related" content="InteractiveExperiences/Networking/Actors" />
<meta name="related" content="Resources/ContentExamples/Networking" />
<meta name="version" content="4.9" />
<meta name="topic-image" content="MultiplayerShootout_Featured-476x246-c51d69c862538ea6fb72a13f7a0034e0.png" />
<meta name="crumbs" content="%ROOT%,Resources,Resources/Showcases" />

	<meta name="twitter:card" content="summary_large_image" />
	<meta property="og:title" content="多人枪战游戏" />
	<meta property="og:description" content="分析多人游戏案例中的蓝图以及它们是如何构建的。" />
		<meta property="og:image" content="" />
	</head>
<body id="webbgThree" style="visibility: hidden;" onload="document.body.style.visibility='visible';">
			<script>window.__tracking_base = 'https://tracking.unrealengine.com/';</script>
	<script src="../../../../../../tracking.unrealengine.com/tracking.js" async></script>    <div id="webThree">
				<div id="page_head">

			<edc-navigation blackListLangCodes='["de-de","es-es","es-mx","fr-fr","it-it","pt-br","ru-ru","pl-pl","tr-tr"]' locale="zh-CN" ></edc-navigation>
						<div id="pagenav">
				<div class="crumbs" id="crumbs">

	<span class="separator">></span> <a id="parent_link" href="../../index.html">示例与教学</a>

	<span class="separator">></span> <a id="parent_link" href="../index.html">引擎特性示例</a>

<span class="separator">></span> <span id="page">多人枪战游戏</span>
</div>				<div id="pageNavRight">
								<!-- Start of Search -->
												<div id="search_container">
					<form name="bodySearch" method="get" action="https://www.unrealengine.com/zh-CN/bing-search" onsubmit="return validateSearch()">
						<input type="image" src="../../../../Include/Images/search_box_icon.png" class="searchbutton"/>
						<input type="hidden" name="filter" value="文档" />
						<input type="text" name="keyword" placeholder="搜索文档……" class="searchbox" autocomplete="off"/>
					</form>
				</div>
								<!-- End of Search -->
				<div id="skinContainer">
	<div id="skinSelect" class="btn btn-skin" onclick="ToggleMenu($('#skinMenu'), $(this));"></div>
	<div id="skinMenu">
		<div id="light" class="btn btn-select" onclick="createCookie('skin', 'light', 365);location.reload();">Light Theme</div>
		<div id="dark" class="btn btn-select" onclick="createCookie('skin', 'dark', 365);location.reload();">Dark Theme</div>
	</div>
</div>				</div>
			</div>
		</div>						<div id="navWrapper">

			 <nav id="navPanel">
				<div class="contents-table-el"><!----><!----><!----><!----><a class="contents-table-link is-parent" href="/zh-CN/Basics/index.html">理解基础概念</a><!----></div>
				<div class="contents-table-el"><a class="contents-table-link is-parent" href="/zh-CN/WorkingWithContent/index.html">管理内容</a><!----></div>
				<div class="contents-table-el"><a class="contents-table-link is-parent" href="/zh-CN/BuildingWorlds/index.html">构建虚拟世界</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/RenderingAndGraphics/index.html">设计视觉、渲染和图形效果</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/ProgrammingAndScripting/index.html">编程和脚本编写</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/InteractiveExperiences/index.html">创建交互体验</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/AnimatingObjects/index.html">为角色和对象添加动画</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/WorkingWithMedia/index.html">使用媒体</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/ProductionPipelines/index.html">建立你的开发流程</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/TestingAndOptimization/index.html">测试并优化你的内容</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/SharingAndReleasing/index.html">项目分享及发布</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/Resources/index.html">示例与教学</a><!----></div>
				<div class="contents-table-el"><a class="contents-table-link is-parent" href="/zh-CN/WhatsNew/index.html">新内容</a></div>
			</nav>
			<div id="navigation" title="Click to toggle navigation menu"><span>></span></div>
		</div>		
		<div id="splitter">
		</div>
				<div id="contentContainer">
										<div id="pagedefault">
				<div id="product-banner">
	<div id="product-logo"></div>
</div>				<div id="pagecontainer" style="padding-right:0px;">
					<!-- Start of Markdown converted page content -->
																				<div class="hero  ">
						<div class="imgContainer"><img src="#" /></div>						<div class="info">
							<div id="pageTitle">
								<h1 id="H1TitleId">多人枪战游戏</h1>
							</div>	
							<h2 >分析多人游戏案例中的蓝图以及它们是如何构建的。</h2>
							<div id="access">
								<div class="accessContainer">
																																			</div>
							</div>
						</div>
					</div>
																				<div id="maincol">
						<div class="togglesection" id="osContainer">
	<div class="normaltitle">
		<p>Choose your operating system:</p>
	</div><div class="toggleButtons">
		<div class="btn btn-default btn-toggle OS windows" id="windows" onclick="setSelector('OS', 'windows');">
			<p>Windows</p>
		</div>
		<div class="btn btn-default btn-toggle OS mac" id="mac" onclick="setSelector('OS', 'mac');">
			<p>macOS</p>
		</div>
		<div class="btn btn-default btn-toggle OS linux" id="linux" onclick="setSelector('OS', 'linux');">
			<p>Linux</p>
		</div>
	</div>
</div>																		<div id="seeAlso">
	<div style="position:relative;">
		<div id="title">参见</div>
		<div id="pageList">
			<ul>
								<li>
					<p>
						<a id="related_link" href="../../../ProgrammingAndScripting/Blueprints/index.html" title="关于使用蓝图可视化脚本系统制作游戏的介绍。">蓝图可视化脚本</a>
					</p>
				</li>
								<li>
					<p>
						<a id="related_link" href="../../../InteractiveExperiences/UMG/index.html" title="本文是使用虚幻示意图形来创建UI元素的指南。">UMG UI设计器</a>
					</p>
				</li>
								<li>
					<p>
						<a id="related_link" href="../../../ProgrammingAndScripting/Online/index.html" title="在线平台相关各系统的概述。">在线子系统</a>
					</p>
				</li>
								<li>
					<p>
						<a id="related_link" href="../../../ProgrammingAndScripting/Online/Steam/index.html" title="Online Subsystem Steam的概述，包括如何设置项目以在Valve的Steam平台上分发。">Online Subsystem Steam</a>
					</p>
				</li>
								<li>
					<p>
						<a id="related_link" href="../../../InteractiveExperiences/Networking/Actors/index.html" title="关于复制 Actor 对象及其组件的各方面介绍。">Actor 的复制</a>
					</p>
				</li>
								<li>
					<p>
						<a id="related_link" href="../../ContentExamples/Networking/index.html" title="介绍"网络功能内容示例地图"中的示例。">联网内容示例</a>
					</p>
				</li>
							</ul>
		</div>
	</div>
</div>
																														<div class="raw">
	<p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/MultiplayerExample_Header.jpg">
		<img class="  lazyload" alt="MultiplayerExample_Header.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/MultiplayerExample_Header.jpg" />
</picture>
</p>
</div><div class="toc">
<div style="position:relative;">
    <div class="title">
    本页面的内容
    </div>
<div id="tocScroll">
    <ul>
	    		    			    <li id="">
	<p><a id="toc_link" href="#开始/进行游戏">开始/进行游戏</a></p>
	</li>		    			    <li id="">
	<p><a id="toc_link" href="#项目设置/配置">项目设置/配置</a></p>
			<ul>
							<li id="">
	<p><a id="toc_link" href="#配置设置">配置设置</a></p>
	</li>					</ul>
	</li>		    			    <li id="">
	<p><a id="toc_link" href="#蓝图演示">蓝图演示</a></p>
			<ul>
							<li id="">
	<p><a id="toc_link" href="#启动">启动</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#创建游戏">创建游戏</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#加入游戏">加入游戏</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#游戏性">游戏性</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#从游戏中离开">从游戏中离开</a></p>
	</li>					</ul>
	</li>		    	        </ul>
</div>
</div>
</div>
<p><strong>简单蓝图多人游戏（Simple Blueprint Multiplayer）</strong> 是一个完全由 <strong>蓝图</strong> 和 <strong>UMG用户界面（UMG UI）</strong> 编写的游戏，可以作为如何使用蓝图的 <strong>会话节点（Session Node）</strong> 打造游戏中的多人部分的使用示例。这里有一个主菜单、一个服务器列表以及一个简单的地图，地图中有一个带有记分牌的HUD显示。在主菜单中点击 <strong>运行（Play）</strong> 便能创建会话并加载进入游戏地图。其他玩家在自己的菜单界面中点击 <strong>查找游戏（Find games）</strong> 来查看所有存在的游戏主机列表，点击列表中的一个已查找到的游戏时则会尝试加入。如果出现任何错误，则会回到主菜单并显示"错误"对话框。
</p><p>这个游戏也可以作为一个示例，说明如何使用 <strong>游戏实例（GameInstance）</strong> 蓝图来管理游戏状态。游戏实例（GameInstance）是一种便于管理游戏状态的方法，在地图加载过程中它始终存在，同时它还是用于接收错误事件的对象。大部分会话相关的调用以及菜单的切换都由游戏实例来处理。
</p><div class="note">
	<p>目前，本文档涵盖了 <a id="content_link"filter-data="tag_blueprints" href="../../../ProgrammingAndScripting/Blueprints/UserGuide/OnlineNodes/index.html" ><span>在线会话节点</span></a> 和它如何实现多人游戏中的主机创建、发现、加入和退出游戏。本文档会在之后更新，进一步说明射击游戏的其他方面，比如攻击命中其他玩家、死亡和重生以及得分的计算。</p>
</div><h2 id="开始/进行游戏">开始/进行游戏</h2>
<p>这个部分介绍了如何开始和进行游戏，并拆解了游戏中的各个组件。
</p><div class="note">
	<p>如果你刚开始了解虚幻引擎4中的多人游戏测试，请先参阅<a id="content_link"filter-data="tag_network,_multiplayer,_gameplay,_basics/gettingstarted,_how-to" href="../../../InteractiveExperiences/Networking/TestMultiplayer/index.html" ><span>测试多人游戏</span></a> 文档。</p>
</div><p>加载游戏：
</p><ol ><li class="Default"><p>在 <strong>游戏/地图（Game/Maps）</strong> 文件夹中打开 <strong>主菜单（MainMenu）</strong> 地图。
</p></li><li class="Default"><p>主菜单地图打开后，点击 <strong>运行（Play）</strong> 按钮右边的向下箭头，将 <strong>玩家数量（Number of players）</strong> 设置为 2。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/SettingNumberOfPlayers.jpg">
		<img class="  lazyload" alt="SettingNumberOfPlayers.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/SettingNumberOfPlayers.jpg" />
</picture>

</p><div class="warning">
	<p><strong>运行专用服务器（Run Dedicated Server）</strong> 选项在本示例中可能会造成服务器列表显示不正确，此问题正在修复中。</p>
</div></li><li class="Default"><p>点击 <strong>运行（Play）</strong> 按钮启动游戏。
</p></li><li class="Default"><p>当游戏启动后，会显示以下窗口。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/twoWindows.jpg">
		<img class="  lazyload" alt="twoWindows.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/twoWindows.jpg" />
</picture>

</p><p><em>上图是我们在 <strong>新编辑器窗口（New Editor Windows）</strong> 中，其中每个窗口设置为 <strong>640x480</strong> 的分辨率，你可以在 <strong>高级设置...（Advanced Settings...）</strong> 选项内进行此项设置。</em>
</p><div class="warning">
	<p>如果是在网络上测试这个范例，不像上述过程直接使用本地多人游戏的话，应采用 <strong>独立运行模式（Standalone Play Mode）</strong> 加入其他人的游戏，或者自己作为主机创建并让其他人来加入。通过在编辑器中启动游戏（Play In Editor，即PIE）运行已联网的游戏目前并不稳定，这个问题我们还在处理。</p>
</div></li></ol><p>主菜单（Main Menu）的详细说明如下。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/MainMenu.jpg">
		<img class="  lazyload" alt="MainMenu.png" width="480" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/MainMenu.jpg" />
</picture>

</p><table >
	<caption></caption>
	<col align=""/>
	<col align=""/>
	<thead>
		<tr >

	<th rowspan="1" colspan="1" >
			<p>选项 </p>
			</th>
	
	<th rowspan="1" colspan="1" >
			<p>描述 </p>
			</th>
	
</tr>	</thead>
<tbody>
	<tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>1</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>以当前游戏窗口作为主机开始游戏。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>2</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>显示当前有效的 <strong>服务器列表</strong>，可用于选择并加入。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>3</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>退出当前游戏。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>4</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>在 <strong>局域网（LAN）</strong> 和 <strong>因特网（Internet）</strong> 两个连接模式间切换选择。</p>
			</td>
	
</tr></tbody>
</table><p>一旦选择作为主机开始游戏，或者加入其他主机的游戏，则会看到下图所示的游戏窗口。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/InGame1.jpg">
		<img class="  lazyload" alt="InGame1.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/InGame1.jpg" />
</picture>

</p><p>在屏幕的左上角（黄色框中），可以看到一些文字，这是当前角色的名字。在名字右边的框中，是当前该角色的得分。当有玩家加入时，角色名字和得分的部分都会更新，来显示当前游戏中的所有玩家和对应的的得分。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/TwoInGame.jpg">
		<img class="  lazyload" alt="TwoInGame.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/TwoInGame.jpg" />
</picture>

</p><div class="note">
	<p>上图使用的玩家名来自局域网（LAN）连接模式。但当你使用 <strong>Steam</strong> 等服务时，会显示玩家的Steam用户名。</p>
</div><p>游戏主机已经创建后，在第二个玩家的窗口中点击 <strong>查找游戏（Find Games）</strong> 按钮来显示 <strong>服务器列表（Server List）</strong>。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/ServerListWindow.jpg">
		<img class="  lazyload" alt="ServerListWindow.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/ServerListWindow.jpg" />
</picture>

</p><p>经过一小段时间的搜索后，当前可用的游戏就会显示在列表中。在这个窗口中，从左到右依次显示的是服务器名称、玩家数量以及该游戏主机的ping值。你可以点击屏幕左下角的 <strong>刷新（Refresh）</strong> 按钮来刷新列表，或者点击 <strong>返回（Back）</strong> 按钮返回主菜单。直接点击列表中的名称就会尝试连接服务器，并且在游戏中生成角色。
</p><p>进入游戏后，你必须点击 <strong>鼠标左键</strong> 表示你已经准备好开始游戏。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/1Ready.jpg">
		<img class="  lazyload" alt="1Ready.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/1Ready.jpg" />
</picture>

</p><p>当点击完成准备后（主机端或客户端），左上角会显示一段文本，表示该玩家已经准备完毕。
</p><p>完成准备后，可以用以下几个功能按钮进行游戏操作。
</p><table >
	<caption></caption>
	<col align=""/>
	<col align=""/>
	<thead>
		<tr >

	<th rowspan="1" colspan="1" >
			<p>按钮 </p>
			</th>
	
	<th rowspan="1" colspan="1" >
			<p>描述 </p>
			</th>
	
</tr>	</thead>
<tbody>
	<tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>鼠标右键（Right Mouse Button）</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>拔枪（持续按住保持举枪动作）。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>鼠标移动（Mouse）</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>进入 <strong>瞄准模式（Aim Mode）</strong>，移动鼠标进行瞄准。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>鼠标左键（Left Mouse Button）</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>开火。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>鼠标中键（上下滚动）（Middle Mouse (Wheel Up/Down)）</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>在非瞄准状态下换弹。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>Q 键</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>打开游戏暂停菜单（能够继续游戏或者离开游戏）。</p>
			</td>
	
</tr></tbody>
</table><p>这个游戏的目标是射击其他玩家，命中得1分，被击中的玩家则会重生。每个玩家有六次射击机会，用完后需要用鼠标中间（上下滚轮）来换弹（一次一颗）。
</p><h2 id="项目设置/配置">项目设置/配置</h2>
<p>这个部分涵盖了 <strong>内容浏览器（Content Browser）</strong> 中创建（或修改）的每个资产及其描述。有几个蓝图和 UMG UI资产相互通信（或有依赖关系），因此如果你想要模仿本项目示例，最好从头开始创建并再将它们关联起来。
</p><p>在 <strong>内容浏览器</strong> 中，每种资产都能在它们对应的文件夹中找到：
</p><p><strong>游戏/蓝图/控件</strong>
</p><table >
	<caption></caption>
	<col align=""/>
	<col align=""/>
	<thead>
		<tr >

	<th rowspan="1" colspan="1" >
			<p>名称 </p>
			</th>
	
	<th rowspan="1" colspan="1" >
			<p>描述 </p>
			</th>
	
</tr>	</thead>
<tbody>
	<tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>错误对话框（ErrorDialog）</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>这是一个出现错误时用于显示错误的UI界面。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>HUD</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>这个是游戏内的记分牌，显示 <strong>记分牌行（ScoreboardRow）</strong> 控件，包括所有玩家的名字和得分。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>游戏内菜单（InGameMenu）</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>这个是游戏内的菜单，提供离开游戏、返回主菜单的功能。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>加载界面（LoadingScreen）</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>这是一个简单的加载界面，它会在加入游戏的过程中显示。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>主菜单（MainMenu）</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>游戏启动时的主菜单，玩家能够创建主机、加入或者退出游戏。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>记分牌行（ScoreboardRow）</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>这是个添加到 <strong>HUD</strong> 的控件，包括了玩家的名字和得分。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>服务器列表（ServerList）</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>这个菜单包括了一组 <strong>服务器行（ServerRow）</strong> 的控件，用于显示所有的可用游戏主机列表。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>服务器行（ServerRow）</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>这个控件具有一个可用主机的信息，包括服务器名称、玩家数量和ping值。它被传递到 <strong>服务器列表（ServerList）</strong> 控件上。</p>
			</td>
	
</tr></tbody>
</table><p><strong>游戏/蓝图</strong>
</p><table >
	<caption></caption>
	<col align=""/>
	<col align=""/>
	<thead>
		<tr >

	<th rowspan="1" colspan="1" >
			<p>名称 </p>
			</th>
	
	<th rowspan="1" colspan="1" >
			<p>描述 </p>
			</th>
	
</tr>	</thead>
<tbody>
	<tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>我的游戏实例（MyGameInstance）</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>（实例蓝图） - 处理所有从主菜单到其他界面过程中发生的状态变化，以及错误事件。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>我的游戏模式（MyGameMode）</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>（游戏模式蓝图） - 记录了所有的默认类（Pawn、HUD、PlayerController 等）。并处理玩家重生的逻辑，以及玩家加入游戏时的逻辑。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>我的玩家控制器（MyPlayerController）</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>（PlayerController 蓝图）设置游戏内界面，并允许玩家打开游戏中的暂停界面。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>我的玩家状态（MyPlayerState）</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>（玩家状态蓝图）处理每个玩家的分数。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>发射物蓝图（ProjectileBP）</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>（Actor蓝图）是每个用于玩家开火的子弹，会给对方造成伤害。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>状态（State）</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>（枚举）这是游戏可能处于的状态的全集列表。</p>
			</td>
	
</tr></tbody>
</table><p><strong>游戏/枪手</strong>
</p><table >
	<caption></caption>
	<col align=""/>
	<col align=""/>
	<thead>
		<tr >

	<th rowspan="1" colspan="1" >
			<p>名称 </p>
			</th>
	
	<th rowspan="1" colspan="1" >
			<p>描述 </p>
			</th>
	
</tr>	</thead>
<tbody>
	<tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>Gunslinger_BP</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>这个是游戏中可以使用的角色。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>GunslingerTTP</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>和Gunslinger_BP一同使用的骨骼网格体（SkeletalMesh）。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>Gunslinger_AnimBP</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>用来驱动Gunslinger_BP的动画。</p>
			</td>
	
</tr></tbody>
</table><p><strong>游戏/角色</strong>
</p><table >
	<caption></caption>
	<col align=""/>
	<col align=""/>
	<thead>
		<tr >

	<th rowspan="1" colspan="1" >
			<p>名称 </p>
			</th>
	
	<th rowspan="1" colspan="1" >
			<p>描述 </p>
			</th>
	
</tr>	</thead>
<tbody>
	<tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>角色_父节点（Character_Parent）</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>（父节点）Gunslinger_BP使用的材质</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>角色_实例（Character_Instance）</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>（实例化的）和Gunslinger_BP使用的材质。</p>
			</td>
	
</tr></tbody>
</table><p><strong>游戏/字体</strong>
</p><table >
	<caption></caption>
	<col align=""/>
	<col align=""/>
	<thead>
		<tr >

	<th rowspan="1" colspan="1" >
			<p>名称 </p>
			</th>
	
	<th rowspan="1" colspan="1" >
			<p>描述 </p>
			</th>
	
</tr>	</thead>
<tbody>
	<tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>得分字体（ScoreFont）</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p><strong>记分牌（Scoreboard）</strong> 控件使用的字体。</p>
			</td>
	
</tr></tbody>
</table><p><strong>游戏/地图</strong> 
</p><table >
	<caption></caption>
	<col align=""/>
	<col align=""/>
	<thead>
		<tr >

	<th rowspan="1" colspan="1" >
			<p>名称 </p>
			</th>
	
	<th rowspan="1" colspan="1" >
			<p>描述 </p>
			</th>
	
</tr>	</thead>
<tbody>
	<tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>主菜单（MainMenu）</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>项目和编辑器启动时的默认加载地图，包含了前端显示。</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>关卡_01（Level_01）</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>这是玩家创建或加入游戏时生成的游戏地图。</p>
			</td>
	
</tr></tbody>
</table><h3 id="配置设置">配置设置</h3>
<p>为了成功创建主机或者连接到多人游戏中，你需要对 <strong>DefaultEngine.ini</strong> 文件进行一些设置，该文件在以下位置（示例如图） <em>UnrealProjectDirectory/ProjectName/Config</em>：
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/ExampleLocation.jpg">
		<img class="  lazyload" alt="ExampleLocation.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/ExampleLocation.jpg" />
</picture>

</p><p>打开后，需要先找到 <strong>在线子系统（OnlineSubsystem）</strong> 以及与子系统对应的 <strong>默认平台服务（DefaultPlatformService）</strong>。
</p><p>例如，要进行局域网（LAN）游戏，需要添加 <code>DefaultPlatformService=Null</code>：
</p><pre class="prettyprint"><code>&#91;OnlineSubsystem&#93;
DefaultPlatformService=Null</code></pre>
<p>或者如果要在 <strong>Steam</strong> 上玩，需要使用 <code>OnlineSubsystemSteam</code>：
</p><pre class="prettyprint"><code>&#91;/Script/Engine.GameEngine&#93;
+NetDriverDefinitions=(DefName="GameNetDriver",DriverClassName="OnlineSubsystemSteam.SteamNetDriver",DriverClassNameFallback="OnlineSubsystemUtils.IpNetDriver")

&#91;OnlineSubsystem&#93;
DefaultPlatformService=Steam

&#91;OnlineSubsystemSteam&#93;
bEnabled=true
SteamDevAppId=480
bVACEnabled=0

&#91;/Script/OnlineSubsystemSteam.SteamNetDriver&#93;
NetConnectionClassName="OnlineSubsystemSteam.SteamNetConnection"</code></pre>
<div class="note">
	<p>如果要用Steam的话，需要<a id="content_link"filter-data="tag_steam tag_online_subsystem" href="../../../ProgrammingAndScripting/Online/Steam/index.html" ><span>额外的SDK和INI设置</span></a>，点击该链接查看更多信息。</p>
</div><h2 id="蓝图演示">蓝图演示</h2>
<p>在接下来的章节中，我们将介绍游戏的各个状态，以及驱动这些状态工作的蓝图。
</p><p>我们先看看 <strong>启动（Startup）</strong> 的序列。
</p><h3 id="启动">启动</h3>
<p>在 <strong>主菜单（MainMenu）</strong> 地图中，打开 <strong>关卡蓝图（Level Blueprint）</strong>。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Startup1.jpg">
		<img class="  lazyload" alt="Startup1.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Startup1.jpg" />
</picture>

</p><p><strong>关卡蓝图（Level Blueprint）</strong>打开后，可以看到一部分脚本标记了"游戏逻辑自此开始（Game Logic Starts Here）"。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Startup2.jpg">
		<img class="  lazyload" alt="Startup2.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Startup2.jpg" />
</picture>

</p><p>这个注释非常不错，因为游戏逻辑正是从这部分脚本开始。游戏开始时，获取游戏实例并 <strong>转换（Cast）</strong> 为 <strong>我的游戏实例（MyGameInstance）</strong>，这样就可以访问它的变量、函数和脚本了。在本示例中，接下来调用了一个名为 <strong>Begin Play Show Main Menu</strong> 的函数（见下图）。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Startup3.jpg">
		<img class="  lazyload" alt="Startup3.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Startup3.jpg" />
</picture>

</p><p>当 <strong>Begin Play Show Main Menu</strong> 被调用时，首先运行了一个预先创建的宏，名为 <strong>IsCurrentState</strong>。
</p><div class="note">
	<h5 id="iscurrentstate宏">IsCurrentState宏</h5>
<p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Startup4.jpg">
		<img class="  lazyload" alt="Startup4.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Startup4.jpg" />
</picture>

</p><p><strong>IsCurrentState</strong> 会检查 <strong>In State</strong>（在宏的节点上定义） 是否和一个叫做 <strong>当前状态（Current State）</strong> 的变量一致。<strong>当前状态（Current State）</strong> 变量是一个由 <strong>状态（State）</strong> 创建的枚举类型，记录游戏可能处于的每一个状态。</p>
</div><p>既然 <strong>Current State</strong> 和 <strong>In State</strong> 一致，便能调用 <strong>展示主菜单事件（ShowMainMenuEvent）</strong> 这个自定义事件。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Startup5a.jpg">
		<img class="  lazyload" alt="Startup5a.png" width="840" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Startup5a.jpg" />
</picture>

</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Startup5.jpg">
		<img class="  lazyload" alt="Startup5.png" width="840" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Startup5.jpg" />
</picture>

</p><p><strong>展示主菜单事件（ShowMainMenuEvent）</strong> 首先运行 <a id="content_link" href="#" ><span>是否为当前状态宏（IsCurrentState Macro）</span></a> 以检查当前状态是否为 <strong>运行中（Playing）</strong>。如果为 <strong>是（True）</strong> 的话，则打开 <strong>主菜单（MainMenu）</strong> 的关卡，如果游戏当前在 <strong>启动（Startup）</strong> 状态，则返回 <strong>否（False）</strong>。这里调用了另一个预创建的宏，名为 <strong>过渡至状态（TransitionToState）</strong> 。
</p><div class="note">
	<h5 id="transitiontostate宏">TransitionToState宏</h5>
<p>下图中，在过渡至状态（TransitionToState）中，首先运行了<a id="content_link" href="#" ><span>IsCurrentState宏</span></a> （1）对照 <strong>当前状态（Current State）</strong> 和 <strong>期望状态（Desired State）</strong>。如果两者一致则在屏幕上显示错误并提示原因（2），如果它们不一致，则执行 <strong>Switch on State</strong> 节点（3），这里会获取 <strong>当前状态（Current State）</strong> 并调用一个叫做 <strong>隐藏控件（Hide Widget）</strong> 的函数（这里将会隐藏当前显示的UI控件），或者运行一个叫做 <strong>Destroy Session Caller</strong> 的自定义事件（将会销毁该玩家调用的会话）。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Startup6.jpg">
		<img class="  lazyload" alt="Startup6.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Startup6.jpg" />
</picture>

</p><p>当切换状态（Switch on State）完成后，当前状态（Current State）会根据期望状态（Desired State）被更新。</p>
</div><p>完成 <strong>TransitionToState</strong> 宏后，我们可以继续 <strong>ShowMainMenuEvent</strong> 自定义事件。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Startup7.jpg">
		<img class="  lazyload" alt="Startup7.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Startup7.jpg" />
</picture>

</p><p>上图中，<strong>IsValid</strong> 节点（1）执行，它会检查 <strong>主菜单（Main Menu）</strong> 变量是否有效，第一次运行该变量会无效（如果有效的话则跳过图中的（2）和（3））。步骤（2）调用了 <strong>创建控件（Create Widget）</strong> 节点来创建一个叫做 <strong>主菜单（Main Menu）</strong> 的 UMG 控件蓝图，并将结果作为一个变量（3）保存，这样便能在以后的脚本中直接访问而无需重新创建。在（4）中 <strong>Set Input Mode UIOnly</strong> 节点用来限制输入为仅UI输入，在（5）中则将 <strong>主菜单（Main Menu）</strong> 添加到视口并显示主菜单界面。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Startup8.jpg">
		<img class="  lazyload" alt="Startup8.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Startup8.jpg" />
</picture>

</p><p>接下来看看玩家点击运行（Play）来创建游戏会发生什么。
</p><h3 id="创建游戏">创建游戏</h3>
<p>加载主菜单（Main Menu）并点击后，可以在 <strong>主菜单（MainMenu）</strong> 控件蓝图中点击 <strong>运行（Play）</strong> 按钮，会运行下图中的脚本。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Play1.jpg">
		<img class="  lazyload" alt="Play1.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Play1.jpg" />
</picture>

</p><p>在 <strong>主菜单（Main Menu）</strong> 控件蓝图中的 <strong>Designer</strong> 选项卡中，可以为 "Play" 按钮创建一个 <strong>按钮</strong> 事件关联到 <strong>OnClicked</strong> 事件上。当该事件触发时将获取游戏实例并 <strong>转换（Cast）</strong> 为 <strong>我的游戏实例（MyGameInstance）</strong> 蓝图，这样就能调用它内部的自定义事件 <strong>Host Game Event</strong> 了。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Play2.jpg">
		<img class="  lazyload" alt="Play2.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Play2.jpg" />
</picture>

</p><p><strong>HostGameEvent</strong> 首先运行了一个 <strong>MyGameInstance</strong> 蓝图内的自定义事件：<strong>ShowLoadingScreen</strong>。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Play3.jpg">
		<img class="  lazyload" alt="Play3.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Play3.jpg" />
</picture>

</p><p>当 <strong>ShowLoadingScreen</strong> 被调用时，先运行了<a id="content_link" href="#" ><span>TransitionToState宏</span></a>（并将 <strong>期望状态（Desired State）</strong> 设置为 <strong>Loading Screen</strong>）。
</p><p>然后继续 <strong>ShowLoadingScreen</strong>  事件，调用了 <strong>IsValid</strong> 的检查，如下图（1）部分。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Play4.jpg">
		<img class="  lazyload" alt="Play4.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Play4.jpg" />
</picture>

</p><p><strong>是否有效（IsValid）</strong> 检查变量 <strong>加载控件（Loading Widget）</strong> 是否有效，第一次运行是无效的（如果有效则跳过步骤（2）和（3））。步骤（2）创建了 <strong>Loading Screen</strong> 的UMG控件蓝图，并将结果保存到变量中（3），这样以后便能直接访问而无需重新创建。在步骤（4）中，<strong>加载控件（Loading Widget）</strong> 被添加到视口中，并调用 <strong>Set Input Mode UIOnly</strong> 节点，可以限制输入为仅UI输入（这时会在游戏中显示）。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Play5.jpg">
		<img class="  lazyload" alt="Play5.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Play5.jpg" />
</picture>

</p><p>当 Loading Screen 显示时，脚本就回到了 <strong>HostGameEvent</strong> 上继续执行 <strong>Create Session</strong> 节点。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Play6.jpg">
		<img class="  lazyload" alt="Play6.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Play6.jpg" />
</picture>

</p><p>在 <strong>创建会话（Create Session）</strong> 节点上，<strong>Public Connections</strong> 的数量（允许玩家加入该游戏会话）设置为 <strong>4</strong>。还有一个 <strong>布尔值</strong> 变量叫做 <strong>Enable LAN</strong> ，它直接连接到了 <strong>Use LAN</strong> 的输入引脚上。<strong>Enable LAN</strong> 变量是通过主菜单上的 <strong>Play Mode</strong> 来切换的，稍后在本文档中我们还将进行讨论。如果成功创建会话，则调用 <strong>打开关卡（Open Level）</strong> 节点来加载用于该游戏会话的地图。如果失败的话，则执行 <strong>OnFailure</strong> 引脚，并运行一个预先创建的宏，名为 <strong>DisplayErrorDialog</strong>。
</p><div class="note">
	<h5 id="displayerrordialog宏">DisplayErrorDialog宏</h5>
<p>调用DisplayErrorDialog宏时，先会执行（1）<a id="content_link" href="#" ><span>TransitionToState宏</span></a> ，以便切换到 <strong>错误对话（Error Dialog）</strong> 状态中。当切换到新状态后，执行自定义事件 <strong>Destroy Session Caller</strong> （2） 来销毁当前玩家会话（可以在事件图表中找到）。销毁会话后，将调用引擎的宏 <strong>IsValid</strong> 来检查错误对话（Error Dialog）变量（这是一个错误对话控件蓝图）是否有效。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Play7.jpg">
		<img class="  lazyload" alt="Play7.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Play7.jpg" />
</picture>

</p><p>以下图表第一次运行时，<strong>错误对话（Error Dialog）</strong> 是无效的，如果有效的话，将会跳过（1）和（2）直接进入（3）。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Play8.jpg">
		<img class="  lazyload" alt="Play8.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Play8.jpg" />
</picture>

</p><p>第一次运行时，上图的（1）将使用 <strong>创建控件（Create Widget）</strong> 节点创建一个ErrorDialog控件蓝图。（2）中将该控件蓝图提升为名为Error Dialog的变量（以便下次执行宏时直接使用）。在（3）中，调用ErrorDialog控件蓝图中的函数 <strong>Set Message</strong> ，将得到并设置指定在宏节点上的信息，以便在对话框（下图黄色高亮框）中显示，设置到 ErrorDialog 上，并且 <strong>Add to Viewport</strong> 将错误对话控件蓝图（Error Dialog Widget Blueprint）显示在界面中（5），并使用 <strong>Set Input Mode UIOnly</strong> 将输入模式设为仅UI输入。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Play9.jpg">
		<img class="  lazyload" alt="Play9.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Play9.jpg" />
</picture>
</p>
</div><p>如果没有错误的话，则会加载在 <strong>Open Level</strong> 节点中定义的地图，玩家进入 <strong>游戏</strong>。
</p><h3 id="加入游戏">加入游戏</h3>
<p>在主菜单中，点击 <strong>搜索游戏（Find Games）</strong> 按钮会执行 <strong>主菜单（MainMenu）</strong> 控件蓝图中的相应脚本，如下图所示：
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Findgames1.jpg">
		<img class="  lazyload" alt="Findgames1.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Findgames1.jpg" />
</picture>

</p><p>在 <strong>主菜单（MainMenu）</strong> 控件蓝图中的 <strong>Designer</strong> 选项卡中，可以为"搜索游戏（Find Games）"按钮创建一个 <strong>按钮</strong> 事件并关联到 <strong>OnClicked</strong> 事件上。当这个事件触发时，获取游戏实例并 <strong>转换为我的游戏实例（Cast to MyGameInstance）</strong> 蓝图，这样就能调用它内部的自定义事件 <strong>Show Server List Event</strong> 了。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Findgames2.jpg">
		<img class="  lazyload" alt="Findgames2.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Findgames2.jpg" />
</picture>

</p><p><strong>ShowServerListEvent</strong> 首先运行 <a id="content_link" href="#" ><span>TransitionToState 宏</span></a>（1）将游戏状态设置为 <strong>Server List</strong>。然后用 <strong>IsValid</strong>（2）检查 <strong>Server List</strong> 控件蓝图变量，如果有效，就使用 <strong>Add to Viewport</strong>（5）节点屏幕上显示服务器列表菜单。第一次运行时，需要先创建服务器列表界面，通过 <strong>Create Widget</strong>（3）节点，并将结果提升至变量（4）中，然后再显示在界面中。当显示在界面中后，再用 <strong>Set Input Mode UIOnly</strong> 节点限制输入为仅UI。
</p><p>在服务器列表菜单显示的时候，在上述的步骤（5）时，步骤（6）前，服务器列表控件蓝图内还有一段脚本会被执行，可以将当前可用的游戏填充到服务器列表菜单中。可以在下图的服务器列表控件蓝图中看到，<strong>事件构造（Event Construct）</strong> 节点会在该控件蓝图被构造（创建）时调用，并立刻执行一段预先设置的 <strong>RefreshListMacro</strong> 宏。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Findgames3.jpg">
		<img class="  lazyload" alt="Findgames3.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Findgames3.jpg" />
</picture>

</p><div class="note">
	<h5 id="refreshlistmacro宏">RefreshListMacro宏</h5>
<p>RefreshListMacro执行许多任务，下面将介绍第一部分。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Findgames4.jpg">
		<img class="  lazyload" alt="Findgames4.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Findgames4.jpg" />
</picture>

</p><p>如上，当宏被调用时，首先它将一个名为 <strong>Refresh Button Enabled</strong> 的布尔值变量设置为 <strong>False</strong>（1），这会禁用 <strong>刷新（Refresh）</strong> 按钮，防止玩家点击。接下来，一个叫做 <strong>状态文本（Status Text）</strong> 的变量设置为 <strong>搜索...（Searching...）</strong>（2）并将它的 <strong>可视性（Visibility）</strong> 设置为 <strong>可见（Visible）</strong>（3），这样就能更新并显示带有状态文本的控件。
</p><p>在（4）的位置，有一个叫做 <strong>Found Session Widgets</strong> 的数组变量，它是一组服务器行的集合，用于刷新服务器列表，可以使用 <strong>Remove Child</strong>（5）节点移除当前存在的服务器。当显示界面时，这将会删除所有将进入列表的服务器。在（6）的位置，<strong>Found Session Widgets</strong> 变量再次被清理以消除先前保存过的会话，这样就能在进一步查找前先把所有的东西清理干净。
</p><p>然后，该宏获取游戏实例并使用 <strong>Cast To MyGameIntance</strong> 节点（下图 1 处）来访问 <strong>Enable LAN</strong> 的值（在查询会话时将会使用）。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Findgames5.jpg">
		<img class="  lazyload" alt="Findgames5.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Findgames5.jpg" />
</picture>

</p><p><strong>Find Session</strong> 节点（2）用于查询当前存在的会话（会作为返回值输出）。在这个节点中，还可以设置 <strong>最大结果（Max Results）</strong>（返回查询结果的数量）。<strong>Find Sessions</strong> 查询的返回结果指定保存在 <strong>Found Sessions</strong> 数组变量中（3）。这里会有一个 <strong>分支（Branch）</strong>（4）来检查结果，如果是 0 的话，继续执行 <strong>True</strong> 引脚（如果不是的话则执行 <strong>False</strong> ）。如果执行 <strong>Find Sessions</strong> 的节点时出现错误，则会调用 <strong>OnFailure</strong> 事件，并修改 <strong>状态文本（Status Text）</strong> ，显示为 <strong>Search failed</strong>（5），提示用户查找会话并未完成。
</p><p>在 <strong>分支</strong> 后（上图中的 4），如果是 <strong>True</strong>（也就是并未找到任何会话），<strong>状态文本（Status Text）</strong> 会被设置为 <strong>No sessions found</strong>（下图中的 7），并且 <strong>Refresh Button Enabled</strong> 变量被设置为 <strong>True</strong>（8），这样玩家可以点击 <strong>Refresh</strong> 按钮以再次查找游戏。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Findgames6.jpg">
		<img class="  lazyload" alt="Findgames6.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Findgames6.jpg" />
</picture>

</p><p>如果找到会话，<strong>Status Text Visibility</strong> 被设置为 <strong>Collapsed</strong>（1）便能将该控件隐藏。然后使用 <strong>ForEachLoop</strong> 节点（2）来处理找到的每个 <strong>结果（result）</strong>，并使用 <strong>Create ServerRow</strong> 节点（3）为每个结果创建一个服务器行控件（Server Row Widget）。这些就是服务器列表里每个独立的会话行。
</p><p>在（4）的位置，<strong>结果（Results）</strong> 也被添加到 <strong>Found Session Widgets</strong> 数组里，然后再调用服务器行（ServerRow）控件蓝图（用于生成服务器名称、玩家数量和ping值）中的设置搜索结果（Set Serach Result）函数。设置完服务器行控件蓝图的内容后， <strong>Add Child</strong> 节点（6）用于将每个服务器行控件蓝图添加至显示在服务器列表菜单中的 <strong>滚动服务器（Scrolling Servers）</strong> 滚动框。
</p><p>当每个搜索到的会话都创建了服务器行控件后，把它们添加到 <strong>滚动服务器（Scrolling Servers）</strong> 控件上，<strong>ForEachLoop</strong> 完成，并将 <strong>Refresh Button Enabled</strong> 变量设置为 <strong>True</strong>（8）。</p>
</div><p>在运行了 <strong>RefreshListMacro</strong> 搜索会话后，任何找到的可用会话将显示在 <strong>服务器列表（Server List）</strong> 菜单中。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Findgames7.jpg">
		<img class="  lazyload" alt="Findgames7.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Findgames7.jpg" />
</picture>

</p><p>点击 <strong>刷新（Refresh）</strong> 按钮将会再次运行<a id="content_link" href="#" ><span>刷新列表宏（RefreshListMacro）</span></a> 来搜索会话。点击 <strong>返回（Back）</strong> 按钮将会执行自定义事件 <strong>ShowMainMenuEvent</strong>（已在<a id="content_link" href="#" ><span>启动</span></a> 章节中进行了说明）。
</p><p>在服务器列表中点击其中一个服务器将会触发在 <strong>服务器行（ServerRow）</strong> 控件蓝图中的 <strong>OnClicked</strong> 事件（见下图）。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Findgames8.jpg">
		<img class="  lazyload" alt="Findgames8.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Findgames8.jpg" />
</picture>

</p><p><strong>服务器行（ServerRow）</strong> 控件的 <strong>OnClicked</strong> 事件，先获取了游戏实例，并使用 <strong>Cast To MyGameInstance</strong> 节点来进一步调用它的 <strong>Join from Server List Event</strong> 事件。<strong>ServerResult</strong> 变量（作为<a id="content_link" href="#" ><span>RefreshListMacro</span></a> 的一部分生成）被传入 <strong>MyGameInstance</strong> 的蓝图，并允许玩家在点击时加入服务器。
</p><p>在 <strong>我的游戏实例（MyGameInstance）</strong> 蓝图中的 <strong>JoinFromServerListEvent</strong>（下图）被调用时，先运行自定义事件 <strong>ShowLoadingScreen</strong>，这部分在<a id="content_link" href="#" ><span>创建游戏</span></a> 章节中作了描述。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Findgames9.jpg">
		<img class="  lazyload" alt="Findgames9.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Findgames9.jpg" />
</picture>

</p><p>当显示加载界面（LoadingScreen）的时候，加入会话（Join Session）节点会尝试加入玩家当前点击的并由服务器行控件提供的搜索结果（SearchResult）。如果成功的话，玩家就能加入该服务器，并在游戏中生成角色。如果出现错误的话，就会运行 <a id="content_link" href="#" ><span>DisplayErrorDialog</span></a> 并显示 <strong>Failed To Join Session</strong> 的 <strong>错误信息（Error Message）</strong>。
</p><h3 id="游戏性">游戏性</h3>
<p>在玩家控制角色前，角色和游戏状态都需要被设置好（或者，比如要加入一个游戏时，游戏自身需要更新，并被告知有新玩家要加入进来）。点击主菜单的 <strong>Play</strong> 按钮，或者从服务器列表中选择一个服务器加入时，首先要调用 <strong>游戏模式（GameMode）</strong> 蓝图中的 <strong>Post Login</strong> 事件，这里将介绍下图所示的设置过程。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Gameplay1.jpg">
		<img class="  lazyload" alt="Gameplay1.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Gameplay1.jpg" />
</picture>

</p><p>当 <strong>Event Post Login</strong> 触发后，先运行了一个引擎的宏，名为 <strong>Switch Has Authority</strong>（1），这里会检查脚本在一台具有网络权限（Network Authority）（在服务器上）的机器上运行，还是在一台远程机器（一个客户端）上运行。这个过程会在服务端为主机玩家和加入游戏的客户端运行，<strong>远程（Remote）</strong> 引脚并不运行任何事件，而 <strong>Authority</strong> 引脚会继续执行登录后（Post Login）的脚本。
</p><div class="note">
	<p>还有一个关于 <strong>Switch Has Authority</strong> 的示例，请查看 <a id="content_link" href="../../ContentExamples/Networking/1_2/index.html" ><span>在蓝图中检测网络主机和远程客户端</span></a> 页面。</p>
</div><p>在（2）处，新玩家的 <strong>玩家状态（PlayerState）</strong> 被 <strong>转换（Cast）</strong> 为 <strong>MyPlayerState</strong> 蓝图，这里会设置 <strong>Player Number</strong>（3），保证玩家记分牌中的顺序和玩家顺序一致（每个新玩家加入都会添加到记分牌中）。设置好玩家数量后，新玩家被 <strong>转换（Cast）</strong> 成 <strong>MyPlayerController</strong> 蓝图，以便触发 <strong>ClientPostLogin</strong> 这个自定义事件。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Gameplay2.jpg">
		<img class="  lazyload" alt="Gameplay2.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Gameplay2.jpg" />
</picture>

</p><p>如上图所示，<strong>ClientPostLogin</strong> 事件的 <strong>细节（Details）</strong> 面板中还有一些属性设置。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Gameplay3.jpg">
		<img class="  lazyload" alt="Gameplay3.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Gameplay3.jpg" />
</picture>

</p><p>在 <strong>图表（Graph）</strong> 分段中，<strong>复制（Replicates）</strong> 选项设置为 <strong>Run in owning Client</strong> 并且勾选了 <strong>Reliable</strong> 复选框。这两个选项可以表示这段脚本在服务上被调用，但该节点则仅在当前用户的客户端上执行。<strong>Reliable</strong> 的设置保证了这个脚本一定会被客户端执行，并且不会因为严重的网络负载而丢失（大部分处理视觉效果同步复制的调用都是 <strong>Unreliable</strong> ，以避免过多的消耗网络负载，但在这个例子中，我们需要该事件必须执行，因此使用 <strong>Reliable</strong>）。
</p><p>确认了脚本应该在何处触发后，就可以进一步调用 <strong>Setup Ingame UI</strong> 函数。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/Gameplay4.jpg">
		<img class="  lazyload" alt="Gameplay4.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/Gameplay4.jpg" />
</picture>

</p><p>这个函数从 <strong>分支（Branch）</strong>（1）开始，检查当前的目标控制器是否是本地玩家控制器，如果是，则使用 <strong>Create Widget</strong>（2）节点创建 HUD 控件蓝图。然后将 HUD 控件提升至一个名为 <strong>HUD Widget</strong> 的变量（3）中，并使用 <strong>Add to Viewport</strong>（4）节点把它添加到玩家视口中。在（5）处，再用一个 <strong>Create Widget</strong> 节点创建 <strong>InGame Menu</strong> 控件蓝图，并提升到 <strong>InGameMenuWidget</strong> 变量（6）中，这会在玩家点击按钮调用游戏内菜单时显示。
</p><div class="note">
	<p>到这里，"login" 的过程就完成了。角色的设置在 <strong>Character Animation Blueprint</strong> 中，定义了角色的每个动作并设置了动画。此处并不涵盖这部分内容，如需了解有关 <strong>动画蓝图（Animation Blueprints）</strong> 的内容，请参阅<a id="content_link"filter-data="tag_animation tag_animation_blueprint tag_blueprints tag_state_machine tag_animation_assets" href="../../../AnimatingObjects/SkeletalMeshAnimation/AnimBlueprints/index.html" ><span>动画蓝图</span></a>文档。</p>
</div><p>设置好 <strong>角色动画蓝图（Character Animation Blueprint）</strong> 后，就可以打开 <strong>Level_01</strong> 地图，在这个地图的 <strong>关卡蓝图（Level Blueprint）</strong> 中，当玩家实际在关卡中生成之前，调用了以下脚本。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/level1LevelBlueprint.jpg">
		<img class="  lazyload" alt="level1LevelBlueprint.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/level1LevelBlueprint.jpg" />
</picture>

</p><p>上方地图的 <strong>Event Begin Play</strong> 中，为当前游戏实例调用了 <strong>Cast To MyGameInstance</strong> 节点，并，从中调用 <strong>Start Playing State</strong> 函数。这是一个 <strong>MyGameInstance</strong> 蓝图内的函数，可将游戏状态设置为 <strong>游戏中（Playing）</strong>，如下图所示。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/playingState.jpg">
		<img class="  lazyload" alt="playingState.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/playingState.jpg" />
</picture>

</p><p>将状态设置为 <strong>游戏中（Playing）</strong> 后，通过调用 <strong>Set Focus To Game Viewport</strong> 的节点（上图中的（3）），鼠标会被锁定在游戏视口内，并调用 <strong>Set Input Mode Game Only</strong> 节点（上图的（4））使UI不再截获用户输入。
</p><h3 id="从游戏中离开">从游戏中离开</h3>
<p>离开游戏的过程非常简单直接，只需要打开或关闭一些UMG控件的显示，并执行第一次加载游戏进入主菜单同样的过程即可。
</p><p>在游戏中按 <strong>Q</strong> 键后，则能看到游戏内的暂停菜单，点击 <strong>离开游戏（Leave Game）</strong> 选项，则执行在 <strong>InGameMenu</strong> 控件蓝图中的以下步骤：
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/disconnectingGraph.jpg">
		<img class="  lazyload" alt="disconnectingGraph.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/disconnectingGraph.jpg" />
</picture>

</p><p>在上图中，点击了离开（Leave）按钮后触发了事件（1），获取到当前玩家并 <strong>转换（Cast）</strong> 成 <strong>MyPlayerController</strong> 的蓝图（2）。在 <strong>MyPlayerController</strong> 蓝图内的函数 <strong>Hide in Game Menu</strong>（3）如图被调用。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/hideingamemenu.jpg">
		<img class="  lazyload" alt="hideingamemenu.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/hideingamemenu.jpg" />
</picture>

</p><p>这部分脚本得到 <strong>游戏内菜单控件（In Game Menu Widget）</strong> 变量（先前创建并保存为引用的变量），并使用 <strong>Remove From Parent</strong> 节点将它从屏幕上移除。然后，调用 <strong>Set Input Mode Game Only</strong> 来防止玩家操作其他 UI，直到我们将输入模式修改为允许UI输入为止。
</p><p>然后脚本返回到 <strong>InGameMenu</strong> 控件蓝图上，并使用 <strong>Cast To MyGameInstance</strong> 节点（4）来得到当前游戏实例并调用它内部的函数 <strong>Show Main Menu Event</strong>。该函数首先运行<a id="content_link" href="#" ><span>IsCurrentState宏</span></a>，接下来便是<a id="content_link" href="#" ><span>开始</span></a> 章节中首次加载游戏的部分。
</p><p><picture>
		<source data-srcset="./../../../../Images/Resources/Showcases/BlueprintMultiplayer/disconnectingGraph.jpg">
		<img class="  lazyload" alt="disconnectingGraph.png" data-src="../../../../Images/Resources/Showcases/BlueprintMultiplayer/disconnectingGraph.jpg" />
</picture>

</p>
																	</div>
					<!-- End of Markdown converted page content -->
				</div>
												<div id="recommendations"></div>			</div>
						  									<div id="announcement">
			<div style="display:inline-block;margin:5px;">
				欢迎帮助改进虚幻引擎文档！请告诉我们该如何更好地为您服务。
			</div>
			<div style="margin:5px;display:inline-block;">
				<div class="btn action" style="margin-top:-6px;display:inline-block;" onclick="$('#announcement').hide();window.open('https://epicgames.questionpro.com/t/AP9dGZkjp4');createCookie('announcement-read', new Date().getTime(), 30);">填写问卷调查</div>
				<div class="btn btn-default" style="margin-top:-6px;display:inline-block;" onclick="$('#announcement').hide();createCookie('announcement-read', new Date().getTime(), 30);">取消</div>
			</div>
			<div class="btn-close" style="position:absolute;right:5px;top:10px;padding:3px;width:14px;height:14px;" onclick="$('#announcement').hide();"></div>
			</div>
					</div>
	</div></body>

<!-- Mirrored from docs.unrealengine.com/4.26/zh-CN/Resources/Showcases/BlueprintMultiplayer/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 17 Jan 2024 11:55:24 GMT -->
</html>
