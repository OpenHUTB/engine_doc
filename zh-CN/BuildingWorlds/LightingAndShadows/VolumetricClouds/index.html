<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">

<!-- Mirrored from docs.unrealengine.com/4.26/zh-CN/BuildingWorlds/LightingAndShadows/VolumetricClouds/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 17 Jan 2024 12:09:25 GMT -->
<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <script src="../../../../Include/Javascript/common_zh-CN.js" type="text/javascript"></script>
	<script type="text/javascript">
		var time = new Date(0);
		var preview = false;
		var relativeHTMLPath = "https://docs.unrealengine.com/4.26/";
				var pageid = 0;
				var heroimage = "../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/CloudsHeroBanner1.png";
				var lang = "zh-CN";
				var basePath = document.location.pathname.substring(0, document.location.pathname.indexOf('/' + lang + '/') + lang.length + 1);
		document.write('<base href="' +  encodeURI(basePath) + '/BuildingWorlds/LightingAndShadows/VolumetricClouds/" />');
				var udnCSS = '../../../../Include/CSS/udn_public.css';
		var udnLangCSS = '';
				udnLangCSS = './../../../../Include/CSS/udn_public_CN.css">';
				var udnOverrideCSS = '../../../../Include/CSS/skin_overrides.css';
		var udnOverrideDarkCSS = '../../../../Include/CSS/skin_overrides_dark.css';
		var fancyboxCSS = '../../../../Include/CSS/jquery.fancybox.css';
		var jqueryuiCSS = '../../../../Include/CSS/jquery-ui.min.css';
		var qtipCSS = '../../../../Include/CSS/jquery.qtip.css';
		var prettifyCSS = '../../../../Include/CSS/prettify.css';
		var navbarCSS = '../../../../Include/CSS/navBar.css';
		var twentytwentyCSS = '../../../../Include/CSS/twentytwenty.css';
		var recommendationsCSS = '../../../../Include/CSS/jquery.recommendations.css';
	</script>
    <title>体积云 | 虚幻引擎文档</title>
    	    <meta name=viewport content="width=device-width, initial-scale=1" />
	<meta http-equiv="Cache-control" content="no-store">
    <script  src="../../../../Include/Javascript/CustomEvent.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery-3.4.0.min.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/udn.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/udn_extras.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery-ui.min.js" type="text/javascript"></script>
	    <script  src="../../../../Include/Javascript/informational.js" type="text/javascript"></script>
	    <script  src="../../../../Include/Javascript/jquery.fancybox.pack.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery.qtip.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/prettify.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery.slimscroll.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery.event.move.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery.twentytwenty.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/lazysizes.min.js" type="text/javascript"></script>
	    <script  src="../../../../Include/Javascript/jquery.recommendations.js" type="text/javascript"></script>
	
    <link async rel="icon" href="../../../../../favicon.png" type="image/x-icon" />
    <link async rel="shortcut icon" href="../../../../../favicon.png" type="image/x-icon" />
    <link async href="../../../../Include/Images/touch_icon.png" rel="apple-touch-icon" />
    <link async href="../../../../Include/Images/touch_icon_114.png" sizes="114x114" rel="apple-touch-icon" />    
		<script  src="../../../../Include/Javascript/CollapsibleLists.js" type="text/javascript"></script>
	<script  src="../../../../Include/Javascript/navigationBarUI.js"></script>
	<script  src="../../../../Include/Javascript/navigationBar.js"></script>
		
	<link rel="alternate" href="https://docs.unrealengine.com/latest/en-US/BuildingWorlds/LightingAndShadows/VolumetricClouds/" hreflang="x-default" />
<link rel="alternate" href="https://docs.unrealengine.com/latest/zh-CN/BuildingWorlds/LightingAndShadows/VolumetricClouds/" hreflang="zh-CN" />
<link rel="alternate" href="https://docs.unrealengine.com/latest/ja/BuildingWorlds/LightingAndShadows/VolumetricClouds/" hreflang="ja" />
<link rel="alternate" href="https://docs.unrealengine.com/latest/ko/BuildingWorlds/LightingAndShadows/VolumetricClouds/" hreflang="ko" />

	<meta name="intsourcechangelist" content="16146891" />
<meta name="availability" content="public" />
<meta name="title" content="体积云" />
<meta name="description" content="关于使用体积云组件和体积材质进行实时云渲染的概述" />
<meta name="parent" content="BuildingWorlds/LightingAndShadows" />
<meta name="type" content="overview" />
<meta name="version" content="4.26" />
<meta name="hero-image" content="CloudsHeroBanner1.png" />
<meta name="related" content="BuildingWorlds/LightingAndShadows/LightTypes/SkyLight" />
<meta name="related" content="BuildingWorlds/FogEffects/SkyAtmosphere" />
<meta name="related" content="BuildingWorlds/LightingAndShadows/LightTypes/Directional" />
<meta name="keywords" content="Atmosphere" />
<meta name="keywords" content="Building Worlds" />
<meta name="keywords" content="Rendering" />
<meta name="keywords" content="Clouds" />
<meta name="crumbs" content="%ROOT%,BuildingWorlds,BuildingWorlds/LightingAndShadows" />

	<meta name="twitter:card" content="summary_large_image" />
	<meta property="og:title" content="体积云" />
	<meta property="og:description" content="关于使用体积云组件和体积材质进行实时云渲染的概述" />
		<meta property="og:image" content="" />
	</head>
<body id="webbgThree" style="visibility: hidden;" onload="document.body.style.visibility='visible';">
			<script>window.__tracking_base = 'https://tracking.unrealengine.com/';</script>
	<script src="../../../../../../tracking.unrealengine.com/tracking.js" async></script>    <div id="webThree">
				<div id="page_head">

			<edc-navigation blackListLangCodes='["de-de","es-es","es-mx","fr-fr","it-it","pt-br","ru-ru","pl-pl","tr-tr"]' locale="zh-CN" ></edc-navigation>
						<div id="pagenav">
				<div class="crumbs" id="crumbs">

	<span class="separator">></span> <a id="parent_link" href="../../index.html">构建虚拟世界</a>

	<span class="separator">></span> <a id="parent_link" href="../index.html">照亮环境</a>

<span class="separator">></span> <span id="page">体积云</span>
</div>				<div id="pageNavRight">
								<!-- Start of Search -->
												<div id="search_container">
					<form name="bodySearch" method="get" action="https://www.unrealengine.com/zh-CN/bing-search" onsubmit="return validateSearch()">
						<input type="image" src="../../../../Include/Images/search_box_icon.png" class="searchbutton"/>
						<input type="hidden" name="filter" value="文档" />
						<input type="text" name="keyword" placeholder="搜索文档……" class="searchbox" autocomplete="off"/>
					</form>
				</div>
								<!-- End of Search -->
				<div id="skinContainer">
	<div id="skinSelect" class="btn btn-skin" onclick="ToggleMenu($('#skinMenu'), $(this));"></div>
	<div id="skinMenu">
		<div id="light" class="btn btn-select" onclick="createCookie('skin', 'light', 365);location.reload();">Light Theme</div>
		<div id="dark" class="btn btn-select" onclick="createCookie('skin', 'dark', 365);location.reload();">Dark Theme</div>
	</div>
</div>				</div>
			</div>
		</div>						<div id="navWrapper">

			 <nav id="navPanel">
				<div class="contents-table-el"><!----><!----><!----><!----><a class="contents-table-link is-parent" href="/zh-CN/Basics/index.html">理解基础概念</a><!----></div>
				<div class="contents-table-el"><a class="contents-table-link is-parent" href="/zh-CN/WorkingWithContent/index.html">管理内容</a><!----></div>
				<div class="contents-table-el"><a class="contents-table-link is-parent" href="/zh-CN/BuildingWorlds/index.html">构建虚拟世界</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/RenderingAndGraphics/index.html">设计视觉、渲染和图形效果</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/ProgrammingAndScripting/index.html">编程和脚本编写</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/InteractiveExperiences/index.html">创建交互体验</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/AnimatingObjects/index.html">为角色和对象添加动画</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/WorkingWithMedia/index.html">使用媒体</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/ProductionPipelines/index.html">建立你的开发流程</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/TestingAndOptimization/index.html">测试并优化你的内容</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/SharingAndReleasing/index.html">项目分享及发布</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/Resources/index.html">示例与教学</a><!----></div>
				<div class="contents-table-el"><a class="contents-table-link is-parent" href="/zh-CN/WhatsNew/index.html">新内容</a></div>
			</nav>
			<div id="navigation" title="Click to toggle navigation menu"><span>></span></div>
		</div>		
		<div id="splitter">
		</div>
				<div id="contentContainer">
										<div id="pagedefault">
				<div id="product-banner">
	<div id="product-logo"></div>
</div>				<div id="pagecontainer" style="padding-right:0px;">
					<!-- Start of Markdown converted page content -->
																				<div class="hero  background">
						<div class="imgContainer"><img src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/CloudsHeroBanner1.png" /></div>						<div class="info">
							<div id="pageTitle">
								<h1 id="H1TitleId">体积云</h1>
							</div>	
							<h2 >关于使用体积云组件和体积材质进行实时云渲染的概述</h2>
							<div id="access">
								<div class="accessContainer">
																																			</div>
							</div>
						</div>
					</div>
																				<div id="maincol">
						<div class="togglesection" id="osContainer">
	<div class="normaltitle">
		<p>Choose your operating system:</p>
	</div><div class="toggleButtons">
		<div class="btn btn-default btn-toggle OS windows" id="windows" onclick="setSelector('OS', 'windows');">
			<p>Windows</p>
		</div>
		<div class="btn btn-default btn-toggle OS mac" id="mac" onclick="setSelector('OS', 'mac');">
			<p>macOS</p>
		</div>
		<div class="btn btn-default btn-toggle OS linux" id="linux" onclick="setSelector('OS', 'linux');">
			<p>Linux</p>
		</div>
	</div>
</div>																		<div id="seeAlso">
	<div style="position:relative;">
		<div id="title">参见</div>
		<div id="pageList">
			<ul>
								<li>
					<p>
						<a id="related_link" href="../LightTypes/SkyLight/index.html" title="关于将天空光照与环境和场景光照结合使用的概述。">天空光照</a>
					</p>
				</li>
								<li>
					<p>
						<a id="related_link" href="../../FogEffects/SkyAtmosphere/index.html" title="天空大气系统用于创建基于物理的天空和大气渲染，提供一天时间功能以及具有空气透视的地面到太空视图过渡。">天空大气</a>
					</p>
				</li>
								<li>
					<p>
						<a id="related_link" href="../LightTypes/Directional/index.html" title="定向光源的基础说明。">定向光源</a>
					</p>
				</li>
							</ul>
		</div>
	</div>
</div>
																														<div class="toc">
<div style="position:relative;">
    <div class="title">
    本页面的内容
    </div>
<div id="tocScroll">
    <ul>
	    		    			    <li id="">
	<p><a id="toc_link" href="#如何渲染云？">如何渲染云？</a></p>
			<ul>
							<li id="">
	<p><a id="toc_link" href="#云体积中的光线步进">云体积中的光线步进</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#光源多重散射">光源多重散射</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#云遮蔽和阴影">云遮蔽和阴影</a></p>
	</li>					</ul>
	</li>		    			    <li id="">
	<p><a id="toc_link" href="#设置并使用体积云">设置并使用体积云</a></p>
			<ul>
							<li id="">
	<p><a id="toc_link" href="#初始关卡设置">初始关卡设置</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#天空光照云反射质量">天空光照云反射质量</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#光线步进质量模式">光线步进质量模式</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#获得电影级质量">获得电影级质量</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#体积材质">体积材质</a></p>
	</li>					</ul>
	</li>		    			    <li id="">
	<p><a id="toc_link" href="#体积插件内容">体积插件内容</a></p>
			<ul>
							<li id="">
	<p><a id="toc_link" href="#云材质示例">云材质示例</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#放置云蓝图">放置云蓝图</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#蓝图绘制云">蓝图绘制云</a></p>
	</li>					</ul>
	</li>		    			    <li id="">
	<p><a id="toc_link" href="#性能和可延展性">性能和可延展性</a></p>
			<ul>
							<li id="">
	<p><a id="toc_link" href="#支持平台">支持平台</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#控制云追踪质量">控制云追踪质量</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#优化体积云材质">优化体积云材质</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#天空光照实时捕获模式预算">天空光照实时捕获模式预算</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#守恒密度计算">守恒密度计算</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#光线追踪和体积云">光线追踪和体积云</a></p>
	</li>					</ul>
	</li>		    	        </ul>
</div>
</div>
</div>
<p>体积云组件是基于物理的云渲染系统，该系统使用材质驱动方法，让美术师和设计师可以自由地创建项目所需的任意类型的云。云系统处理动态实时设置，并通过使用实时捕获模式的<a id="content_link"filter-data="tag_rendering tag_graphics tag_fog_effects tag_sky_atmosphere,_overview" href="../../FogEffects/SkyAtmosphere/index.html" ><span>天空大气（Sky Atmosphere）</span></a>和<a id="content_link"filter-data="tag_lighting" href="../LightTypes/SkyLight/index.html" ><span>天空光照（Sky Light）</span></a>进行补充。该系统提供可伸缩的、美术师定义的云，适用于使用地面视角、飞行以及地面到外太空过渡的项目。<br /></p><p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/VT_CloudExamples.jpg">
		<img class="  lazyload" alt="VT_CloudExamples.png" width="1000" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/VT_CloudExamples.jpg" />
</picture>

</p><h2 id="如何渲染云？">如何渲染云？</h2>
<p>之前，在游戏和电影中进行实时云渲染主要通过将静态材质应用到天空球网格体或者类似方法来实现。现在，体积云系统使用支持光线步进的三维体积纹理来表示实时云层。材质驱动方法为美术师和设计师提供了极大的灵活性，让他们可以创建在天空中飘动的各种各样的云，还能够反映一天之中的不同时间段。 
</p><p>下面各分段将浏览并拆解云系统中的元素，这些元素在实时渲染中进行云的渲染。
</p><h3 id="云体积中的光线步进">云体积中的光线步进</h3>
<p>参与介质要形成云，需要复杂的光照模拟。在消费级硬件上进行实时模拟，会难以实现或者开销太大。体积云系统采用光线步进和近似算法来模拟云渲染，具有可伸缩的实时性能，并支持多种平台和设备。体积云让实时模拟昼夜变换成为可能，支持光照的多重光源散射效果、云投射阴影和投射到云上的阴影、地面对云层底部产生的光照效果等。
</p><h3 id="光源多重散射">光源多重散射</h3>
<p>在到达人眼或摄像机传感器之前，穿过体积的光线可能在体积内的粒子上发生散射。这种光效应被称为多重散射，我们看到的云的形状，就是这种效果引起的。在云里，组成云的小水滴上的反射率通常接近1，意味着光线几乎不能在体积内被吸收。射入云体但在途中未被吸收的光线会产生非常复杂的散射效应。参与介质的多重散射效应会影响光线在云体中的传播路径；让云层看起来浓厚光亮。 
</p><p>在实时渲染中，复杂的多重散射效果是通过对实际散射过程的近似模拟来实现的，具体来说，通过在体积材质中追踪透光率的多个倍频（或步骤）来实现。<strong>体积高级材质输出（Volumetric Advanced Material Output）</strong> 表达式让你可以设置倍频的数量，以及多重散射贡献度、遮蔽、离心率等参数。 
</p><p>下面的例子展示了在多重散射近似过程中没有使用倍频（单次散射）、1倍频、2倍频之间的差别。高倍频可以将附加的散射应用到近似到云材质上，但在处理过程中着色器的开销也随之增加。
</p><div class="note">
	<p>对于游戏项目，由于考虑到性能问题，推荐在光线多重散射处理中只使用单倍频。然而，你可以在云材质中的 <strong>体积高级材质（Volumetric Advanced Material）</strong> 表达式上使用高贡献和低遮蔽值，从而在不影响性能的前提下达到类似效果。参见下面的体积材质分段。</p>
</div><p><strong>地面视角：</strong>
</p><div class="fullwidth">
	<div class="include_wrapper" data-path=" ">
<!--
id:paramliteral
max:paramliteral
ext:paramliteral
caption:paramliteral
image_list:param
-->
<div class="slider_container" id="FS1">
    <div id="FS1_Image"></div>
    <div class="slider"></div>
	    <div class="caption">
        <b><p>拖动滑动条，改变多重散射近似倍频的倍数（0-2）。</p></b>
    </div>
	    <div id="images" class="hidden">
        <p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Octaves_GroundView_0.jpg">
		<img class="  lazyload" alt="Octaves_GroundView_0.png" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Octaves_GroundView_0.jpg" />
</picture>

</p><p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Octaves_GroundView_1.jpg">
		<img class="  lazyload" alt="Octaves_GroundView_1.png" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Octaves_GroundView_1.jpg" />
</picture>

</p><p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Octaves_GroundView_2.jpg">
		<img class="  lazyload" alt="Octaves_GroundView_2.png" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Octaves_GroundView_2.jpg" />
</picture>
</p>
    </div>
</div>
</div>

</div><p><strong>高海拔视角：</strong>
</p><div class="fullwidth">
	<div class="include_wrapper" data-path=" ">
<!--
id:paramliteral
max:paramliteral
ext:paramliteral
caption:paramliteral
image_list:param
-->
<div class="slider_container" id="FS2">
    <div id="FS2_Image"></div>
    <div class="slider"></div>
	    <div class="caption">
        <b><p>拖动滑动条，改变多重散射近似倍频的倍数（0-2）。</p></b>
    </div>
	    <div id="images" class="hidden">
        <p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Octaves_CloudView_0.jpg">
		<img class="  lazyload" alt="Octaves_CloudView_0.png" width="800" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Octaves_CloudView_0.jpg" />
</picture>

</p><p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Octaves_CloudView_1.jpg">
		<img class="  lazyload" alt="Octaves_CloudView_1.png" width="800" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Octaves_CloudView_1.jpg" />
</picture>

</p><p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Octaves_CloudView_2.jpg">
		<img class="  lazyload" alt="Octaves_CloudView_2.png" width="800" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Octaves_CloudView_2.jpg" />
</picture>
</p>
    </div>
</div>
</div>

</div><h3 id="云遮蔽和阴影">云遮蔽和阴影</h3>
<p>有关云渲染的一个重要方面是云如何遮蔽光线以及在表面上投射阴影。云遮蔽和阴影主要由用来代表云的大气光源和体积材质来处理。你可以通过这些组件控制不同的参数，从而决定云的外观，比如拥有阳光轴或者云自身阴影。 
</p><h4 id="体积光线步进和阴影贴图">体积光线步进和阴影贴图</h4>
<p>在云阴影方面有两种可用模式，可以在所用的云材质内切换。这两种模式是：默认所用 <strong>光线步进（Ray Marched）</strong> 以及 <strong>Beer阴影贴图（Beer Shadow Maps）</strong> （BSM）。 
</p><!--
before:param
after:param
position:paramliteral
-->
<div class="comparison_slider">
    <div class="first">
        <p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Shadows_Raymarched.jpg">
		<img class="  lazyload" alt="光线步进" width="1000" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Shadows_Raymarched.jpg" />
</picture>
</p>
        <div class="overlay-first "></div>
    </div>
    <div class="last">
        <p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Shadows_BeerShadowMaps.jpg">
		<img class="  lazyload" alt="Beer阴影贴图" width="1000" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Shadows_BeerShadowMaps.jpg" />
</picture>
</p>
        <div class="overlay-last "></div>
    </div>
</div><ul ><li class="Default"><p><strong>光线步进体积阴影</strong> 使用次级光线步进来获得锐利且颜色丰富的阴影，但是因为所用采样个数有限，仅限于在阴影的追踪距离内使用。尽管开销较大，光线步进阴影非常适合从地面到天空乃至太空的过渡。
</p></li><li class="Default"><p><strong>Beer阴影贴图</strong> 使用级联阴影贴图，为云层提供更远的阴影距离支持，并支持向地面投射阴影。上述方法在渲染时都很快，但缺点是不够精确，并且缺乏体积自身阴影颜色。Beer阴影贴图通常足以满足从地面视角观察云的需求。
</p></li></ul><div class="note">
	<p>对于主机平台，比如Xbox One、PlayStation 4，或者使用同类硬件规格的其他系统，推荐使用Beer阴影贴图来实现云阴影。</p>
</div><p>要在云体积材质中切换上述模式，可以在材质图表中添加 <strong>体积高级材质输出（Volumetric Advanced Material Output）</strong> 表达式。选中该节点，通过在细节面板中切换 <strong>光线步进体积阴影（Ray March Volume Shadow）</strong> 属性复选框的选中状态来切换以上两种阴影类型。 
</p><p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Material_ShadowsTypeSelection.jpg">
		<img class="  lazyload" alt="Material_ShadowsTypeSelection.png" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Material_ShadowsTypeSelection.jpg" />
</picture>

</p><h4 id="定向光源交互和阴影">定向光源交互和阴影</h4>
<p>大气光源（如太阳和月亮）提供了对云和大气阴影的控制。使用大气光源，你可以控制阴影的强度、产生云阴影的位置与当前摄像机位置的距离（km），以及云能否产生自身阴影并把阴影投射到大气中等等。 
</p><p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/DirectionalLight_CloudProperties.jpg">
		<img class="  lazyload" alt="DirectionalLight_CloudProperties.png" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/DirectionalLight_CloudProperties.jpg" />
</picture>

</p><p>在大气光源中启用 <strong>投射云阴影（Cast Cloud Shadows）</strong> 选项将使云体积可以在场景元素上投射阴影并在大气中投射太阳光轴（也称"上帝之光"），太阳光轴由天空大气组件定义。
</p><!--
before:param
after:param
position:paramliteral
-->
<div class="comparison_slider">
    <div class="first">
        <p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Shadows_CloudShadows_OFF.jpg">
		<img class="  lazyload" alt="云阴影：禁用" width="1000" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Shadows_CloudShadows_OFF.jpg" />
</picture>
</p>
        <div class="overlay-first "></div>
    </div>
    <div class="last">
        <p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Shadows_CloudShadows_ON.jpg">
		<img class="  lazyload" alt="云阴影：启用" width="1000" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Shadows_CloudShadows_ON.jpg" />
</picture>
</p>
        <div class="overlay-last "></div>
    </div>
</div><div class="tip">
	<p><strong>云阴影贴图分辨率范围（Cloud Shadow Map Resolution Scale）</strong> 属性决定太阳光轴的分辨率以及性能开销。使用 <strong>云阴影范围（Cloud Shadow Extent）</strong> 属性来降低环绕摄像机的云阴影贴图半径，可以帮助聚焦阴影贴图分辨率，从而实现更锐利、更好的效果。 </p>
</div><p>使用 <strong>投射阴影到大气（Cast Shadows on Atmosphere）</strong> 和 <strong>投射阴影到云（Cast Shadows on Clouds）</strong> 属性可以把不透明对象的阴影投射到大气和云上。对于大型物体的阴影生成，可以在定向光源的属性上设定足够大的 <strong>动态阴影距离（Dynamic Shadow Distance）</strong> 值或者使用 <strong>远距离阴影（Far Shadow Distance）</strong> 属性，为启用了 <strong>远阴影（Far Shadow）</strong> 的物体生成阴影。 
</p><p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/DirectionalLight_OpaqueShadowsOnClouds.jpg">
		<img class="  lazyload" alt="DirectionalLight_OpaqueShadowsOnClouds.png" width="1000" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/DirectionalLight_OpaqueShadowsOnClouds.jpg" />
</picture>

</p><p>使用倍频近似方法在参与介质中模拟光源多重散射可能导致一些能量损失。大气光源的属性 <strong>云散射亮度范围（Cloud Scattering Luminance Scale）</strong> 提供了一个不错的弥补方法，让你可以使用取色器来缩放光源的贡献值，有可能在不增加开销的情况下生成更有趣、更自然的光线散射效果。
</p><div class="lightbox">
	<p><span class="non-localized"><a id="content_link" href="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/DirectionalLight_CloudLuminanceScale.png" ><span><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/DirectionalLight_CloudLuminanceScale.jpg">
		<img class="  lazyload" alt="DirectionalLight_CloudLuminanceScale.png" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/DirectionalLight_CloudLuminanceScale.jpg" />
</picture>
</span></a></span></p>
</div><div class="caption">
	<p>这是一些具有不同云散射亮度范围设定的例子。</p>
</div><div class="ccaption">
	<p>点击查看大图。</p>
</div><h4 id="实时天空光照捕获">实时天空光照捕获</h4>
<p>天空光照组件提供了实时捕获模式，可以处理与以下组件的交互：大气、云、高度雾，以及使用已标签为天空（Is Sky）的无光照材质的不透明网格体。该模式在可以不牺牲性能的前提下，实现更自然的画面以及动态昼夜交替模拟。
</p><div class="note">
	<p>可在天空光照页面中了解更多有关实时捕获模式和其他优化的信息。</p>
</div><p>天空光照云环境光遮蔽
柔和的环境光阴影是让云看起来更自然的一个重要因素。<a id="content_link"filter-data="tag_lighting" href="../LightTypes/SkyLight/index.html" ><span>天空光照（Sky Light）</span></a>组件使用 <strong>云环境光遮蔽（Cloud Ambient Occlusion）</strong> 属性来控制云层能够阻挡多少来自天空和大气的光照。你可以在天空光照细节面板中的 <strong>大气与云（Atmosphere and Cloud）</strong> 分段中找到这些属性。
</p><p>下面的对比展示了启用后强度逐渐增加的环境光遮蔽效果，通过逐步降低发生多散射的光源数量，可以控制天空和大气光源的贡献程度。
</p><!--
before:param
after:param
position:paramliteral
-->
<div class="comparison_slider">
    <div class="first">
        <p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/SkyLight_CloudAO_OFF.jpg">
		<img class="  lazyload" alt="禁用环境光遮蔽" width="1000" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/SkyLight_CloudAO_OFF.jpg" />
</picture>
</p>
        <div class="overlay-first "></div>
    </div>
    <div class="last">
        <p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/SkyLight_CloudAO_ON.jpg">
		<img class="  lazyload" alt="启用环境光遮蔽" width="1000" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/SkyLight_CloudAO_ON.jpg" />
</picture>
</p>
        <div class="overlay-last "></div>
    </div>
</div><h2 id="设置并使用体积云">设置并使用体积云</h2>
<p>体积云系统是现有大气组件的核心部分，大气组件可以构造出天空和星球的大气层。下面各分段将帮助你进行入门设置并与云系统一起使用这些组件。
</p><h3 id="初始关卡设置">初始关卡设置</h3>
<p>创建一个新关卡（或使用已有关卡），关卡内包含以下组件： 
</p><ul ><li class="Default"><p><strong>定向光源（Directional Light）</strong> 组件，启用 <strong>大气太阳光（Atmosphere Sun Light）</strong> 属性，代表太阳或月亮。
</p></li><li class="Default"><p><strong>天空大气（Sky Atmosphere）</strong> 组件，代表星球大气层。
</p></li><li class="Default"><p><strong>天空光照（Sky Light）</strong> 组件，如果你想要模拟动态昼夜变换，则可选择启用 <strong>实时捕获（Real Time Capture）</strong> 属性。
</p></li><li class="Default"><p><strong>体积云（Volumetric Cloud）</strong> 组件，指定体积材质，代表天空中的云。
</p></li></ul><div class="tip">
	<p>使用环境光源混合器，可以在关卡中方便地创建并编辑这些大气组件。混合器使用单个面板显示出了每个组件的相关设置。 
</p><p>更多信息，请参见<a id="content_link"filter-data="tag_lighting tag_environment tag_building_worlds" href="../EnvironmentLightMixer/index.html" ><span>环境光源混合器（Environment Light Mixer）</span></a>。</p>
</div><h3 id="天空光照云反射质量">天空光照云反射质量</h3>
<p><a id="content_link"filter-data="tag_lighting" href="../LightTypes/SkyLight/index.html" ><span>天空光照（Sky Light）</span></a>组件为体积云提供了场景反射。通过设置细节面板上 <strong>云追踪（Cloud Tracing）</strong> 分段里属性的值，你可以通过体积云组件控制场景中用于光线步进反射表面的示例个数。你可以调整用于云反射和云阴影反射的示例个数。
</p><div class="fullwidth">
	<div class="include_wrapper" data-path=" ">
<!--
id:paramliteral
max:paramliteral
ext:paramliteral
caption:paramliteral
image_list:param
-->
<div class="slider_container" id="FS3">
    <div id="FS3_Image"></div>
    <div class="slider"></div>
	    <div class="caption">
        <b><p>拖动滑条，查看示例值逐渐增大的情况，这些示例值将用于追踪云反射光线示例个数：0.25、0.5、0.75、1（默认值）、2、4、8。</p></b>
    </div>
	    <div id="images" class="hidden">
        <p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/SkylightReflectionQuality_0_25.jpg">
		<img class="  lazyload" alt="SkylightReflectionQuality_0_25.png" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/SkylightReflectionQuality_0_25.jpg" />
</picture>

</p><p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/SkylightReflectionQuality_0_50.jpg">
		<img class="  lazyload" alt="SkylightReflectionQuality_0_50.png" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/SkylightReflectionQuality_0_50.jpg" />
</picture>

</p><p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/SkylightReflectionQuality_0_75.jpg">
		<img class="  lazyload" alt="SkylightReflectionQuality_0_75.png" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/SkylightReflectionQuality_0_75.jpg" />
</picture>

</p><p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/SkylightReflectionQuality_1.jpg">
		<img class="  lazyload" alt="SkylightReflectionQuality_1.png" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/SkylightReflectionQuality_1.jpg" />
</picture>

</p><p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/SkylightReflectionQuality_2.jpg">
		<img class="  lazyload" alt="SkylightReflectionQuality_2.png" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/SkylightReflectionQuality_2.jpg" />
</picture>

</p><p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/SkylightReflectionQuality_4.jpg">
		<img class="  lazyload" alt="SkylightReflectionQuality_4.png" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/SkylightReflectionQuality_4.jpg" />
</picture>

</p><p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/SkylightReflectionQuality_8.jpg">
		<img class="  lazyload" alt="SkylightReflectionQuality_8.png" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/SkylightReflectionQuality_8.jpg" />
</picture>
</p>
    </div>
</div>
</div>

</div><div class="tip">
	<p><strong>反射示例数范围（Reflection Sample Count Scale）</strong> 和 <strong>阴影反射示例数范围（Shadow Reflection Sample Count Scale）</strong> 属性的值将被限制。你可以使用命令 <strong>r.VolumetricCloud.ReflectionRaySampleMaxCount</strong> 和 <strong>r.VolumetricCloud.Shadow.ReflectionRaySampleMaxCount</strong> 来增加各自示例数的范围。 </p>
</div><div class="note">
	<p>更多有关实时捕获模式和反射质量属性的信息，请参见<a id="content_link"filter-data="tag_lighting" href="../LightTypes/SkyLight/index.html" ><span>天空光照</span></a>。 </p>
</div><h3 id="光线步进质量模式">光线步进质量模式</h3>
<p>云系统提供了可伸缩的质量模式，适合多种游戏类型，从标准模式到需要从地面向太空运动的快节奏游戏模式。该系统还支持电影级别的质量，适合不注重实时性的项目。 
</p><p>质量模式通过命令 <strong>r.VolumetricRenderTarget</strong> 来设定。
</p><ul ><li class="Default"><p>反应（Reactive）模式支持云与不透明表面相交，但是只能在更低分辨率下实现追踪。 
</p><ul ><li class="Default"><p>推荐质量选项是 <strong> r.VolumetricRenderTarget.Mode 0</strong>。该模式支持快节奏游戏，可能包含从地面到太空的过渡，或者云中飞行。云层的追踪操作很快，但是只能呈现低分辨率效果。追踪在四分之一分辨率上进行，在二分之一分辨率上重建，然后在全分辨率时进行界面上采样。
</p></li><li class="Default"><p><strong>r.VolumetricRenderTarget.Mode 1</strong> 平衡了质量和性能，适合多种主要为地面视角的游戏。该模式开销较高，但是具有质量更高的视觉效果。该模式在半分辨率下进行追踪，在全分辨率下进行重建和界面上采样。
</p></li></ul></li><li class="Default"><p>全分辨率显示的弱反应模式：
</p><ul ><li class="Default"><p><strong>r.VolumetricRenderTarget.Mode 2</strong> 模式注重更高的质量，同时仍支持实时游戏的地面视角。该模式追踪速度很快，可以产生高分辨率效果，但是不支持云与不透明物体相交。
</p></li></ul></li><li class="Default"><p>要达到电影级质量，首先设置 <strong>r.VolumetricRenderTarget 0</strong>，然后遵循"获得电影级质量工作流"中的建议（见下文）。
</p></li></ul><p>根据你想要部署的平台，质量可以进一步提升或者降低。相关操作可以通过控制台命令r.SkyAtmosphere.<em>和r.VolumetricClouds.</em>来完成。此外，在体积材质（Volume Material）、体积云（Volumetric Cloud）、定向光源（Directional Light）组件中，也有一些面向用户的属性。 
</p><h3 id="获得电影级质量">获得电影级质量</h3>
<div class="warning">
	<p>这是一个高级工作流，该工作流绕过了引擎为云和天空的实时渲染所做的优化，会大幅度影响性能。 </p>
</div><p>要让天空大气和体积云组件达到电影级（或者说每像素）质量，可以通过一些命令行来设置云材质的属性，并增加用于追踪大气和云体积的示例数量。<br /></p><!--
before:param
after:param
position:paramliteral
-->
<div class="comparison_slider">
    <div class="first">
        <p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Modes_DefaultQuality.jpg">
		<img class="  lazyload" alt="应用实时品质设置" width="1000" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Modes_DefaultQuality.jpg" />
</picture>
</p>
        <div class="overlay-first "></div>
    </div>
    <div class="last">
        <p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Modes_CinematicQuality.jpg">
		<img class="  lazyload" alt="应用影视级品质设置" width="1000" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Modes_CinematicQuality.jpg" />
</picture>
</p>
        <div class="overlay-last "></div>
    </div>
</div><p>要在项目中获得最高质量的云和大气，下面的步骤是基本起点。 
</p><ol ><li class="Default"><p>设置 <strong>r.VolumetricRenderTarget</strong> 为 <strong>0</strong>，开始启用电影级质量效果。 
</p></li><li class="Default"><p>设置 <strong>r.VolumetricCloud.HighQualityAerialPerspective</strong> 为 <strong>1</strong>，为云启用电影级别空中视角，使用高质量光线追踪代替低分辨率LUT。
</p></li><li class="Default"><p>在体积云组件上设置以下属性值：
</p><ul ><li class="Default"><p>在 <strong>云追踪（Cloud Tracing）</strong> 分段里，加大 <strong>视图（View）、反射（ Reflections）</strong> 和 <strong>阴影（Shadows）</strong> 示例数范围。可以使用每个属性的提示信息中所显示的命令来增加各自的示例数范围。 
</p></li><li class="Default"><p>启用 <strong>使用逐示例大气光源透光（Use Per Sample Atmospheric Light Transmittance）</strong> 属性，用逐示例大气透射代替定向光源全局透射。
</p></li></ul></li><li class="Default"><p>在使用 <strong>体积高级材质输出（Volumetric Advanced Material Output）</strong> 表达式的体积云材质中设置如下属性：
</p><ul ><li class="Default"><p>应用地面光照射云层底部，让场景中的云具有更多形状和颜色。
</p><ul ><li class="Default"><p>在细节面板中启用 <strong>地面贡献（Ground Contribution）</strong>。在体积云组件上，使用 <strong>地面反射率（Ground Albedo）</strong> 属性来设置除太阳光和大气之外，从下方照射云的地面颜色。
</p></li></ul></li><li class="Default"><p>设置用于模拟穿过云体积光源多重散射的近似数量：
</p><ul ><li class="Default"><p>如果你要更好地模拟穿过云体积光源的多重散射效果，可以加大 <strong>多重散射近似倍频（Multi Scattering Approximation Octaves）</strong> 的值，最大为 <strong>2</strong>。 
</p></li><li class="Default"><p>应用额外的倍频后，将有更多穿过云体积的光源发生散射。可以通过调整体积高级输出表达式的 <strong>多重散射贡献（Multi Scattering Contribution）</strong> 和 <strong>多重散射遮蔽（Multi Scattering Occlusion）</strong> 属性值来补偿损失。
</p></li></ul></li></ul></li><li class="Default"><p>启用大气光源的以下阴影属性：
</p><ul ><li class="Default"><p>设置 <strong>投射云阴影（Cast Cloud Shadow）</strong>，将云阴影投射到场景元素和大气上。
</p></li><li class="Default"><p>设置 <strong>投射阴影到云（Cast Shadows on Clouds）</strong>，将不透明对象的阴影投射到云层上。 
</p><div class="note">
	<p>定向光源的 <strong>阴影动态距离（Shadow Dynamic Distance）</strong> 属性值必须足够大，才能真正把大型对象的阴影投射到云上。</p>
</div></li></ul></li><li class="Default"><p>根据项目需求，在下列<a id="content_link"filter-data="tag_rendering tag_graphics tag_fog_effects tag_sky_atmosphere,_overview" href="../../FogEffects/SkyAtmosphere/index.html" ><span>天空大气（Sky Atmosphere）</span></a>质量提升方法中选择一种：
</p><ul ><li class="Default"><p><strong>提升大气渲染的整体质量。</strong> 
</p><ul ><li class="Default"><p>设置 <strong>r.SkyAtmosphere.FastSkyLUT</strong> 为 <strong>0</strong>。禁用此优化将导致渲染变慢，但会产生较少的带有高频细节的视觉伪像，适用于地球阴影或散射波瓣等场景。
</p></li></ul></li><li class="Default"><p><strong>在大气组件中提升大气和太阳光轴的追踪质量。</strong> 
</p><div class="note">
	<p>需要启用 <code>r.SkyAtmosphere.FastSkyLUT</code>。</p>
</div><ul ><li class="Default"><p>设置 <strong>r.SkyAtmosphere.AerialPerspectiveLUT.FastApplyOnOpaque</strong> 为 <strong>0</strong>。 
</p></li><li class="Default"><p>在天空大气组件上，使用 <strong>追踪示例数范围（Trace Sample Count Scale）</strong> 属性的质量滑条来调整所用的示例数量。如果最大范围值还不够，使用 <code>r.SkyAtmosphere.SampleCountMax</code> 命令来设置一个更高的限制值，然后在属性字段中手工输入值。
</p></li><li class="Default"><p>使用 <strong>r.SkyAtmosphereFastSkyLUT.Width</strong> 和 <strong>r.SkyAtmosphere.FastSkyLUT.Height</strong> 命令来增加LUT的大小，从而提升太阳光轴的质量。 
</p></li><li class="Default"><p>增加 <strong>r.SkyAtmosphere.AerialPerspectiveLUT.Width</strong> 的值，可改善不透明和半透明表面的质量。
</p></li></ul><div class="warning">
	<p>在调大该值时一定要谨慎，因为该值对应的是3D体积纹理，会消耗大量内存。</p>
</div></li></ul></li></ol><h3 id="体积材质">体积材质</h3>
<p>使用 <strong>体积（Volume）</strong> 材质域的材质类型，可用体积纹理来呈现云的外观。体积纹理是一种3D纹理，可拆分为一系列对齐到网格的2D纹理。材质中的此类纹理用于不同的体积效果，比如烟雾和云，适合于表现光线穿过体积等场景的效果。 
</p><p>下面的体积纹理代表一个网格中的一系列二维图像（左），当堆叠到一起时，将会构成一个三维体积（右）。 
</p><p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/VolumeTexture.jpg">
		<img class="  lazyload" alt="VolumeTexture.png" width="1000" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/VolumeTexture.jpg" />
</picture>

</p><div class="caption">
	<p>使用纹理编辑器打开并查看体积纹理，可以显示该纹理的二维图像视图（左），或者三维视图（右）。</p>
</div><p>除了在体积云组件和材质中可以控制的属性之外，体积纹理是生成云初始外观的最基本元素，并且有助于定义可能的效果。体积纹理开启了通过云材质创建多种不同类型的云和效果的可能性。
</p><p>下面的例子展示了用单个体积材质生成几种不同的云，只需要在每个实例上调整一些参数即可。这个例子使用了 <code>M&#95;volumetricCloud&#95;02&#95;Profiles&#95;Soft</code>，位于体积插件内容中（如下所示）。
</p><p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/VT_CloudExamples.jpg">
		<img class="  lazyload" alt="VT_CloudExamples.png" width="1000" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/VT_CloudExamples.jpg" />
</picture>

</p><p>体积材质有材质表达式输入和输出节点，这些节点提供了可编辑的属性，从而构成云材质的基础。部分设置可以影响性能，可能会增大或降低着色器的开销。
</p><div class="tip">
	<p>使用这些表达式时，推荐参数化这些表达式的值，以便在<a id="content_link"filter-data="tag_materials" href="../../../RenderingAndGraphics/Materials/MaterialInstances/index.html" ><span>材质实例</span></a>中快速方便地调整这些值。</p>
</div><h2 id="体积插件内容">体积插件内容</h2>
<div class="warning">
	<p>此插件的内容仅为演示目的，在实际项目中可能不需要全部优化。在未来版本中可能更改或移除某些内容。此插件的目的是为你在编辑器中创建自己的内容提供一个起始点。</p>
</div><p><strong>体积（Volumetrics）</strong> 插件包含了由Epic自己的技术美术师创建的示例和实验性内容，某些内容并非专为云渲染或者使用体积渲染的其他工具而创建，比如流体模拟。
</p><p>请遵循以下入门步骤： 
</p><ol ><li class="Default"><p>从主菜单中选择 <strong>窗口（Window） > 插件（Plugin）</strong>，然后启用此插件。搜索并启用 <strong>体积（Volumetrics）</strong> 插件。
</p><div class="lightbox">
	<p><span class="non-localized"><a id="content_link" href="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/VolumetricsPlugin_Enable.png" ><span><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/VolumetricsPlugin_Enable.jpg">
		<img class="  lazyload" alt="VolumetricsPlugin_Enable.png" width="500" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/VolumetricsPlugin_Enable.jpg" />
</picture>
</span></a></span></p>
</div><div class="caption">
	<p> 点击查看大图。   </p>
</div></li><li class="Default"><p>在 <strong>内容浏览器（Content Browser）</strong> 中，打开 <strong>视图选项（View Options）</strong> 菜单并启用 <strong>显示引擎内容（Show Engine Content）</strong> 和 <strong>显示插件内容（Show Plugin Content）</strong>。
</p><div class="lightbox">
	<p><span class="non-localized"><a id="content_link" href="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/VolumetricsPlugin_CBViewOptions.png" ><span><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/VolumetricsPlugin_CBViewOptions.jpg">
		<img class="  lazyload" alt="VolumetricsPlugin_CBViewOptions.png" width="250" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/VolumetricsPlugin_CBViewOptions.jpg" />
</picture>
</span></a></span></p>
</div><div class="caption">
	<p> 点击查看大图。   </p>
</div></li><li class="Default"><p>使用内容浏览器的层级来定位并选择体积（Volumetrics）文件夹，该位置存储了此插件的内容。
</p></li></ol><h3 id="云材质示例">云材质示例</h3>
<p>在此插件中，有几种类型的云材质可供选择。这些材质可用来在场景中生成不同类型的云。
</p><p>可以在/Content/Sky/Materials文件夹中找到这些云材质，它们都带有 <strong>M_Volumetric_Cloud_</strong> 前缀。例如，<strong>Content/Sky/Materials/M_Volumetric_Cloud_02_Profiles_Soft</strong>。
</p><div class="tip">
	<p>要有效使用这些材质，可以先创建云材质的<a id="content_link"filter-data="tag_materials" href="../../../RenderingAndGraphics/Materials/MaterialInstances/index.html" ><span>材质实例</span></a>，然后将实例应用到体积云组件的 <strong>材质（Material）</strong> 属性槽上。打开材质实例后，你可以更改云渲染相关参数，实现自己理想的云外观、密度、大小等等。 </p>
</div><div class="note">
	<p>本文档中大部分有关云的屏幕截图都是使用这些示例云材质创建的，只是材质实例上的参数不同。</p>
</div><h3 id="放置云蓝图">放置云蓝图</h3>
<p>使用此插件文件夹中的示例设置将单个云蓝图Actor放置到场景中。场景中单个放置的蓝图可以缩放、旋转、沿X轴和Y轴移动。场景中需要有体积云组件和相关的云材质以供使用。蓝图云Actor可以激活场景中附加的自定义选项和云放置位置。
</p><p>你可以在 <strong>Composite_Cloud_Object关卡</strong> 中的 <code>/Tools/CloudCompositing/Maps</code> 文件夹里找到配置示例。查看一下 <strong>BP_CloudMask_Object</strong> 和 <strong>BP_CloudMask_Generator</strong>，了解本场景是如何配置的，以及此Actor上的可调节属性。 
</p><!--
videoid:paramliteral
width:paramliteral
height:paramliteral
units:paramliteral
type:paramliteral
start:paramliteral
service:paramliteral
-->
<style type="text/css">
#player_1_znxtyi94_313
{
	margin: 0px;
	width: 75%;
	display: inline-block;
	position: relative;
	overflow: hidden;
}
#player_1_znxtyi94_313:after
{
	content: "";
	padding-top: 56.25%;
	display: block;
}
</style> 
<div id="player_1_znxtyi94_313"> 
	<div id="playerContainer_1_znxtyi94_313" style="position:absolute;top:0;left: 0;right: 0;bottom:0;border:solid thin black;">
		<iframe width="100%" height="100%" frameborder="0" allow="autoplay; encrypted-media;" allowfullscreen="" src="https://dev.epicgames.com/community/api/cms/videos/1_znxtyi94/embed.html"></iframe>
	</div>
</div>
<h3 id="蓝图绘制云">蓝图绘制云</h3>
<p>使用此示例设置开始为你的天空绘制云，在场景中添加稀疏或者稠密的云彩。此示例使用编辑器内运行游戏模式，以及一个简单的用户界面，使用鼠标光标绘制云，可以缩放笔刷、调整笔刷密度等等。
</p><p>你可以在 <strong>Paint_Clouds</strong> 关卡中的 <code>/Tools/CloudCompositing/Maps</code> 文件夹里找到配置示例。选择 <strong>BP_PaintClouds</strong> Actor，查看你可更改的一些属性，这些属性定义了如何绘制云。
</p><!--
videoid:paramliteral
width:paramliteral
height:paramliteral
units:paramliteral
type:paramliteral
start:paramliteral
service:paramliteral
-->
<style type="text/css">
#player_1_b3r3bddw_336
{
	margin: 0px;
	width: 75%;
	display: inline-block;
	position: relative;
	overflow: hidden;
}
#player_1_b3r3bddw_336:after
{
	content: "";
	padding-top: 56.25%;
	display: block;
}
</style> 
<div id="player_1_b3r3bddw_336"> 
	<div id="playerContainer_1_b3r3bddw_336" style="position:absolute;top:0;left: 0;right: 0;bottom:0;border:solid thin black;">
		<iframe width="100%" height="100%" frameborder="0" allow="autoplay; encrypted-media;" allowfullscreen="" src="https://dev.epicgames.com/community/api/cms/videos/1_b3r3bddw/embed.html"></iframe>
	</div>
</div>
<p>要开始绘制云，在主工具栏中按 <strong>运行（Play）</strong>，开始在编辑器内运行。使用下列操作在场景中绘制云：
</p><ul ><li class="Default"><p>使用 *鼠标左键** 绘制云体积
</p></li><li class="Default"><p>使用 *鼠标滚轮** 缩放绘制笔刷大小。
</p></li><li class="Default"><p>使用 <strong>Shift + 鼠标滚轮</strong> 改变绘制时的笔刷强度。
</p></li><li class="Default"><p>在绘制时按 <strong>Shift</strong>，可擦除已绘制的区域。
</p></li><li class="Default"><p>当你在 <strong>BP_PaintCloud</strong> 属性的 <strong>绘制模式（Paint Mode）</strong> 下拉菜单中选择了 <strong>速度（Velocity）</strong> 选项后，可以使用 <strong>鼠标右键 + 鼠标滚轮</strong> 缩放绘制速度。
</p></li></ul><h2 id="性能和可延展性">性能和可延展性</h2>
<p>在项目开发中，处理性能和跨平台可延展性非常重要。下面各分段包含了有关调整云质量和捕获和点亮项目中的云相关其他功能的信息。 
</p><h3 id="支持平台">支持平台</h3>
<p>体积云和天空大气组件支持通过以下平台提供可扩展的大气系统：
</p><table >
	<caption></caption>
	<col align=""/>
	<col align=""/>
	<col align=""/>
	<col align=""/>
	<col align=""/>
	<thead>
		<tr >

	<th rowspan="1" colspan="1" >
			<p>功能 </p>
			</th>
	
	<th rowspan="1" colspan="1" >
			<p>移动端 </p>
			</th>
	
	<th rowspan="1" colspan="1" >
			<p>XB1/PS4 </p>
			</th>
	
	<th rowspan="1" colspan="1" >
			<p>XBX/PS5 </p>
			</th>
	
	<th rowspan="1" colspan="1" >
			<p>低端/高端 PC </p>
			</th>
	
</tr>	</thead>
<tbody>
	<tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>天空大气（SkyAtmosphere）</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>支持</p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>支持</p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>支持</p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>支持</p>
			</td>
	
</tr><tr >

	<td rowspan="1" colspan="1" align="">
			<p><strong>体积云（Volumetric Clouds）</strong></p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>不支持</p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>支持*</p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>支持</p>
			</td>
	
	<td rowspan="1" colspan="1" align="">
			<p>支持</p>
			</td>
	
</tr></tbody>
</table><p>* 需要一个天空球网格体且该网格体启用了 <strong>是天空（Is Sky）</strong> 选项。
** 要在这些平台上获得可接受的性能，推荐使用阴影贴图方法来计算云自身阴影，而不要使用<a id="content_link" href="#体积光线步进和阴影贴图" ><span>体积光线步进和阴影贴图</span></a>分段中所述的次级追踪方法。
</p><h3 id="控制云追踪质量">控制云追踪质量</h3>
<p>云系统通过体积材质执行几种追踪操作。追踪质量取决于所用的示例数量。示例数量越多，质量越高。反之亦然，示例数量越少，质量越低。 
</p><!--
before:param
after:param
position:paramliteral
-->
<div class="comparison_slider">
    <div class="first">
        <p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Performance_TracingQuality_Default.jpg">
		<img class="  lazyload" alt="默认示例数（1.0）" width="1000" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Performance_TracingQuality_Default.jpg" />
</picture>
</p>
        <div class="overlay-first "></div>
    </div>
    <div class="last">
        <p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Performance_TracingQuality_Lowered.jpg">
		<img class="  lazyload" alt="较低示例数（0.25）" width="1000" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Performance_TracingQuality_Lowered.jpg" />
</picture>
</p>
        <div class="overlay-last "></div>
    </div>
</div><p>对于不同平台，在性能和质量之间取得平衡很重要。<strong>云追踪（Cloud Tracing）</strong> 属性让你可以调节关键云属性的追踪质量，比如云反射、云和云反射的阴影示例数，以及从摄像机出发的云阴影停止距离等。 
</p><p><picture>
		<source data-srcset="./../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Performance_TracingQuality_Properties.jpg">
		<img class="  lazyload" alt="Performance_TracingQuality_Properties.png" data-src="../../../../Images/BuildingWorlds/LightingAndShadows/VolumetricClouds/Performance_TracingQuality_Properties.jpg" />
</picture>

</p><div class="tip">
	<p>每种属性都有自己的控制台命令，根据不同平台，可以使用设备描述配置文件（*.ini）进行单独配置。在跨越不同平台设置目标可延展性时，这种机制带来了极大的灵活性。 </p>
</div><h3 id="优化体积云材质">优化体积云材质</h3>
<p>云渲染的基础是体积材质，以及在材质图表中所用的 <strong>体积高级输出（Volumetric Advanced Output）</strong> 和 <strong>体积高级输入（Volumetric Advanced Input）</strong> 表达式。你可以参数化云材质的很多方面，来控制材质实例化的一些属性，但是部分属性只能在基础材质节点上设置。 
</p><p>在考虑如何优化项目中的云材质时，下面是一些建议，适用于 <strong>体积高级输出（Volumetric Advanced Output）</strong> 表达式，也可以单独使用：
</p><ul ><li class="Default"><p>在求值过程中，如果使用 <strong>灰阶范围材质（Gray Scale Material）</strong>，将只考虑材质输入参数中的 <strong>R</strong> （红色）信道。在场景中，云对应的材质将为灰阶材质，但材质光照仍将为彩色。 
</p></li><li class="Default"><p>如果帧预算允许，启用 <strong>地面贡献（Ground Contribution）</strong>。此操作将增加一些开销，用于追踪地面光源对于云层底部进行阴影光照的示例。
</p></li><li class="Default"><p>限制 <strong>多重散射倍频数（Multi Scattering Approximation Octave Counts）</strong> 的值，可以节省着色器中的部分性能开销。默认情况下，该操作使用单散射（0），但是也可以使用最大为2的近似倍频，在云体积中模拟光线的多重散射效果。 
</p></li><li class="Default"><p>使用 <strong>光线步进体积阴影（Ray March Volume Shadow）</strong> 复选框在云体积次级光线步进和使用级联阴影贴图之间切换。启用级联阴影贴图（不检测盒体）提供了一种性能增强方法，可以带来无限长度的阴影，尽管该方法不太精确并且会导致颜色灰阶化。
</p></li><li class="Default"><p><strong>守恒密度（Conservative Density）</strong> 属性用于跳过先前耗时的材质求值过程，从而加速光线步进。浮点向量（向量3）的 <strong>X</strong> 分量表示参与介质的守恒密度。如果该值大于 <strong>0</strong>，表示该材质已求值，否则将直接对下一个示例求值。更多细节请参见体积云参考。
</p></li></ul><h3 id="天空光照实时捕获模式预算">天空光照实时捕获模式预算</h3>
<p>天空光照实时捕获模式可启用9帧时间段，让单帧捕获对应到多个帧上。由于时间分段的成本与其最昂贵的帧一样昂贵，此优化可提升昼夜变换模拟的性能，让性能开销大幅降低。该特性让你有机会在不增加每帧性能负担的前提下提升其他方面的质量。 
</p><p>例如，如果你拆解捕获的场景元素以及各自的帧开销，发现高光度卷积（Specular Convolution）每帧耗费了0.8毫秒，但是天空和云只耗费了0.6毫秒，那么你仍然有可能略微提升天空和云的质量，而无须付出额外成本。 
</p><h3 id="守恒密度计算">守恒密度计算</h3>
<p><strong>守恒密度（Conservative Density）</strong> 作为优化光线步进过程的一种方式而添加进来。为大气中每一个光线步进示例计算整个云材质图表是很耗时的，可能开销很快就变得不堪重负。为了减轻开销，可以使用用户设置的恒定密度。例如，在使用 <strong>体积高级输入（Volumetric Advanced Input）</strong> 表达式进行材质运算时，可能使用一个自上而下的二维纹理，该纹理描述了云密度，这里唯一的规则是，当大气中有云存在时，守恒密度必须大于0。 
</p><p>当在大气中执行光线步进时，如果使用了使用守恒密度输入，云材质示例将通过两步获得：
</p><ol ><li class="Default"><p>在 <strong>体积高级输出（Volumetric Advanced Output）</strong> 节点中计算守恒密度输入（向量3）图表。 
</p></li><li class="Default"><p>如果守恒密度的X分量（在向量3中）大于0：
</p><ol ><li class="Default"><p>决定求值插入 <strong>主材质（Main Material）</strong> 节点中的开销更大的材质图表（求值反射率、发射颜色和消光）。 
</p></li><li class="Default"><p>可以使用 <strong>体积高级输入（Volumetric Advanced Input）</strong> 节点来获取这些值，这样可以避免计算在第一步中已经求值的守恒密度值。
</p></li></ol></li><li class="Default"><p>否则，如果守恒密度的X分量等于或者小于0，将跳过开销更大的材质估值，开始处理下一个示例。
</p></li></ol><div class="note">
	<p>虚幻引擎的材质图表中不支持动态分支。守恒密度输入让动态分支可以跳过开销可能很大的材质求值。当虚幻引擎在材质中原生支持动态分支之后，此类输入将废弃，让技术美术师决定哪些部分可以动态跳过。 </p>
</div><h3 id="光线追踪和体积云">光线追踪和体积云</h3>
<p>云层系统不支持<a id="content_link"filter-data="tag_ray_tracing" href="../../../RenderingAndGraphics/RayTracing/index.html" ><span>光线追踪</span></a>，并且只考虑渲染进天空光照的云。跟踪体积云的反射会对性能造成很大开销。
</p><p>假如你希望让天空中的对象出现反射，可以通过将天空光照Actor放得离它近一些（天空中）来实现。 </p>
																	</div>
					<!-- End of Markdown converted page content -->
				</div>
												<div id="pageTags">
				<div class="title">标签</div>
					<div>
					<div class="keyword_tag_filter"><a id="tag_link" href="../../../SiteIndex/index.html?tags=Atmosphere">Atmosphere</a></div>
<div class="keyword_tag_filter"><a id="tag_link" href="../../../SiteIndex/index.html?tags=Building%20Worlds">Building Worlds</a></div>
<div class="keyword_tag_filter"><a id="tag_link" href="../../../SiteIndex/index.html?tags=Rendering">Rendering</a></div>
<div class="keyword_tag_filter"><a id="tag_link" href="../../../SiteIndex/index.html?tags=Clouds">Clouds</a></div>
					</div>
				</div>
								<div id="recommendations"></div>			</div>
						  									<div id="announcement">
			<div style="display:inline-block;margin:5px;">
				欢迎帮助改进虚幻引擎文档！请告诉我们该如何更好地为您服务。
			</div>
			<div style="margin:5px;display:inline-block;">
				<div class="btn action" style="margin-top:-6px;display:inline-block;" onclick="$('#announcement').hide();window.open('https://epicgames.questionpro.com/t/AP9dGZkjp4');createCookie('announcement-read', new Date().getTime(), 30);">填写问卷调查</div>
				<div class="btn btn-default" style="margin-top:-6px;display:inline-block;" onclick="$('#announcement').hide();createCookie('announcement-read', new Date().getTime(), 30);">取消</div>
			</div>
			<div class="btn-close" style="position:absolute;right:5px;top:10px;padding:3px;width:14px;height:14px;" onclick="$('#announcement').hide();"></div>
			</div>
					</div>
	</div></body>

<!-- Mirrored from docs.unrealengine.com/4.26/zh-CN/BuildingWorlds/LightingAndShadows/VolumetricClouds/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 17 Jan 2024 12:09:38 GMT -->
</html>
