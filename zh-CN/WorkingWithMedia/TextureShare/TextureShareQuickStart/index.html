<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">

<!-- Mirrored from docs.unrealengine.com/4.26/zh-CN/WorkingWithMedia/TextureShare/TextureShareQuickStart/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 17 Jan 2024 12:38:12 GMT -->
<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <script src="../../../../Include/Javascript/common_zh-CN.js" type="text/javascript"></script>
	<script type="text/javascript">
		var time = new Date(0);
		var preview = false;
		var relativeHTMLPath = "https://docs.unrealengine.com/4.26/";
				var pageid = 0;
				var heroimage = "../../../../Images/WorkingWithMedia/TextureShare/TextureShareQuickStart/texture_share_hero_image.png";
				var lang = "zh-CN";
				var basePath = document.location.pathname.substring(0, document.location.pathname.indexOf('/' + lang + '/') + lang.length + 1);
		document.write('<base href="' +  encodeURI(basePath) + '/WorkingWithMedia/TextureShare/TextureShareQuickStart/" />');
				var udnCSS = '../../../../Include/CSS/udn_public.css';
		var udnLangCSS = '';
				udnLangCSS = './../../../../Include/CSS/udn_public_CN.css">';
				var udnOverrideCSS = '../../../../Include/CSS/skin_overrides.css';
		var udnOverrideDarkCSS = '../../../../Include/CSS/skin_overrides_dark.css';
		var fancyboxCSS = '../../../../Include/CSS/jquery.fancybox.css';
		var jqueryuiCSS = '../../../../Include/CSS/jquery-ui.min.css';
		var qtipCSS = '../../../../Include/CSS/jquery.qtip.css';
		var prettifyCSS = '../../../../Include/CSS/prettify.css';
		var navbarCSS = '../../../../Include/CSS/navBar.css';
		var twentytwentyCSS = '../../../../Include/CSS/twentytwenty.css';
		var recommendationsCSS = '../../../../Include/CSS/jquery.recommendations.css';
	</script>
    <title>纹理共享快速入门 | 虚幻引擎文档</title>
    	    <meta name=viewport content="width=device-width, initial-scale=1" />
	<meta http-equiv="Cache-control" content="no-store">
    <script  src="../../../../Include/Javascript/CustomEvent.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery-3.4.0.min.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/udn.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/udn_extras.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery-ui.min.js" type="text/javascript"></script>
	    <script  src="../../../../Include/Javascript/informational.js" type="text/javascript"></script>
	    <script  src="../../../../Include/Javascript/jquery.fancybox.pack.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery.qtip.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/prettify.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery.slimscroll.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery.event.move.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/jquery.twentytwenty.js" type="text/javascript"></script>
    <script  src="../../../../Include/Javascript/lazysizes.min.js" type="text/javascript"></script>
	    <script  src="../../../../Include/Javascript/jquery.recommendations.js" type="text/javascript"></script>
	
    <link async rel="icon" href="../../../../../favicon.png" type="image/x-icon" />
    <link async rel="shortcut icon" href="../../../../../favicon.png" type="image/x-icon" />
    <link async href="../../../../Include/Images/touch_icon.png" rel="apple-touch-icon" />
    <link async href="../../../../Include/Images/touch_icon_114.png" sizes="114x114" rel="apple-touch-icon" />    
		<script  src="../../../../Include/Javascript/CollapsibleLists.js" type="text/javascript"></script>
	<script  src="../../../../Include/Javascript/navigationBarUI.js"></script>
	<script  src="../../../../Include/Javascript/navigationBar.js"></script>
		
	<link rel="alternate" href="https://docs.unrealengine.com/latest/en-US/WorkingWithMedia/TextureShare/TextureShareQuickStart/" hreflang="x-default" />
<link rel="alternate" href="https://docs.unrealengine.com/latest/zh-CN/WorkingWithMedia/TextureShare/TextureShareQuickStart/" hreflang="zh-CN" />
<link rel="alternate" href="https://docs.unrealengine.com/latest/ja/WorkingWithMedia/TextureShare/TextureShareQuickStart/" hreflang="ja" />
<link rel="alternate" href="https://docs.unrealengine.com/latest/ko/WorkingWithMedia/TextureShare/TextureShareQuickStart/" hreflang="ko" />

	<meta name="intsourcechangelist" content="15421180" />
<meta name="availability" content="Public" />
<meta name="title" content="纹理共享快速入门" />
<meta name="description" content="初步了解如何在你的项目中使用纹理共享SDK和虚幻引擎插件。" />
<meta name="parent" content="WorkingWithMedia/TextureShare" />
<meta name="type" content="quickstart" />
<meta name="version" content="4.26" />
<meta name="related" content="WorkingWithMedia/TextureShare" />
<meta name="related" content="WorkingWithMedia/nDisplay" />
<meta name="keywords" content="beta" />
<meta name="topic-image" content="texture_share_topic_image.png" />
<meta name="hero-image" content="texture_share_hero_image.png" />
<meta name="reference-image" content="receive_textures_into_unreal.gif" />
<meta name="reference-image" content="sending_textures_from_unreal.gif" />
<meta name="reference-image" content="unreal_sharing_viewport.gif" />
<meta name="crumbs" content="%ROOT%,WorkingWithMedia,WorkingWithMedia/TextureShare" />

	<meta name="twitter:card" content="summary_large_image" />
	<meta property="og:title" content="纹理共享快速入门" />
	<meta property="og:description" content="初步了解如何在你的项目中使用纹理共享SDK和虚幻引擎插件。" />
		<meta property="og:image" content="" />
	</head>
<body id="webbgThree" style="visibility: hidden;" onload="document.body.style.visibility='visible';">
			<script>window.__tracking_base = 'https://tracking.unrealengine.com/';</script>
	<script src="../../../../../../tracking.unrealengine.com/tracking.js" async></script>    <div id="webThree">
				<div id="page_head">

			<edc-navigation blackListLangCodes='["de-de","es-es","es-mx","fr-fr","it-it","pt-br","ru-ru","pl-pl","tr-tr"]' locale="zh-CN" ></edc-navigation>
						<div id="pagenav">
				<div class="crumbs" id="crumbs">

	<span class="separator">></span> <a id="parent_link" href="../../index.html">使用媒体</a>

	<span class="separator">></span> <a id="parent_link" href="../index.html">纹理共享</a>

<span class="separator">></span> <span id="page">纹理共享快速入门</span>
</div>				<div id="pageNavRight">
								<!-- Start of Search -->
												<div id="search_container">
					<form name="bodySearch" method="get" action="https://www.unrealengine.com/zh-CN/bing-search" onsubmit="return validateSearch()">
						<input type="image" src="../../../../Include/Images/search_box_icon.png" class="searchbutton"/>
						<input type="hidden" name="filter" value="文档" />
						<input type="text" name="keyword" placeholder="搜索文档……" class="searchbox" autocomplete="off"/>
					</form>
				</div>
								<!-- End of Search -->
				<div id="skinContainer">
	<div id="skinSelect" class="btn btn-skin" onclick="ToggleMenu($('#skinMenu'), $(this));"></div>
	<div id="skinMenu">
		<div id="light" class="btn btn-select" onclick="createCookie('skin', 'light', 365);location.reload();">Light Theme</div>
		<div id="dark" class="btn btn-select" onclick="createCookie('skin', 'dark', 365);location.reload();">Dark Theme</div>
	</div>
</div>				</div>
			</div>
		</div>						<div id="navWrapper">
			<div id="nav-filter-container">
				<div id="nav-filter-inner">
					<form>
						<input type="text" placeholder="Filter pages..." id="nav-filter" onchange="clearTimeout(filterTimer); filterTimer = setTimeout(updateNavTreeFilter,250, this.value);if(this.value.length == 0){$('#filter-clear').hide();}else{$('#filter-clear').show();}" onkeypress="this.onchange();" onpaste="this.onchange();" oninput="this.onchange();" />
						<button class="close-icon" id="filter-clear" type="reset" onclick="clearTimeout(filterTimer); filterTimer = setTimeout(updateNavTreeFilter,250, '');$(this).hide();"></button>
					</form>
				</div>
			</div>
			 <nav id="navPanel">
				<div class="contents-table-el"><!----><!----><!----><!----><a class="contents-table-link is-parent" href="/zh-CN/Basics/index.html">理解基础概念</a><!----></div>
				<div class="contents-table-el"><a class="contents-table-link is-parent" href="/zh-CN/WorkingWithContent/index.html">管理内容</a><!----></div>
				<div class="contents-table-el"><a class="contents-table-link is-parent" href="/zh-CN/BuildingWorlds/index.html">构建虚拟世界</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/RenderingAndGraphics/index.html">设计视觉、渲染和图形效果</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/ProgrammingAndScripting/index.html">编程和脚本编写</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/InteractiveExperiences/index.html">创建交互体验</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/AnimatingObjects/index.html">为角色和对象添加动画</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/WorkingWithMedia/index.html">使用媒体</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/ProductionPipelines/index.html">建立你的开发流程</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/TestingAndOptimization/index.html">测试并优化你的内容</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/SharingAndReleasing/index.html">项目分享及发布</a><!----></div>
				<div class="contents-table-el"> <a class="contents-table-link is-parent" href="/zh-CN/Resources/index.html">示例与教学</a><!----></div>
				<div class="contents-table-el"><a class="contents-table-link is-parent" href="/zh-CN/WhatsNew/index.html">新内容</a></div>
			</nav>
			<div id="navigation" title="Click to toggle navigation menu"><span>></span></div>
		</div>		
		<div id="splitter">
		</div>
				<div id="contentContainer">
										<div id="pagedefault">
				<div id="product-banner">
	<div id="product-logo"></div>
</div>				<div id="pagecontainer" style="padding-right:0px;">
					<!-- Start of Markdown converted page content -->
					<div id="banner" class="beta">
	<div id="message">
		学习使用此<span>测试</span>功能，但在用它发布产品时请谨慎行事。
	</div>
	<div id="bannerDescription">
		测试功能主要供您学习如何使用、规划工作流程和创建测试内容之用。<strong>在实际生产中使用这些功能必须谨慎</strong>，因为我们仍在努力完善以使它们的性能、稳定性和平台支持达到发布水准。我们支持资源的向后兼容，这些功能的API也是稳定的。
	</div>
</div>
															<div class="hero  background">
						<div class="imgContainer"><img src="../../../../Images/WorkingWithMedia/TextureShare/TextureShareQuickStart/texture_share_hero_image.png" /></div>						<div class="info">
							<div id="pageTitle">
								<h1 id="H1TitleId">纹理共享快速入门</h1>
							</div>	
							<h2 >初步了解如何在你的项目中使用纹理共享SDK和虚幻引擎插件。</h2>
							<div id="access">
								<div class="accessContainer">
																																			</div>
							</div>
						</div>
					</div>
																				<div id="maincol">
						<div class="togglesection" id="osContainer">
	<div class="normaltitle">
		<p>Choose your operating system:</p>
	</div><div class="toggleButtons">
		<div class="btn btn-default btn-toggle OS windows" id="windows" onclick="setSelector('OS', 'windows');">
			<p>Windows</p>
		</div>
		<div class="btn btn-default btn-toggle OS mac" id="mac" onclick="setSelector('OS', 'mac');">
			<p>macOS</p>
		</div>
		<div class="btn btn-default btn-toggle OS linux" id="linux" onclick="setSelector('OS', 'linux');">
			<p>Linux</p>
		</div>
	</div>
</div>																		<div id="seeAlso">
	<div style="position:relative;">
		<div id="title">参见</div>
		<div id="pageList">
			<ul>
								<li>
					<p>
						<a id="related_link" href="../index.html" title="跨虚幻实例、nDisplay设备和其他图形应用程序共享GPU数据并绕过CPU。">纹理共享</a>
					</p>
				</li>
								<li>
					<p>
						<a id="related_link" href="../../nDisplay/index.html" title="nDisplay系统可以在多个显示屏上同时渲染您的虚幻引擎项目。">使用nDisplay在多显示屏上进行渲染</a>
					</p>
				</li>
							</ul>
		</div>
	</div>
</div>
																														<div class="toc">
<div style="position:relative;">
    <div class="title">
    本页面的内容
    </div>
<div id="tocScroll">
    <ul>
	    		    			    <li id="">
	<p><a id="toc_link" href="#步骤1-开始使用sdk">步骤1 - 开始使用SDK</a></p>
			<ul>
							<li id="">
	<p><a id="toc_link" href="#c++sdk集成">C++ SDK集成</a></p>
			<ul>
							<li id="">
	<p><a id="toc_link" href="#include文件">Include文件</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#初始化">初始化</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#渲染线程">渲染线程</a></p>
	</li>							<li id="">
	<p><a id="toc_link" href="#清理">清理</a></p>
	</li>					</ul>
	</li>					</ul>
	</li>		    			    <li id="">
	<p><a id="toc_link" href="#步骤2-开始在虚幻中使用">步骤2 - 开始在虚幻中使用</a></p>
	</li>		    			    <li id="">
	<p><a id="toc_link" href="#步骤3-将虚幻场景作为纹理发送到directx应用程序">步骤3 - 将虚幻场景作为纹理发送到DirectX应用程序</a></p>
	</li>		    			    <li id="">
	<p><a id="toc_link" href="#步骤4-将纹理发送到外部directx应用程序">步骤4 - 将纹理发送到外部DirectX应用程序</a></p>
	</li>		    			    <li id="">
	<p><a id="toc_link" href="#步骤5-从directx应用程序接收纹理并在虚幻中显示它们">步骤5 - 从DirectX应用程序接收纹理并在虚幻中显示它们</a></p>
	</li>		    	        </ul>
</div>
</div>
</div>
<p>阅读完本指南，你将熟悉以下操作：
</p><ul ><li class="Default"><p>从源构建纹理共享SDK。
</p></li><li class="Default"><p>将C++ SDK与DirectX11和DirectX12应用程序集成。
</p></li><li class="Default"><p>使用虚幻引擎插件和蓝图。
</p></li><li class="Default"><p>将项目在虚幻中的已渲染视口发送到外部应用程序。
</p></li><li class="Default"><p>在虚幻会话期间，向/从外部应用程序发送/接收纹理。
</p></li></ul><h2 id="步骤1-开始使用sdk">步骤1 - 开始使用SDK</h2>
<p>为了使用纹理共享SDK，你必须从源下载和构建引擎。欲了解如何查找引擎源代码，请参阅<a id="content_link"filter-data="tag_getting_started tag_download tag_code" href="../../../ProgrammingAndScripting/ProgrammingWithCPP/DownloadingSourceCode/index.html" ><span>下载虚幻引擎源代码</span></a>。 
</p><div class="note">
	<p>在Visual Studio中构建引擎，默认情况下不会构建TextureShareSDK项目。</p>
</div><p>按以下步骤构建纹理共享SDK：
</p><ol ><li class="Default"><p>在Visual Studio中打开 <code>Ue4.sln</code> 文件。 
</p></li><li class="Default"><p>在 <strong>解决方案浏览器（Solution Explorer）</strong> 面板中，导航至 <strong>程序（Programs）> TextureShare</strong>。右键点击 <strong>TextureShareSDK</strong> 项目并构建它。
</p><p><img class="  lazyload" alt="图像替换文本" width="356" height="344" data-src="../../../../Images/WorkingWithMedia/TextureShare/TextureShareQuickStart/texture_share_sdk_vs_project.png" />

</p></li><li class="Default"><p>项目完成构建时，会在文件夹 <strong>Engine\Binaries\Win64\TextureShareSDK</strong> 中生成 <code>.lib</code> 和 <code>.dll</code> 文件。
</p></li></ol><h3 id="c++sdk集成">C++ SDK集成</h3>
<p>纹理共享API提供对纹理共享过程的粒度控制。 
</p><p>要使用纹理共享，你必须在交换各方之间建立会话，然后才能执行任何读写操作。流程的每个步骤都提供了对各种同步状态的控制，你可以为项目定制这些同步状态。 
</p><p>使用纹理共享API的C++应用程序符合以下结构：
</p><ol ><li class="Default"><p>客户端应用程序通过指定纹理共享对象的名称来创建该对象。
</p></li><li class="Default"><p>纹理被注册到可以容纳多个纹理的纹理共享对象，并且纹理会话会启动。
</p></li><li class="Default"><p>可以在各个帧上写入数据并发送到其他应用程序，或在各个帧上读取数据。执行读写操作之前必须锁定数据缓冲区，完成后再解锁。
</p></li><li class="Default"><p>对每帧执行步骤3，直至会话结束。
</p></li></ol><p>以下章节显示纹理共享API在DirectX12示例项目 <code>TextureShareD3D12Client.vcxproj</code> 中的使用方式，该项目位于 <strong>Engine/Source/Programs/TextureShare/Samples/ThirdParty/TextureShare_ClientD3D12</strong> 中。
</p><div class="note">
	<p>此例使用DirectX12，但流程与DirectX11相同。只需稍作修改，<strong>ThirdParty</strong> 中的DirectX11示例项目也可套用此流程。</p>
</div><h4 id="include文件">Include文件</h4>
<ul ><li class="Default"><p>包括标头文件 <code>TextureShareD3D12Client.h</code> 和 <code>TextureShareDLL.h</code>。
</p></li><li class="Default"><p>使用<a id="content_link" href="https://docs.microsoft.com/en-us/cpp/preprocessor/comment-c-cpp?view=msvc-160" ><span>pragma注释</span></a>连接静态库文件。如果在Visual Studio中使用 <strong>发布（Release）</strong> 配置进行构建，则使用 <code>TextureShareSDK.lib</code>，如果使用 <strong>调试（Debug）</strong> 配置进行构建，则使用 <code>TextureShareSDK-Win64-Debug.lib</code>。
</p><pre class="prettyprint"><code>#include "TextureShareD3D12Client.h"
#include "TextureShareDLL.h"
#ifdef &#95;DEBUG
#pragma comment( lib, "TextureShareSDK-Win64-Debug.lib" )
#else
#pragma comment( lib, "TextureShareSDK.lib" )
#endif</code></pre></li></ul><h4 id="初始化">初始化</h4>
<p>以下步骤介绍了C++中要初始化的内容以及启动纹理共享会话的方式。
</p><ol ><li class="Default"><p>使用DirectX API加载渲染管线和资产：
</p><ol ><li class="Default"><p>创建<a id="content_link" href="https://docs.microsoft.com/en-us/windows/win32/api/d3d12/nf-d3d12-d3d12createdevice" ><span>DirectX设备</span></a>。
</p></li><li class="Default"><p>创建<a id="content_link" href="https://docs.microsoft.com/en-us/windows/win32/api/d3d12/nn-d3d12-id3d12graphicscommandlist" ><span>GraphicsCommandList</span></a>。
</p></li></ol><p>相关示例详见 <code>D3D12HelloTexture::LoadPipeline()</code> 和 <code>D3D12HelloTexture::LoadAssets()</code>。
</p></li><li class="Default"><p>创建纹理共享项：
</p><ol ><li class="Default"><p>设置共享名称。最大长度为128个字符。
</p></li><li class="Default"><p>使用 <code>ETextureShareProcess::Client</code> 将应用程序设为客户端。
</p></li><li class="Default"><p>为纹理共享会话定义同步策略。详见同步策略。本例中，所有同步策略都设为 <strong>无（None）</strong>，因此同步事件都将是非阻塞性的。
</p></li><li class="Default"><p>指定要使用的图形API。目前仅支持DirectX11和DirectX12。
</p><pre class="prettyprint"><code>FTextureShareSyncPolicy DefaultSyncPolicy;
DefaultSyncPolicy.ConnectionSync = ETextureShareSyncConnect::None;
DefaultSyncPolicy.FrameSync = ETextureShareSyncFrame::None;
DefaultSyncPolicy.TextureSync = ETextureShareSyncSurface::None;
FTextureShareInterface::CreateTextureShare(ShareName.c&#95;str(), ETextureShareProcess::Client, DefaultSyncPolicy, ETextureShareDevice::D3D12);</code></pre></li></ol></li><li class="Default"><p>将纹理注册到纹理共享项：
</p><ol ><li class="Default"><p>设置会话的共享名称。
</p></li><li class="Default"><p>设置纹理名称。
</p></li><li class="Default"><p>设置纹理分辨率。
</p></li></ol><p>10.定义纹理格式和值。
</p><p>11.设置纹理是可读取还是可写入。
</p><pre class="prettyprint"><code>    ETextureShareFormat ShareFormat = ETextureShareFormat::Undefined;
    uint32 ShareFormatValue = 0;
    // 使用客户端纹理格式：
    if (InFormat != DXGI&#95;FORMAT&#95;UNKNOWN)
    {
        ShareFormat = ETextureShareFormat::Format&#95;DXGI;
        ShareFormatValue = InFormat;
    }
    FTextureShareInterface::RegisterTexture(ShareName.c&#95;str(), TextureName.c&#95;str(), Width, Height, ShareFormat, ShareFormatValue, TextureOp);</code></pre></li><li class="Default"><p>定义纹理共享会话的作用域的开头：
</p><pre class="prettyprint"><code>FTextureShareInterface::BeginSession(ShareName.c&#95;str());</code></pre></li></ol><h4 id="渲染线程">渲染线程</h4>
<p>以下步骤介绍如何在渲染线程中访问共享内存。这些步骤显示如何使用读写操作。
</p><ol ><li class="Default"><p>定义纹理共享会话中帧作用域的开头：
</p><pre class="prettyprint"><code>FTextureShareInterface::BeginFrame&#95;RenderThread(ShareName.c&#95;str());</code></pre></li><li class="Default"><p>读取渲染线程中的纹理：
</p><ol ><li class="Default"><p>在纹理上加个锁。
</p></li><li class="Default"><p>访问纹理内存。
</p></li><li class="Default"><p>释放纹理上的锁。
</p><pre class="prettyprint"><code>if (FTextureShareInterface::IsValid(ShareName.c&#95;str()))
{
    ID3D12Resource&#42; SharedResource;
    if (FTextureShareInterface::LockTextureD3D12&#95;RenderThread(pD3D12Device, ShareName.c&#95;str(), TextureName.c&#95;str(), SharedResource))
    {
        if (!FTextureShareD3D12Helper::IsTexturesEqual(SharedResource, &#42;InOutSRVTexture))
        {
            // 共享纹理大小在服务器端发生更改。移除临时纹理，重新创建新的tempTexture
            ReleaseTextureAndSRV(InOutSRVTexture);
        }
        if (!&#42;InOutSRVTexture)
        {
            // 创建临时texture&amp;srv
            FTextureShareD3D12Helper::CreateSRVTexture(pD3D12Device, pD3D12HeapSRV, SharedResource, InOutSRVTexture, SRVIndex);
        }
        // 从共享复制到临时：
        if (&#42;InOutSRVTexture)
        {
            FTextureShareD3D12Helper::CopyResource(pCmdList, SharedResource, &#42;InOutSRVTexture);
        }
        // 解锁共享资源
        FTextureShareInterface::UnlockTexture&#95;RenderThread(ShareName.c&#95;str(), TextureName.c&#95;str());
    }
    else
    {
        // 释放未使用的纹理（断开连接用途）
        ReleaseTextureAndSRV(InOutSRVTexture);
      }
}</code></pre></li></ol></li><li class="Default"><p>写入到渲染线程中的纹理：
</p><ol ><li class="Default"><p>检查会话是否有效。
</p></li><li class="Default"><p>在纹理上加个锁。
</p></li><li class="Default"><p>访问内存。
</p></li><li class="Default"><p>释放纹理上的锁。
</p><pre class="prettyprint"><code>  if (FTextureShareInterface::IsValid(ShareName.c&#95;str()))
{
    ID3D12Resource&#42; SharedResource;
    if (FTextureShareInterface::LockTextureD3D12&#95;RenderThread(pD3D12Device, ShareName.c&#95;str(), TextureName.c&#95;str(), SharedResource))
    {
            FTextureShareD3D12Helper::CopyResource(pCmdList, InTexture, SharedResource);
            FTextureShareInterface::UnlockTexture&#95;RenderThread(ShareName.c&#95;str(), TextureName.c&#95;str());
    }
}</code></pre></li></ol></li><li class="Default"><p>获取帧数据以访问辅助缓冲区中的信息，如投影和摄像机矩阵：
</p><pre class="prettyprint"><code>FTextureShareSDKAdditionalData&#42; OutFrameData;
FTextureShareInterface::GetRemoteAdditionalData(ShareName.c&#95;str(), &#42;OutFrameData);</code></pre></li><li class="Default"><p>定义纹理共享会话中帧作用域的结尾：
</p><pre class="prettyprint"><code>FTextureShareInterface::EndFrame&#95;RenderThread(ShareName.c&#95;str());</code></pre></li><li class="Default"><p>呈示要显示的帧。
</p></li></ol><h4 id="清理">清理</h4>
<p>以下步骤介绍如何在应用程序退出时终止纹理共享会话。
</p><ol ><li class="Default"><p>定义纹理共享会话的作用域的结尾：
</p><pre class="prettyprint"><code>FTextureShareInterface::EndSession(ShareName.c&#95;str());</code></pre></li><li class="Default"><p>删除纹理共享项并释放内存：
</p><pre class="prettyprint"><code>FTextureShareInterface::ReleaseTextureShare(ShareName.c&#95;str());</code></pre></li></ol><h2 id="步骤2-开始在虚幻中使用">步骤2 - 开始在虚幻中使用</h2>
<p>按以下步骤使用纹理共享插件，以及在虚幻引擎中访问纹理共享蓝图。
</p><ol ><li class="Default"><p>在编辑器的主菜单中，选择 <strong>编辑（Edit） > 插件（Plugins）</strong> 以打开 <strong>插件编辑器（Plugins Editor）</strong>。
</p></li><li class="Default"><p>在插件编辑器中，在 <strong>杂项（Misc）</strong> 部分中找到 <strong>纹理共享（Texture Share）</strong> 插件。
</p><p><img class="  lazyload" alt="图像替换文本" width="624" height="246" data-src="../../../../Images/WorkingWithMedia/TextureShare/TextureShareQuickStart/texture_share_plugin.png" />

</p></li><li class="Default"><p>选中 <strong>已启用（Enabled）</strong> 复选框，并重启编辑器。
</p></li><li class="Default"><p>在 <strong>内容浏览器</strong> 中，展开面板右下侧的 <strong>视图选项（View Options）</strong> 下拉菜单。选中 <strong>显示引擎内容（Show Engine Content）</strong> 和 <strong>显示插件内容（Show Plugin Content）</strong>。
</p><p><img class="  lazyload" alt="图像替换文本" width="593" height="598" data-src="../../../../Images/WorkingWithMedia/TextureShare/TextureShareQuickStart/content_view_options.png" />

</p></li><li class="Default"><p>点击 <strong>内容浏览器</strong> 顶部的文件夹图标，以选择一个内容路径。在列表中找到 <strong>TextureShare内容</strong> 并选中它。 
</p><p> <img class="  lazyload" alt="图像替换文本" width="624" height="457" data-src="../../../../Images/WorkingWithMedia/TextureShare/TextureShareQuickStart/texture_share_plugin_content.png" />

</p></li><li class="Default"><p>在 <strong>蓝图（Blueprints）</strong> 文件夹中，有两个蓝图对象可以直接添加到你的场景中：
</p><ul ><li class="Default"><p><strong>BP_TextureShare_Scene</strong>：此蓝图共享整个虚幻场景的已渲染帧。
</p></li><li class="Default"><p><strong>BP_TextureShare_Postprocess</strong>：此蓝图发送和接收特定的 <strong>纹理（Texture）</strong> 对象。
</p></li></ul><p><img class="  lazyload" alt="图像替换文本" width="472" height="265" data-src="../../../../Images/WorkingWithMedia/TextureShare/TextureShareQuickStart/texture_share_blueprints.png" />

</p></li><li class="Default"><p><strong>材质（Materials）</strong> 文件夹中的纹理和材质可与 <strong>BP_TextureShare_Postprocess</strong> 蓝图配合使用。
</p><ul ><li class="Default"><p><strong>RTT_TextureShare_Backbuffer</strong>：一种 <strong>纹理渲染目标2D</strong> 资产。
</p></li><li class="Default"><p><strong>M_TextureShare_RTTBackbuffer</strong>：一种材质，对 <strong>RTT_TextureShare_Backbuffer</strong> 纹理进行采样并将其用作 <strong>自发光颜色</strong>。
</p></li></ul><p><img class="  lazyload" alt="图像替换文本" width="624" height="261" data-src="../../../../Images/WorkingWithMedia/TextureShare/TextureShareQuickStart/texture_share_materials.png" />

</p></li></ol><p>此快速入门中的其余步骤介绍如何使用各个蓝图并将它们连接到其他DirectX应用程序。
</p><h2 id="步骤3-将虚幻场景作为纹理发送到directx应用程序">步骤3 - 将虚幻场景作为纹理发送到DirectX应用程序</h2>
<p>按以下步骤将虚幻场景流送到外部DirectX应用程序。
</p><ol ><li class="Default"><p>导航至文件夹 <strong>Engine/Source/Programs/TextureShare/Samples/ThirdParty/TextureShare_ClientD3D11</strong>，并在Visual Studio中打开示例项目 <code>TextureShareD3D11Client.vcxproj</code>。
</p></li><li class="Default"><p>在Visual Studio中将 <strong>解决方案配置（Solution Configuration）</strong> 设置为 <strong>发布（Release）</strong>。**
</p></li><li class="Default"><p>在Visual Studio中构建项目。
</p></li><li class="Default"><p>导航至文件夹 <strong>Engine\Source\Programs\TextureShare\Samples\ThirdParty\TextureShare_ClientD3D11\Binaries\TextureShareD3D11Client-Win64-Release</strong> 并启动 <code>TextureShareD3D11Client.exe</code> 应用程序。
</p></li><li class="Default"><p>在虚幻引擎中打开你的虚幻项目，将蓝图 <strong>BP_TextureShare_Scene</strong> 对象添加到你的场景。
</p></li><li class="Default"><p>选择 <strong>BP_TextureShare_Scene</strong> 对象以打开其 <strong>细节（Details）</strong> 面板。
</p></li><li class="Default"><p>确保 <strong>共享名称（Share Name）</strong> 参数设置为与示例项目中的 <strong>ShareName</strong> 变量相同的名称，即 <strong>vp_1</strong>。
</p></li><li class="Default"><p>按虚幻中的 <strong>播放（Play）</strong>。虚幻场景中已渲染的帧作为纹理流送到客户端应用程序并应用于旋转立方体。
</p></li></ol><div class="asyncgif">
	<p><picture>
		<source data-srcset="./../../../../Images/WorkingWithMedia/TextureShare/TextureShareQuickStart/unreal_sharing_viewport.jpg">
		<img class="  lazyload" alt="图像替换文本" width="983" data-src="../../../../Images/WorkingWithMedia/TextureShare/TextureShareQuickStart/unreal_sharing_viewport.jpg" />
</picture>
</p>
</div><h2 id="步骤4-将纹理发送到外部directx应用程序">步骤4 - 将纹理发送到外部DirectX应用程序</h2>
<p>上一个步骤介绍如何在单独的流程中将虚幻场景作为纹理进行共享。也可将项目中的任何纹理对象发送到外部应用程序。
</p><p>按以下步骤将你的虚幻项目中的任何纹理对象分享到DirectX示例应用程序。
</p><ol ><li class="Default"><p>导航至文件夹 <strong>Engine\Source\Programs\TextureShare\Samples\ThirdParty\TextureShare_ClientD3D12</strong>，并在Visual Studio中打开示例项目 <code>TextureShareD3D12Client.vcxproj</code>。
</p></li><li class="Default"><p>将 <strong>解决方案配置（Solution Configuration）</strong> 设置为 <strong>发布（Release）</strong>。
</p></li><li class="Default"><p>构建项目。
</p></li><li class="Default"><p>导航至文件夹 <strong>Engine\Source\Programs\TextureShare\Samples\ThirdParty\TextureShare_ClientD3D12\Binaries\TextureShareD3D12Client-Win64-Release</strong> 并启动项目构建的可执行文件，即 <code>TextureShareD3D12Client.exe</code>。
</p></li><li class="Default"><p>在虚幻引擎中打开你的虚幻项目，将蓝图 <strong>BP_TextureShare_Postprocess</strong> 对象添加到你的场景。
</p></li><li class="Default"><p>选择添加到场景中的 <strong>BP_TextureShare_Postprocess</strong> 对象，打开其 <strong>细节（Details）</strong> 面板。
</p><p><img class="  lazyload" alt="图像替换文本" height="641" data-src="../../../../Images/WorkingWithMedia/TextureShare/TextureShareQuickStart/bp_textureshare_postprocess.png" />

</p></li><li class="Default"><p>展开 <strong>后期处理（Postprocess）</strong> 分段。
</p></li><li class="Default"><p>展开 <strong>后期处理（Postprocess）</strong> 部分下的 <strong>发送（Send）</strong> 部分。有两个发送数组元素。Id必须对应示例项目中 <code>D3D12HelloTexture.cpp</code> 文件中定义的纹理名称：
</p><pre class="prettyprint"><code>// 定义共享和纹理名称
std::wstring ShareName1 = L"vp&#95;1";
std::wstring ReceiveTextureNames&#91;&#93; = { L"SceneDepth" , L"BackBuffer" };</code></pre>
<ol ><li class="Default"><p>将第一个 <strong>发送（Send）</strong> 元素的 <strong>Id</strong> 设置为 <strong>SceneDepth</strong>。
</p></li><li class="Default"><p>将第二个 <strong>发送（Send）</strong> 元素的 <strong>Id</strong> 设置为 <strong>BackBuffer</strong>。
</p></li></ol><p><img class="  lazyload" alt="图像替换文本" height="641" data-src="../../../../Images/WorkingWithMedia/TextureShare/TextureShareQuickStart/blueprint_ids_set.png" />

</p></li><li class="Default"><p>在 <strong>虚幻编辑器</strong> 中按 <strong>播放（Play）</strong>。
</p></li></ol><p>10.使用纹理对象更新两个 <strong>发送（Send）</strong> 元素的 <strong>纹理（Texture）</strong> 参数。引擎将纹理流送到客户端应用程序并将它们应用于已渲染的三角形。
</p><div class="asyncgif">
	<p> <picture>
		<source data-srcset="./../../../../Images/WorkingWithMedia/TextureShare/TextureShareQuickStart/sending_textures_from_unreal.jpg">
		<img class="  lazyload" alt="图像替换文本" width="983" data-src="../../../../Images/WorkingWithMedia/TextureShare/TextureShareQuickStart/sending_textures_from_unreal.jpg" />
</picture>
</p>
</div><h2 id="步骤5-从directx应用程序接收纹理并在虚幻中显示它们">步骤5 - 从DirectX应用程序接收纹理并在虚幻中显示它们</h2>
<p>上一个步骤介绍如何将纹理发送到外部DirectX应用程序。本节介绍如何从另一个应用程序接收纹理。
</p><p>按以下步骤从DirectX示例应用程序接收纹理。
</p><ol ><li class="Default"><p>导航至文件夹 <strong>Engine\Source\Programs\TextureShare\Samples\ThirdParty\TextureShare_ClientD3D12</strong>，并在Visual Studio中打开示例项目 <code>TextureShareD3D12Client.vcxproj</code>。
</p></li><li class="Default"><p>将 <strong>解决方案配置（Solution Configuration）</strong> 设置为 <strong>发布（Release）</strong>。
</p></li><li class="Default"><p>构建项目。
</p></li><li class="Default"><p>导航至文件夹 <strong>Engine\Source\Programs\TextureShare\Samples\ThirdParty\TextureShare_ClientD3D12\Binaries\TextureShareD3D12Client-Win64-Release</strong> 并启动项目构建的可执行文件，即 <code>TextureShareD3D12Client.exe</code>。
</p></li><li class="Default"><p>在虚幻引擎中打开你的虚幻项目，将蓝图 <strong>BP_TextureShare_Postprocess</strong> 对象添加到你的场景。
</p></li><li class="Default"><p>选择添加到场景中的 <strong>BP_TextureShare_Postprocess</strong> 对象，打开其 <strong>细节（Details）</strong> 面板。
</p></li><li class="Default"><p>在 <strong>默认（Default）</strong> 下的 <strong>细节（Details）</strong> 面板中，展开 <strong>后期处理（Postprocess）</strong> 部分。
</p></li><li class="Default"><p>展开 <strong>后期处理（Postprocess）</strong> 部分下的 <strong>接收（Receive）</strong> 部分。有一个 <strong>接收（Receive）</strong> 数组元素。此元素的 <strong>Id</strong> 必须对应示例项目中 <code>D3D12HelloTexture.cpp</code> 文件中定义的纹理名称：
</p><pre class="prettyprint"><code>// 定义共享和纹理名称
std::wstring ShareName1 = L"vp&#95;1";
std::wstring SendBackbufferTextureName = L"InBackbuffer";</code></pre>
<p><img class="  lazyload" alt="图像替换文本" width="388" height="652" data-src="../../../../Images/WorkingWithMedia/TextureShare/TextureShareQuickStart/receive_ids_set.png" />

</p></li><li class="Default"><p>将 <strong>接收（Receive）</strong> 元素的 <strong>RTT</strong> 参数设置为 <strong>TextureShare</strong> 插件中提供的 <strong>RTT_TextureShare_Backbuffer</strong>。
</p><p><img class="  lazyload" alt="图像替换文本" width="554" height="622" data-src="../../../../Images/WorkingWithMedia/TextureShare/TextureShareQuickStart/set_texture_to_rtt_textureshare_backbuffer.png" />

</p></li></ol><p>现在已设置你的虚幻项目使用TextureShare从另一个应用程序接收纹理。 
</p><p>下例中启动了虚幻引擎会话。虚幻正在将一个纹理发送到 <strong>TextureShareD3D12Client</strong> 应用程序，并从该应用程序接收后置缓冲。场景中墙上的照片使用的是采样自 <strong>RTT_TextureShare_Backbuffer</strong> 纹理的材质，以实时显示接收的内容。
</p><div class="asyncgif">
	<p><picture>
		<source data-srcset="./../../../../Images/WorkingWithMedia/TextureShare/TextureShareQuickStart/receive_textures_into_unreal.jpg">
		<img class="  lazyload" alt="图像替换文本" width="983" data-src="../../../../Images/WorkingWithMedia/TextureShare/TextureShareQuickStart/receive_textures_into_unreal.jpg" />
</picture>
</p>
</div>
																	</div>
					<!-- End of Markdown converted page content -->
				</div>
												<div id="pageTags">
				<div class="title">标签</div>
					<div>
					<div class="keyword_tag_filter"><a id="tag_link" href="../../../SiteIndex/index.html?tags=beta">beta</a></div>
					</div>
				</div>
								<div id="recommendations"></div>			</div>
						  									<div id="announcement">
			<div style="display:inline-block;margin:5px;">
				欢迎帮助改进虚幻引擎文档！请告诉我们该如何更好地为您服务。
			</div>
			<div style="margin:5px;display:inline-block;">
				<div class="btn action" style="margin-top:-6px;display:inline-block;" onclick="$('#announcement').hide();window.open('https://epicgames.questionpro.com/t/AP9dGZkjp4');createCookie('announcement-read', new Date().getTime(), 30);">填写问卷调查</div>
				<div class="btn btn-default" style="margin-top:-6px;display:inline-block;" onclick="$('#announcement').hide();createCookie('announcement-read', new Date().getTime(), 30);">取消</div>
			</div>
			<div class="btn-close" style="position:absolute;right:5px;top:10px;padding:3px;width:14px;height:14px;" onclick="$('#announcement').hide();"></div>
			</div>
					</div>
	</div></body>

<!-- Mirrored from docs.unrealengine.com/4.26/zh-CN/WorkingWithMedia/TextureShare/TextureShareQuickStart/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 17 Jan 2024 12:38:17 GMT -->
</html>
